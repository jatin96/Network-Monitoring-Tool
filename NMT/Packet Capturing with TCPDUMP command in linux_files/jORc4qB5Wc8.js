if (self.CavalryLogger) { CavalryLogger.start_js(["KJWSJ"]); }

__d("MessageBorderType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={FLOWERS:"flowers"};},null);
__d("MessageCustomizationType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={BORDER:"border"};},null);
__d("TextWithEntitiesMetadataType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={NONE:0,CONCEPT:1,INTENT:2};},null);
__d('P2PTriggersUtils',['P2PGKValues'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=/\$((\d{1,3}(,\d{3})*)|\d+)(\.\d{1,2})?(?=\s|\.\s|\,\s|$|\.$|\,$|\?|\!|\")/,i={canSeeTriggers:function(j){if(!c('P2PGKValues').P2PEnabled)return false;return true;},getMatches:function(j){return j.match(h);}};f.exports=i;},null);
__d('MercuryMessageBody.react',['cx','fbt','BootloadedComponent.react','EmoticonsList','EmployeeLinkMatcher','EmployeeLinkRanges','JSResource','Link.react','MercuryConfig','MessengerSupportedEmoji','MessengerTextWithEntities.react','P2PTriggersUtils','ReactComponentWithPureRenderMixin','React','SupportedEmoji','TextWithEntities.react','TextWithEntitiesMetadataType','URI','URLMatcher','cancelAnimationFrame','emptyFunction','getURLRanges','ifRequired','requestAnimationFrame','shouldAddMRefParam'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=function(){k=c('emptyFunction');c('ifRequired')('ChatAppActions',function(m){m.setInitialDisplayDone();});},l=c('React').createClass({displayName:'MercuryMessageBody',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{body:j.string,customLike:j.object,metaRanges:j.array,ranges:j.array,threadID:j.string},getInitialState:function(){return {richText:false};},_shouldRenderP2PTriggers:false,componentDidMount:function(){this._raf=c('requestAnimationFrame')(this.setIsRichText);},componentWillReceiveProps:function(m){if(m.ranges!==this.props.ranges){this._raf&&c('cancelAnimationFrame')(this._raf);this._raf=c('requestAnimationFrame')(this.setIsRichText);}},targetBlankLinkInterpolator:function(m,n){if(n.className)return c('React').createElement('span',{className:n.className},m);if(n.entity&&n.entity.url){var o=new (c('URI'))(n.entity.url.replace(/#+$/,''));if(c('shouldAddMRefParam')(o))o.addQueryData({__mref:'message_bubble'});return (c('React').createElement(c('Link.react'),{href:{url:o.toString(),shimhash:n.entity.shimhash},s:n.entity.s,target:'_blank'},m));}else if(!n.entity)switch(n.type){case c('TextWithEntitiesMetadataType').NONE:return (c('React').createElement('span',{className:"_2y9",title:JSON.stringify(n.data)},m));default:return m;}},setIsRichText:function(){delete this._raf;var m=this.props,n=m.body,o=m.ranges,p=m.metaRanges;n=n||'';this._shouldRenderP2PTriggers=!!(this.props.threadID&&c('P2PTriggersUtils').canSeeTriggers(this.props.threadID)&&c('P2PTriggersUtils').getMatches(n));if(o&&o.length||p&&p.length||c('EmoticonsList').noncapturingRegexp.test(n)||c('SupportedEmoji').findEmoji(n)||c('URLMatcher').match(n)||c('EmployeeLinkMatcher').isMatch(n)||this._shouldRenderP2PTriggers||c('MercuryConfig').MessengerNewEmojiGK&&c('MessengerSupportedEmoji').findEmoji(n)){this.setState({richText:true},k);}else k();},componentWillUnmount:function(){this._raf&&c('cancelAnimationFrame')(this._raf);},render:function(){var m=this.props.body||'';if(m.startsWith('?OTR'))return (c('React').createElement('span',{className:"_89h"},i._("[encrypted message]")));m=m.replace(/\s+$/,'');if(m.length===0)return null;if(!this.state.richText)return c('React').createElement('span',{className:this.props.className},m);var n=this.props.ranges;if(n==undefined)n=c('getURLRanges')(m);if(n==undefined){n=c('EmployeeLinkRanges').get(m);}else{n=n.concat(c('EmployeeLinkRanges').get(m));n=n.filter(function(q){return q!=undefined;});}var o={className:this.props.className,interpolator:this.targetBlankLinkInterpolator,metaRanges:this.props.metaRanges,ranges:n,renderEmoji:true,renderEmoticons:true,text:m},p=c('React').createElement(c('TextWithEntities.react'),o);if(this._shouldRenderP2PTriggers){return (c('React').createElement(c('BootloadedComponent.react'),babelHelpers['extends']({bootloadPlaceholder:p,bootloadLoader:c('JSResource')('TextWithEntitiesAndP2P.react').__setRef('MercuryMessageBody.react')},o,{threadID:this.props.threadID})));}else if(c('MercuryConfig').MessengerNewEmojiGK){return (c('React').createElement(c('MessengerTextWithEntities.react'),o));}else return p;}});f.exports=l;},null);
__d('DefaultDraftBlockRenderMap',['cx','immutable','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').createElement('ul',{className:"_1bv0"}),k=c('React').createElement('ol',{className:"_1bv1"}),l=c('React').createElement('pre',{className:"_1bv2"});f.exports=i({'header-one':{element:'h1'},'header-two':{element:'h2'},'header-three':{element:'h3'},'header-four':{element:'h4'},'header-five':{element:'h5'},'header-six':{element:'h6'},'unordered-list-item':{element:'li',wrapper:j},'ordered-list-item':{element:'li',wrapper:k},blockquote:{element:'blockquote'},atomic:{element:'figure'},'code-block':{element:'pre',wrapper:l},unstyled:{element:'div'}});},null);
__d('DefaultDraftInlineStyle',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports={BOLD:{fontWeight:'bold'},CODE:{fontFamily:'monospace',wordWrap:'break-word'},ITALIC:{fontStyle:'italic'},STRIKETHROUGH:{textDecoration:'line-through'},UNDERLINE:{textDecoration:'underline'}};},null);
__d('ContentStateInlineStyle',['CharacterMetadata','immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i={add:function(k,l,m){return j(k,l,m,true);},remove:function(k,l,m){return j(k,l,m,false);}};function j(k,l,m,n){var o=k.getBlockMap(),p=l.getStartKey(),q=l.getStartOffset(),r=l.getEndKey(),s=l.getEndOffset(),t=o.skipUntil(function(u,v){return v===p;}).takeUntil(function(u,v){return v===r;}).concat(h([[r,o.get(r)]])).map(function(u,v){var w,x;if(p===r){w=q;x=s;}else{w=v===p?q:0;x=v===r?s:u.getLength();}var y=u.getCharacterList(),z;while(w<x){z=y.get(w);y=y.set(w,n?c('CharacterMetadata').applyStyle(z,m):c('CharacterMetadata').removeStyle(z,m));w++;}return u.set('characterList',y);});return k.merge({blockMap:o.merge(t),selectionBefore:l,selectionAfter:l});}f.exports=i;},null);
__d('applyEntityToContentBlock',['CharacterMetadata'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l){var m=i.getCharacterList();while(j<k){m=m.set(j,c('CharacterMetadata').applyEntity(m.get(j),l));j++;}return i.set('characterList',m);}f.exports=h;},null);
__d('applyEntityToContentState',['immutable','applyEntityToContentBlock'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=i.getBlockMap(),m=j.getStartKey(),n=j.getStartOffset(),o=j.getEndKey(),p=j.getEndOffset(),q=l.skipUntil(function(r,s){return s===m;}).takeUntil(function(r,s){return s===o;}).toOrderedMap().merge(c('immutable').OrderedMap([[o,l.get(o)]])).map(function(r,s){var t=s===m?n:0,u=s===o?p:r.getLength();return c('applyEntityToContentBlock')(r,t,u,k);});return i.merge({blockMap:l.merge(q),selectionBefore:j,selectionAfter:j});}f.exports=h;},null);
__d('DraftEntitySegments',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={getRemovalRange:function(i,j,k,l,m){var n=k.split(' ');n=n.map(function(x,y){if(m==='forward'){if(y>0)return ' '+x;}else if(y<n.length-1)return x+' ';return x;});var o=l,p,q,r=null,s=null;for(var t=0;t<n.length;t++){q=n[t];p=o+q.length;if(i<p&&o<j){if(r!==null){s=p;}else{r=o;s=p;}}else if(r!==null)break;o=p;}var u=l+k.length,v=r===l,w=s===u;if(!v&&w||v&&!w)if(m==='forward'){if(s!==u)s++;}else if(r!==l)r--;return {start:r,end:s};}};f.exports=h;},null);
__d('getRangesForDraftEntity',['invariant'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){var l=[];j.findEntityRanges(function(m){return m.getEntity()===k;},function(m,n){l.push({start:m,end:n});});!!!l.length?h(0):void 0;return l;}f.exports=i;},null);
__d('getCharacterRemovalRange',['invariant','DraftEntity','DraftEntitySegments','getRangesForDraftEntity'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k,l){var m=k.getStartOffset(),n=k.getEndOffset(),o=j.getEntityAt(m);if(!o)return k;var p=c('DraftEntity').get(o),q=p.getMutability();if(q==='MUTABLE')return k;var r=c('getRangesForDraftEntity')(j,o).filter(function(u){return m<u.end&&n>u.start;});!(r.length==1)?h(0):void 0;var s=r[0];if(q==='IMMUTABLE')return k.merge({anchorOffset:s.start,focusOffset:s.end,isBackward:false});var t=c('DraftEntitySegments').getRemovalRange(m,n,j.getText().slice(s.start,s.end),s.start,l);return k.merge({anchorOffset:t.start,focusOffset:t.end,isBackward:false});}f.exports=i;},null);
__d('removeEntitiesAtEdges',['invariant','CharacterMetadata','DraftEntity','findRangesImmutable'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(l,m){var n=l.getBlockMap(),o={},p=m.getStartKey(),q=m.getStartOffset(),r=n.get(p),s=k(r,q);if(s!==r)o[p]=s;var t=m.getEndKey(),u=m.getEndOffset(),v=n.get(t);if(p===t)v=s;var w=k(v,u);if(w!==v)o[t]=w;if(!Object.keys(o).length)return l.set('selectionAfter',m);return l.merge({blockMap:n.merge(o),selectionAfter:m});}function j(l,m,n){var o;c('findRangesImmutable')(l,function(p,q){return p.getEntity()===q.getEntity();},function(p){return p.getEntity()===m;},function(p,q){if(p<=n&&q>=n)o={start:p,end:q};});!(typeof o==='object')?h(0):void 0;return o;}function k(l,m){var n=l.getCharacterList(),o=m>0?n.get(m-1):undefined,p=m<n.count()?n.get(m):undefined,q=o?o.getEntity():undefined,r=p?p.getEntity():undefined;if(r&&r===q){var s=c('DraftEntity').get(r);if(s.getMutability()!=='MUTABLE'){var t=j(n,r,m),u=t.start,v=t.end,w;while(u<v){w=n.get(u);n=n.set(u,c('CharacterMetadata').applyEntity(w,null));u++;}return l.set('characterList',n);}}return l;}f.exports=i;},null);
__d('getContentStateFragment',['generateRandomKey','removeEntitiesAtEdges'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=j.getStartKey(),l=j.getStartOffset(),m=j.getEndKey(),n=j.getEndOffset(),o=c('removeEntitiesAtEdges')(i,j),p=o.getBlockMap(),q=p.keySeq(),r=q.indexOf(k),s=q.indexOf(m)+1,t=p.slice(r,s).map(function(u,v){var w=c('generateRandomKey')(),x=u.getText(),y=u.getCharacterList();if(k===m)return u.merge({key:w,text:x.slice(l,n),characterList:y.slice(l,n)});if(v===k)return u.merge({key:w,text:x.slice(l),characterList:y.slice(l)});if(v===m)return u.merge({key:w,text:x.slice(0,n),characterList:y.slice(0,n)});return u.set('key',w);});return t.toOrderedMap();}f.exports=h;},null);
__d('insertIntoList',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){if(k===i.count()){j.forEach(function(n){i=i.push(n);});}else if(k===0){j.reverse().forEach(function(n){i=i.unshift(n);});}else{var l=i.slice(0,k),m=i.slice(k);i=l.concat(j,m).toList();}return i;}f.exports=h;},null);
__d('insertFragmentIntoContentState',['invariant','BlockMapBuilder','generateRandomKey','insertIntoList'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k,l){!k.isCollapsed()?h(0):void 0;var m=k.getStartKey(),n=k.getStartOffset(),o=j.getBlockMap(),p=l.size,q,r;if(p===1){var s=o.get(m),t=l.first(),u=s.getText(),v=s.getCharacterList(),w=s.merge({text:u.slice(0,n)+t.getText()+u.slice(n),characterList:c('insertIntoList')(v,t.getCharacterList(),n)});o=o.set(m,w);q=m;r=n+t.getText().length;return j.merge({blockMap:o.set(m,w),selectionBefore:k,selectionAfter:k.merge({anchorKey:q,anchorOffset:r,focusKey:q,focusOffset:r,isBackward:false})});}var x=[];j.getBlockMap().forEach(function(y,z){if(z!==m){x.push(y);return;}var aa=y.getText(),ba=y.getCharacterList(),ca=aa.length,da=aa.slice(0,n),ea=ba.slice(0,n),fa=l.first(),ga=y.merge({text:da+fa.getText(),characterList:ea.concat(fa.getCharacterList()),type:da?y.getType():fa.getType()});x.push(ga);l.slice(1,p-1).forEach(function(la){x.push(la.set('key',c('generateRandomKey')()));});var ha=aa.slice(n,ca),ia=ba.slice(n,ca),ja=l.last();q=c('generateRandomKey')();var ka=ja.merge({key:q,text:ja.getText()+ha,characterList:ja.getCharacterList().concat(ia)});x.push(ka);});r=l.last().getLength();return j.merge({blockMap:c('BlockMapBuilder').createFromArray(x),selectionBefore:k,selectionAfter:k.merge({anchorKey:q,anchorOffset:r,focusKey:q,focusOffset:r,isBackward:false})});}f.exports=i;},null);
__d('insertTextIntoContentState',['invariant','immutable','insertIntoList'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Repeat;function j(k,l,m,n){!l.isCollapsed()?h(0):void 0;var o=m.length;if(!o)return k;var p=k.getBlockMap(),q=l.getStartKey(),r=l.getStartOffset(),s=p.get(q),t=s.getText(),u=s.merge({text:t.slice(0,r)+m+t.slice(r,s.getLength()),characterList:c('insertIntoList')(s.getCharacterList(),i(n,o).toList(),r)}),v=r+o;return k.merge({blockMap:p.set(q,u),selectionAfter:l.merge({anchorOffset:v,focusOffset:v})});}f.exports=j;},null);
__d('removeRangeFromContentState',['immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(j,k){if(k.isCollapsed())return j;var l=j.getBlockMap(),m=k.getStartKey(),n=k.getStartOffset(),o=k.getEndKey(),p=k.getEndOffset(),q=l.get(m),r=l.get(o),s;if(q===r){s=i(q.getCharacterList(),n,p);}else s=q.getCharacterList().slice(0,n).concat(r.getCharacterList().slice(p));var t=q.merge({text:q.getText().slice(0,n)+r.getText().slice(p),characterList:s}),u=l.toSeq().skipUntil(function(v,w){return w===m;}).takeUntil(function(v,w){return w===o;}).concat(c('immutable').Map([[o,null]])).map(function(v,w){return w===m?t:null;});l=l.merge(u).filter(function(v){return !!v;});return j.merge({blockMap:l,selectionBefore:k,selectionAfter:k.merge({anchorKey:m,anchorOffset:n,focusKey:m,focusOffset:n,isBackward:false})});}function i(j,k,l){if(k===0){while(k<l){j=j.shift();k++;}}else if(l===j.count()){while(l>k){j=j.pop();l--;}}else{var m=j.slice(0,k),n=j.slice(l);j=m.concat(n).toList();}return j;}f.exports=h;},null);
__d('setBlockTypeForContentState',['immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=j.getStartKey(),m=j.getEndKey(),n=i.getBlockMap(),o=n.toSeq().skipUntil(function(p,q){return q===l;}).takeUntil(function(p,q){return q===m;}).concat(c('immutable').Map([[m,n.get(m)]])).map(function(p){return p.merge({type:k,depth:0});});return i.merge({blockMap:n.merge(o),selectionBefore:j,selectionAfter:j});}f.exports=h;},null);
__d('splitBlockInContentState',['invariant','generateRandomKey'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){!k.isCollapsed()?h(0):void 0;var l=k.getAnchorKey(),m=k.getAnchorOffset(),n=j.getBlockMap(),o=n.get(l),p=o.getText(),q=o.getCharacterList(),r=o.merge({text:p.slice(0,m),characterList:q.slice(0,m)}),s=c('generateRandomKey')(),t=r.merge({key:s,text:p.slice(m),characterList:q.slice(m)}),u=n.toSeq().takeUntil(function(x){return x===o;}),v=n.toSeq().skipUntil(function(x){return x===o;}).rest(),w=u.concat([[r.getKey(),r],[t.getKey(),t]],v).toOrderedMap();return j.merge({blockMap:w,selectionBefore:k,selectionAfter:k.merge({anchorKey:s,anchorOffset:0,focusKey:s,focusOffset:0,isBackward:false})});}f.exports=i;},null);
__d('DraftModifier',['invariant','CharacterMetadata','ContentStateInlineStyle','immutable','applyEntityToContentState','getCharacterRemovalRange','getContentStateFragment','insertFragmentIntoContentState','insertTextIntoContentState','removeEntitiesAtEdges','removeRangeFromContentState','setBlockTypeForContentState','splitBlockInContentState'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').OrderedSet,j={replaceText:function(k,l,m,n,o){var p=c('removeEntitiesAtEdges')(k,l),q=c('removeRangeFromContentState')(p,l),r=c('CharacterMetadata').create({style:n||i(),entity:o||null});return c('insertTextIntoContentState')(q,q.getSelectionAfter(),m,r);},insertText:function(k,l,m,n,o){!l.isCollapsed()?h(0):void 0;return j.replaceText(k,l,m,n,o);},moveText:function(k,l,m){var n=c('getContentStateFragment')(k,l),o=j.removeRange(k,l,'backward');return j.replaceWithFragment(o,m,n);},replaceWithFragment:function(k,l,m){var n=c('removeEntitiesAtEdges')(k,l),o=c('removeRangeFromContentState')(n,l);return c('insertFragmentIntoContentState')(o,o.getSelectionAfter(),m);},removeRange:function(k,l,m){if(l.getAnchorKey()===l.getFocusKey()){var n=l.getAnchorKey(),o=l.getStartOffset(),p=l.getEndOffset(),q=k.getBlockForKey(n),r=q.getEntityAt(o),s=q.getEntityAt(p-1);if(r&&r===s){var t=c('getCharacterRemovalRange')(q,l,m);return c('removeRangeFromContentState')(k,t);}}var u=c('removeEntitiesAtEdges')(k,l);return c('removeRangeFromContentState')(u,l);},splitBlock:function(k,l){var m=c('removeEntitiesAtEdges')(k,l),n=c('removeRangeFromContentState')(m,l);return c('splitBlockInContentState')(n,n.getSelectionAfter());},applyInlineStyle:function(k,l,m){return c('ContentStateInlineStyle').add(k,l,m);},removeInlineStyle:function(k,l,m){return c('ContentStateInlineStyle').remove(k,l,m);},setBlockType:function(k,l,m){return c('setBlockTypeForContentState')(k,l,m);},applyEntity:function(k,l,m){var n=c('removeEntitiesAtEdges')(k,l);return c('applyEntityToContentState')(n,l,m);}};f.exports=j;},null);
__d('getEntityKeyForSelection',['DraftEntity'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(j,k){var l;if(k.isCollapsed()){var m=k.getAnchorKey(),n=k.getAnchorOffset();if(n>0){l=j.getBlockForKey(m).getEntityAt(n-1);return i(l);}return null;}var o=k.getStartKey(),p=k.getStartOffset(),q=j.getBlockForKey(o);l=p===q.getLength()?null:q.getEntityAt(p);return i(l);}function i(j){if(j){var k=c('DraftEntity').get(j);return k.getMutability()==='MUTABLE'?j:null;}return null;}f.exports=h;},null);
__d('isSelectionAtLeafStart',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getSelection(),k=j.getAnchorKey(),l=i.getBlockTree(k),m=j.getStartOffset(),n=false;l.some(function(o){if(m===o.get('start')){n=true;return true;}if(m<o.get('end'))return o.get('leaves').some(function(p){var q=p.get('start');if(m===q){n=true;return true;}if(m<q)return false;});return false;});return n;}f.exports=h;},null);
__d('DraftEditorCompositionHandler',['DraftModifier','EditorState','Keys','getEntityKeyForSelection','isSelectionAtLeafStart'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=20,i=false,j=false,k='',l={onBeforeInput:function(m){k=(k||'')+m.data;},onCompositionStart:function(){j=true;},onCompositionEnd:function(){i=false;j=false;setTimeout(function(){if(!i)l.resolveComposition.call(this);}.bind(this),h);},onKeyDown:function(m){if(m.which===c('Keys').RIGHT||m.which===c('Keys').LEFT)m.preventDefault();},onKeyPress:function(m){if(m.which===c('Keys').RETURN)m.preventDefault();},resolveComposition:function(){if(j)return;i=true;var m=k;k='';var n=c('EditorState').set(this.props.editorState,{inCompositionMode:false}),o=n.getCurrentInlineStyle(),p=c('getEntityKeyForSelection')(n.getCurrentContent(),n.getSelection()),q=!m||c('isSelectionAtLeafStart')(n)||o.size>0||p!==null;if(q)this.restoreEditorDOM();this.exitCurrentMode();this.removeRenderGuard();if(m){var r=c('DraftModifier').replaceText(n.getCurrentContent(),n.getSelection(),m,o,p);this.update(c('EditorState').push(n,r,'insert-characters'));return;}if(q)this.update(c('EditorState').set(n,{nativelyRenderedContent:null,forceSelection:true}));}};f.exports=l;},null);
__d('DraftEditorTextNode.react',['React','ReactDOM','UserAgent'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('UserAgent').isBrowser('IE <= 11');function k(o){return j?o.textContent==='\n':o.tagName==='BR';}var l=j?c('React').createElement('span',{key:'A','data-text':'true'},'\n'):c('React').createElement('br',{key:'A','data-text':'true'}),m=j?c('React').createElement('span',{key:'B','data-text':'true'},'\n'):c('React').createElement('br',{key:'B','data-text':'true'});h=babelHelpers.inherits(n,c('React').Component);i=h&&h.prototype;function n(o){i.constructor.call(this,o);this.$DraftEditorTextNode1=false;}n.prototype.shouldComponentUpdate=function(o){var p=c('ReactDOM').findDOMNode(this),q=o.children==='';if(q)return !k(p);return p.textContent!==o.children;};n.prototype.componentWillUpdate=function(){this.$DraftEditorTextNode1=!this.$DraftEditorTextNode1;};n.prototype.render=function(){if(this.props.children==='')return this.$DraftEditorTextNode1?l:m;return (c('React').createElement('span',{key:this.$DraftEditorTextNode1?'A':'B','data-text':'true'},this.props.children));};f.exports=n;},null);
__d('setDraftEditorSelection',['containsNode','getActiveElement'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(k,l,m,n,o){if(!c('containsNode')(document.documentElement,l))return;var p=b.getSelection(),q=k.getAnchorKey(),r=k.getAnchorOffset(),s=k.getFocusKey(),t=k.getFocusOffset(),u=k.getIsBackward();if(!p.extend&&u){var v=q,w=r;q=s;r=t;s=v;t=w;u=false;}var x=q===m&&n<=r&&o>=r,y=s===m&&n<=t&&o>=t;if(x&&y){p.removeAllRanges();j(p,l,r-n);i(p,l,t-n);return;}if(!u){if(x){p.removeAllRanges();j(p,l,r-n);}if(y)i(p,l,t-n);}else{if(y){p.removeAllRanges();j(p,l,t-n);}if(x){var z=p.focusNode,aa=p.focusOffset;p.removeAllRanges();j(p,l,r-n);i(p,z,aa);}}}function i(k,l,m){if(k.extend&&c('containsNode')(c('getActiveElement')(),l)){k.extend(l,m);}else{var n=k.getRangeAt(0);n.setEnd(l,m);k.addRange(n.cloneRange());}}function j(k,l,m){var n=document.createRange();n.setStart(l,m);k.addRange(n);}f.exports=h;},null);
__d('DraftEditorLeaf.react',['DraftEditorTextNode.react','React','ReactDOM','SelectionState','setDraftEditorSelection'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.$DraftEditorLeaf1=function(){var k=this.props.selection;if(k==null||!k.getHasFocus())return;var l=this.props,m=l.blockKey,n=l.start,o=l.text,p=n+o.length;if(!k.hasEdgeWithin(m,n,p))return;var q=c('ReactDOM').findDOMNode(this),r=q.firstChild,s=void 0;if(r.nodeType===Node.TEXT_NODE){s=r;}else if(r.tagName==='BR'){s=q;}else s=r.firstChild;c('setDraftEditorSelection')(k,s,m,n,p);};j.prototype.shouldComponentUpdate=function(k){return (c('ReactDOM').findDOMNode(this.refs.leaf).textContent!==k.text||k.styleSet!==this.props.styleSet||k.forceSelection);};j.prototype.componentDidUpdate=function(){this.$DraftEditorLeaf1();};j.prototype.componentDidMount=function(){this.$DraftEditorLeaf1();};j.prototype.render=function(){var k=this.props.text;if(k.endsWith('\n')&&this.props.isLast)k+='\n';var l=this.props,m=l.customStyleMap,n=l.offsetKey,o=l.styleSet,p=o.reduce(function(q,r){var s={},t=m[r];if(t!==undefined&&q.textDecoration!==t.textDecoration)s.textDecoration=[q.textDecoration,t.textDecoration].join(' ');return Object.assign(q,t,s);},{});return (c('React').createElement('span',{'data-offset-key':n,ref:'leaf',style:p},c('React').createElement(c('DraftEditorTextNode.react'),null,k)));};function j(){h.apply(this,arguments);}f.exports=j;},null);
__d('DraftOffsetKey',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h='-',i={encode:function(j,k,l){return j+h+k+h+l;},decode:function(j){var k=j.split(h),l=k[0],m=k[1],n=k[2];return {blockKey:l,decoratorKey:parseInt(m,10),leafKey:parseInt(n,10)};}};f.exports=i;},null);
__d('DraftEditorBlock.react',['cx','ContentBlock','DraftEditorLeaf.react','DraftOffsetKey','React','ReactDOM','Scroll','SelectionState','Style','UnicodeBidi','UnicodeBidiDirection','getElementPosition','getScrollPosition','getViewportDimensions','nullthrows'],function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=10;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.shouldComponentUpdate=function(n){return (this.props.block!==n.block||this.props.tree!==n.tree||this.props.direction!==n.direction||m(n.selection,n.block.getKey())&&n.forceSelection);};l.prototype.componentDidMount=function(){var n=this.props.selection,o=n.getEndKey();if(!n.getHasFocus()||o!==this.props.block.getKey())return;var p=c('ReactDOM').findDOMNode(this),q=c('Style').getScrollParent(p),r=c('getScrollPosition')(q),s;if(q===window){var t=c('getElementPosition')(p),u=t.y+t.height,v=c('getViewportDimensions')().height;s=u-v;if(s>0)window.scrollTo(r.x,r.y+s+k);}else{var w=p.offsetHeight+p.offsetTop,x=q.offsetHeight+r.y;s=w-x;if(s>0)c('Scroll').setTop(q,c('Scroll').getTop(q)+s+k);}};l.prototype.$DraftEditorBlock1=function(){var n=this.props.block,o=n.getKey(),p=n.getText(),q=this.props.tree.size-1,r=m(this.props.selection,o);return this.props.tree.map(function(s,t){var u=s.get('leaves'),v=u.size-1,w=u.map(function(ea,fa){var ga=c('DraftOffsetKey').encode(o,t,fa),ha=ea.get('start'),ia=ea.get('end');return (c('React').createElement(c('DraftEditorLeaf.react'),{key:ga,offsetKey:ga,blockKey:o,start:ha,selection:r?this.props.selection:undefined,forceSelection:this.props.forceSelection,text:p.slice(ha,ia),styleSet:n.getInlineStyleAt(ha),customStyleMap:this.props.customStyleMap,isLast:t===q&&fa===v}));}.bind(this)).toArray(),x=s.get('decoratorKey');if(x==null)return w;if(!this.props.decorator)return w;var y=c('nullthrows')(this.props.decorator),z=y.getComponentForKey(x);if(!z)return w;var aa=y.getPropsForKey(x),ba=c('DraftOffsetKey').encode(o,t,0),ca=p.slice(u.first().get('start'),u.last().get('end')),da=c('UnicodeBidiDirection').getHTMLDirIfDifferent(c('UnicodeBidi').getDirection(ca),this.props.direction);return (c('React').createElement(z,babelHelpers['extends']({},aa,{decoratedText:ca,dir:da,key:ba,entityKey:n.getEntityAt(s.get('start')),offsetKey:ba}),w));}.bind(this)).toArray();};l.prototype.render=function(){var n=this.props,o=n.direction,p=n.offsetKey,q="_1mf"+(o==='LTR'?' '+"_1mj":'')+(o==='RTL'?' '+"_1mk":'');return (c('React').createElement('div',{'data-offset-key':p,className:q},this.$DraftEditorBlock1()));};function l(){i.apply(this,arguments);}function m(n,o){return (n.getAnchorKey()===o||n.getFocusKey()===o);}f.exports=l;},null);
__d('DraftEditorContents.react',['cx','DraftEditorBlock.react','DraftOffsetKey','EditorState','React','joinClasses','nullthrows'],function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.shouldComponentUpdate=function(m){var n=this.props.editorState,o=m.editorState,p=n.getDirectionMap(),q=o.getDirectionMap();if(p!==q)return true;var r=n.getSelection().getHasFocus(),s=o.getSelection().getHasFocus();if(r!==s)return true;var t=o.getNativelyRenderedContent(),u=n.isInCompositionMode(),v=o.isInCompositionMode();if(n===o||t!==null&&o.getCurrentContent()===t||u&&v)return false;var w=n.getCurrentContent(),x=o.getCurrentContent(),y=n.getDecorator(),z=o.getDecorator();return (u!==v||w!==x||y!==z||o.mustForceSelection());};k.prototype.render=function(){var m=this.props,n=m.blockRenderMap,o=m.blockRendererFn,p=m.customStyleMap,q=m.editorState,r=q.getCurrentContent(),s=q.getSelection(),t=q.mustForceSelection(),u=q.getDecorator(),v=c('nullthrows')(q.getDirectionMap()),w=r.getBlocksAsArray(),x=[],y=null,z=null,aa=null,ba=void 0,ca=void 0,da=void 0,ea=void 0,fa=void 0,ga=void 0,ha=void 0;for(var ia=0;ia<w.length;ia++){ca=w[ia];da=ca.getKey();ea=ca.getType();var ja=o(ca),ka=void 0,la=void 0,ma=void 0;if(ja){ka=ja.component;la=ja.props;ma=ja.editable;}var na=v.get(da),oa=c('DraftOffsetKey').encode(da,0,0),pa={block:ca,blockProps:la,customStyleMap:p,decorator:u,direction:na,forceSelection:t,key:da,offsetKey:oa,selection:s,tree:q.getBlockTree(da)},qa=c('nullthrows')(n.get(ea));ha=qa.wrapper;var ra=ha!==z,sa=n.get(ea).element||n.get('unstyled').element,ta=ca.getDepth(),ua=this.props.blockStyleFn(ca);if(sa==='li'){var va=ra||aa===null||ta>aa;ua=c('joinClasses')(ua,l(ea,ta,va,na));}var wa=ka||c('DraftEditorBlock.react');ga={className:ua,'data-block':true,'data-editor':this.props.editorKey,'data-offset-key':oa,key:da};if(ma!==undefined)ga=babelHelpers['extends']({},ga,{contentEditable:ma,suppressContentEditableWarning:true});fa=c('React').createElement(sa,ga,c('React').createElement(wa,pa));if(ha){if(ra){ba=[];y=c('React').cloneElement(ha,{key:da+'-wrap','data-offset-key':oa},ba);z=ha;x.push(y);}aa=ca.getDepth();c('nullthrows')(ba).push(fa);}else{ba=null;y=null;z=null;aa=null;x.push(fa);}}return c('React').createElement('div',{'data-contents':'true'},x);};function k(){i.apply(this,arguments);}function l(m,n,o,p){return (m==='unordered-list-item'?"_3kpz":'')+(m==='ordered-list-item'?' '+"_3kp_":'')+(o?' '+"_3kq0":'')+(n===0?' '+"_3kq1":'')+(n===1?' '+"_3kq2":'')+(n===2?' '+"_3kq3":'')+(n===3?' '+"_3kq4":'')+(n===4?' '+"_3kq5":'')+(p==='LTR'?' '+"_3kq6":'')+(p==='RTL'?' '+"_3kq7":'');}f.exports=k;},null);
__d('getSelectionOffsetKeyForNode',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){return i instanceof Element?i.getAttribute('data-offset-key'):null;}f.exports=h;},null);
__d('findAncestorOffsetKey',['getSelectionOffsetKeyForNode'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i;while(j&&j!==document.documentElement){var k=c('getSelectionOffsetKeyForNode')(j);if(k!=null)return k;j=j.parentNode;}return null;}f.exports=h;},null);
__d('getTextContentFromFiles',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=/\.textClipping$/,i={'text/plain':true,'text/html':true,'text/rtf':true},j=5000;function k(m,n){var o=0,p=[];m.forEach(function(q){l(q,function(r){o++;r&&p.push(r.slice(0,j));if(o==m.length)n(p.join('\r'));});});}function l(m,n){if(!b.FileReader||m.type&&!(m.type in i)){n('');return;}if(m.type===''){var o='';if(h.test(m.name))o=m.name.replace(h,'');n(o);return;}var p=new FileReader();p.onload=function(){n(p.result);};p.onerror=function(){n('');};p.readAsText(m);}f.exports=k;},null);
__d('getUpdatedSelectionState',['DraftOffsetKey','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k,l,m){var n=c('nullthrows')(i.getSelection()),o=c('DraftOffsetKey').decode(j),p=o.blockKey,q=i.getBlockTree(p).getIn([o.decoratorKey,'leaves',o.leafKey]),r=c('DraftOffsetKey').decode(l),s=r.blockKey,t=i.getBlockTree(s).getIn([r.decoratorKey,'leaves',r.leafKey]),u=q.get('start'),v=t.get('start'),w=q?u+k:null,x=t?v+m:null,y=n.getAnchorKey()===p&&n.getAnchorOffset()===w&&n.getFocusKey()===s&&n.getFocusOffset()===x;if(y)return n;var z=false;if(p===s){var aa=q.get('end'),ba=t.get('end');if(v===u&&ba===aa){z=m<k;}else z=v<u;}else{var ca=i.getCurrentContent().getBlockMap().keySeq().skipUntil(function(da){return da===p||da===s;}).first();z=ca===s;}return n.merge({anchorKey:p,anchorOffset:w,focusKey:s,focusOffset:x,isBackward:z});}f.exports=h;},null);
__d('DraftEditorDragHandler',['DataTransfer','DraftModifier','EditorState','findAncestorOffsetKey','getTextContentFromFiles','getUpdatedSelectionState','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(event,l){var m=null,n=null;if(document.caretRangeFromPoint){var o=document.caretRangeFromPoint(event.x,event.y);m=o.startContainer;n=o.startOffset;}else if(event.rangeParent){m=event.rangeParent;n=event.rangeOffset;}else return null;m=c('nullthrows')(m);n=c('nullthrows')(n);var p=c('nullthrows')(c('findAncestorOffsetKey')(m));return c('getUpdatedSelectionState')(l,p,n,p,n);}var i={onDragEnd:function(){this.exitCurrentMode();},onDrop:function(l){var m=new (c('DataTransfer'))(l.nativeEvent.dataTransfer),n=this.props.editorState,o=h(l.nativeEvent,n);l.preventDefault();this.exitCurrentMode();if(o==null)return;var p=m.getFiles();if(p.length>0){if(this.props.handleDroppedFiles&&this.props.handleDroppedFiles(o,p))return;c('getTextContentFromFiles')(p,function(r){r&&this.update(k(n,c('nullthrows')(o),r));}.bind(this));return;}var q=this._internalDrag?'internal':'external';if(this.props.handleDrop&&this.props.handleDrop(o,m,q))return;if(this._internalDrag){this.update(j(n,o));return;}this.update(k(n,o,m.getText()));}};function j(l,m){var n=c('DraftModifier').moveText(l.getCurrentContent(),l.getSelection(),m);return c('EditorState').push(l,n,'insert-fragment');}function k(l,m,n){var o=c('DraftModifier').insertText(l.getCurrentContent(),m,n,l.getCurrentInlineStyle());return c('EditorState').push(l,o,'insert-fragment');}f.exports=i;},null);
__d('editOnBeforeInput',['BlockTree','DraftModifier','EditorState','UserAgent','getEntityKeyForSelection','isSelectionAtLeafStart','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h='\'',i='\/',j=c('UserAgent').isBrowser('Firefox');function k(n){return (j&&(n==h||n==i));}function l(n,o,p,q){var r=c('DraftModifier').replaceText(n.getCurrentContent(),n.getSelection(),o,p,q);return c('EditorState').push(n,r,'insert-characters');}function m(n){var o=n.data;if(!o)return;if(this.props.handleBeforeInput&&this.props.handleBeforeInput(o)){n.preventDefault();return;}var p=this.props.editorState,q=p.getSelection();if(!q.isCollapsed()){n.preventDefault();this.update(l(p,o,p.getCurrentInlineStyle(),c('getEntityKeyForSelection')(p.getCurrentContent(),p.getSelection())));return;}var r=!c('isSelectionAtLeafStart')(p),s=l(p,o,p.getCurrentInlineStyle(),c('getEntityKeyForSelection')(p.getCurrentContent(),p.getSelection()));if(!r){n.preventDefault();this.update(s);return;}var t=q.getAnchorKey(),u=p.getBlockTree(t),v=c('BlockTree').getFingerprint(u),w=c('BlockTree').getFingerprint(s.getBlockTree(t));if(k(o)||v!==w||c('nullthrows')(s.getDirectionMap()).get(t)!==c('nullthrows')(p.getDirectionMap()).get(t)){n.preventDefault();}else s=c('EditorState').set(s,{nativelyRenderedContent:s.getCurrentContent()});this.update(s);}f.exports=m;},null);
__d('editOnBlur',['EditorState','UserAgent','getActiveElement'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('UserAgent').isEngine('WebKit');function i(j){if(h&&c('getActiveElement')()===document.body)b.getSelection().removeAllRanges();var k=this.props.editorState,l=k.getSelection();if(!l.getHasFocus())return;var m=l.set('hasFocus',false);this.props.onBlur&&this.props.onBlur(j);this.update(c('EditorState').acceptSelection(k,m));}f.exports=i;},null);
__d('editOnCompositionStart',['EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.setRenderGuard();this.setMode('composite');this.update(c('EditorState').set(this.props.editorState,{inCompositionMode:true}));}f.exports=h;},null);
__d('getFragmentFromSelection',['getContentStateFragment'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getSelection();if(!j.isCollapsed())return c('getContentStateFragment')(i.getCurrentContent(),j);}f.exports=h;},null);
__d('editOnCopy',['getFragmentFromSelection'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=this.props.editorState,k=j.getSelection();if(k.isCollapsed()){i.preventDefault();return;}this.setClipboard(c('getFragmentFromSelection')(this.props.editorState));}f.exports=h;},null);
__d('editOnCut',['DraftModifier','EditorState','Style','getFragmentFromSelection','getScrollPosition'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(j){var k=this.props.editorState,l=k.getSelection();if(l.isCollapsed()){j.preventDefault();return;}var m=c('Style').getScrollParent(j.target),n=c('getScrollPosition')(m),o=n.x,p=n.y,q=c('getFragmentFromSelection')(k);this.setClipboard(q);this.setRenderGuard();this.setMode('cut');setTimeout(function(){this.restoreEditorDOM({x:o,y:p});this.removeRenderGuard();this.exitCurrentMode();this.update(i(k));}.bind(this),0);}function i(j){var k=c('DraftModifier').removeRange(j.getCurrentContent(),j.getSelection(),'forward');return c('EditorState').push(j,k,'remove-range');}f.exports=h;},null);
__d('editOnDragOver',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){this._internalDrag=false;this.setMode('drag');i.preventDefault();}f.exports=h;},null);
__d('editOnDragStart',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this._internalDrag=true;this.setMode('drag');}f.exports=h;},null);
__d('editOnFocus',['EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=this.props.editorState,k=j.getSelection();if(k.getHasFocus())return;var l=k.set('hasFocus',true);this.props.onFocus&&this.props.onFocus(i);this.update(c('EditorState').forceSelection(j,l));}f.exports=h;},null);
__d('editOnInput',['DraftModifier','DraftOffsetKey','EditorState','DraftEntity','UserAgent','findAncestorOffsetKey','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('UserAgent').isEngine('Gecko'),i='\n\n';function j(){var k=b.getSelection(),l=k.anchorNode,m=k.isCollapsed;if(l.nodeType!==Node.TEXT_NODE)return;var n=l.textContent,o=this.props.editorState,p=c('nullthrows')(c('findAncestorOffsetKey')(l)),q=c('DraftOffsetKey').decode(p),r=q.blockKey,s=q.decoratorKey,t=q.leafKey,u=o.getBlockTree(r).getIn([s,'leaves',t]),v=u.start,w=u.end,x=o.getCurrentContent(),y=x.getBlockForKey(r),z=y.getText().slice(v,w);if(n.endsWith(i))n=n.slice(0,-1);if(n===z)return;var aa=o.getSelection(),ba=aa.merge({anchorOffset:v,focusOffset:w,isBackward:false}),ca=y.getEntityAt(v),da=ca&&c('DraftEntity').get(ca),ea=da&&da.getMutability(),fa=ea==='MUTABLE',ga=fa?'spellcheck-change':'apply-entity',ha=c('DraftModifier').replaceText(x,ba,n,y.getInlineStyleAt(v),fa?y.getEntityAt(v):null),ia,ja,ka,la;if(h){ia=k.anchorOffset;ja=k.focusOffset;ka=v+Math.min(ia,ja);la=ka+Math.abs(ia-ja);ia=ka;ja=la;}else{var ma=n.length-z.length;ka=aa.getStartOffset();la=aa.getEndOffset();ia=m?la+ma:ka;ja=la+ma;}var na=ha.merge({selectionBefore:x.getSelectionAfter(),selectionAfter:aa.merge({anchorOffset:ia,focusOffset:ja})});this.update(c('EditorState').push(o,na,ga));}f.exports=j;},null);
__d('KeyBindingUtil',['UserAgent'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('UserAgent').isPlatform('Mac OS X'),i={isCtrlKeyCommand:function(j){return !!j.ctrlKey&&!j.altKey;},isOptionKeyCommand:function(j){return h&&j.altKey;},hasCommandModifier:function(j){return h?!!j.metaKey&&!j.altKey:i.isCtrlKeyCommand(j);}};f.exports=i;},null);
__d('SecondaryClipboard',['DraftModifier','EditorState','getContentStateFragment','nullthrows'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=null,i={cut:function(j){var k=j.getCurrentContent(),l=j.getSelection(),m=null;if(l.isCollapsed()){var n=l.getAnchorKey(),o=k.getBlockForKey(n).getLength();if(o===l.getAnchorOffset())return j;m=l.set('focusOffset',o);}else m=l;m=c('nullthrows')(m);h=c('getContentStateFragment')(k,m);var p=c('DraftModifier').removeRange(k,m,'forward');if(p===k)return j;return c('EditorState').push(j,p,'remove-range');},paste:function(j){if(!h)return j;var k=c('DraftModifier').replaceWithFragment(j.getCurrentContent(),j.getSelection(),h);return c('EditorState').push(j,k,'insert-fragment');}};f.exports=i;},null);
__d('getRangeClientRects',['invariant','UserAgent'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('UserAgent').isBrowser('Chrome');function j(l){var m=l.cloneRange(),n=[];for(var o=l.endContainer;o!=null;o=o.parentNode){var p=o===l.commonAncestorContainer;if(p){m.setStart(l.startContainer,l.startOffset);}else m.setStart(m.endContainer,0);var q=Array.from(m.getClientRects());n.push(q);if(p){var r;n.reverse();return (r=[]).concat.apply(r,n);}m.setEndBefore(o);}h(0);}var k=i?j:function(l){return Array.from(l.getClientRects());};f.exports=k;},null);
__d('expandRangeToStartOfLine',['invariant','UnicodeUtils','getRangeClientRects'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(m){var n=getComputedStyle(m),o=document.createElement('div');o.style.fontFamily=n.fontFamily;o.style.fontSize=n.fontSize;o.style.fontStyle=n.fontStyle;o.style.fontWeight=n.fontWeight;o.style.lineHeight=n.lineHeight;o.style.position='absolute';o.textContent='M';document.body.appendChild(o);var p=o.getBoundingClientRect();document.body.removeChild(o);return p.height;}function j(m,n){var o=Infinity,p=Infinity,q=-Infinity,r=-Infinity;for(var s=0;s<m.length;s++){var t=m[s];if(t.width===0||t.width===1)continue;o=Math.min(o,t.top);p=Math.min(p,t.bottom);q=Math.max(q,t.top);r=Math.max(r,t.bottom);}return (q<=p&&q-o<n&&r-p<n);}function k(m){switch(m.nodeType){case Node.DOCUMENT_TYPE_NODE:return 0;case Node.TEXT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.COMMENT_NODE:return m.length;default:return m.childNodes.length;}}function l(m){!m.collapsed?h(0):void 0;m=m.cloneRange();var n=m.startContainer;if(n.nodeType!==1)n=n.parentNode;var o=i(n),p=m.endContainer,q=m.endOffset;m.setStart(m.startContainer,0);while(j(c('getRangeClientRects')(m),o)){p=m.startContainer;q=m.startOffset;!p.parentNode?h(0):void 0;m.setStartBefore(p);if(p.nodeType===1&&getComputedStyle(p).display!=='inline')break;}var r=p,s=q-1;do{var t=r.nodeValue;for(var u=s;u>=0;u--){if(t!=null&&u>0&&c('UnicodeUtils').isSurrogatePair(t,u-1))continue;m.setStart(r,u);if(j(c('getRangeClientRects')(m),o)){p=r;q=u;}else break;}if(u===-1||r.childNodes.length===0)break;r=r.childNodes[u];s=k(r);}while(true);m.setStart(p,q);return m;}f.exports=l;},null);
__d('getDraftEditorSelectionWithNodes',['invariant','findAncestorOffsetKey','getSelectionOffsetKeyForNode','getUpdatedSelectionState','nullthrows'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(n,o,p,q,r,s){var t=p.nodeType===Node.TEXT_NODE,u=r.nodeType===Node.TEXT_NODE;if(t&&u)return {selectionState:c('getUpdatedSelectionState')(n,c('nullthrows')(c('findAncestorOffsetKey')(p)),q,c('nullthrows')(c('findAncestorOffsetKey')(r)),s),needsRecovery:false};var v=null,w=null,x=true;if(t){v={key:c('nullthrows')(c('findAncestorOffsetKey')(p)),offset:q};w=l(o,r,s);}else if(u){w={key:c('nullthrows')(c('findAncestorOffsetKey')(r)),offset:s};v=l(o,p,q);}else{v=l(o,p,q);w=l(o,r,s);if(p===r&&q===s)x=!!p.firstChild&&p.firstChild.nodeName!=='BR';}return {selectionState:c('getUpdatedSelectionState')(n,v.key,v.offset,w.key,w.offset),needsRecovery:x};}function j(n){while(n.firstChild&&c('getSelectionOffsetKeyForNode')(n.firstChild))n=n.firstChild;return n;}function k(n){while(n.lastChild&&c('getSelectionOffsetKeyForNode')(n.lastChild))n=n.lastChild;return n;}function l(n,o,p){var q=o,r=c('findAncestorOffsetKey')(q);!(r!=null||n&&(n===q||n.firstChild===q))?h(0):void 0;if(n===q){q=q.firstChild;!(q instanceof Element&&q.getAttribute('data-contents')==='true')?h(0):void 0;if(p>0)p=q.childNodes.length;}if(p===0){var s=null;if(r!=null){s=r;}else{var t=j(q);s=c('nullthrows')(c('getSelectionOffsetKeyForNode')(t));}return {key:s,offset:0};}var u=q.childNodes[p-1],v=null,w=null;if(!c('getSelectionOffsetKeyForNode')(u)){v=c('nullthrows')(r);w=m(u);}else{var x=k(u);v=c('nullthrows')(c('getSelectionOffsetKeyForNode')(x));w=m(x);}return {key:v,offset:w};}function m(n){var o=n.textContent;return o==='\n'?0:o.length;}f.exports=i;},null);
__d('moveSelectionBackward',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=i.getSelection(),l=i.getCurrentContent(),m=k.getStartKey(),n=k.getStartOffset(),o=m,p=0;if(j>n){var q=l.getKeyBefore(m);if(q==null){o=m;}else{o=q;var r=l.getBlockForKey(q);p=r.getText().length;}}else p=n-j;return k.merge({focusKey:o,focusOffset:p,isBackward:true});}f.exports=h;},null);
__d('removeTextWithStrategy',['DraftModifier'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=i.getSelection(),m=i.getCurrentContent(),n=l;if(l.isCollapsed()){if(k==='forward'){if(i.isSelectionAtEndOfContent())return m;}else if(i.isSelectionAtStartOfContent())return m;n=j(i);if(n===l)return m;}return c('DraftModifier').removeRange(m,n,k);}f.exports=h;},null);
__d('keyCommandBackspaceToStartOfLine',['EditorState','expandRangeToStartOfLine','getDraftEditorSelectionWithNodes','moveSelectionBackward','removeTextWithStrategy'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('removeTextWithStrategy')(i,function(k){var l=k.getSelection();if(l.isCollapsed()&&l.getAnchorOffset()===0)return c('moveSelectionBackward')(k,1);var m=b.getSelection(),n=m.getRangeAt(0);n=c('expandRangeToStartOfLine')(n);return c('getDraftEditorSelectionWithNodes')(k,null,n.endContainer,n.endOffset,n.startContainer,n.startOffset).selectionState;},'backward');if(j===i.getCurrentContent())return i;return c('EditorState').push(i,j,'remove-range');}f.exports=h;},null);
__d('DraftRemovableWord',['TokenizeUtil'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('TokenizeUtil').getPunctuation(),i='[\'\u2018\u2019]',j='\\s|(?![_])'+h,k='^'+'(?:'+j+')*'+'(?:'+i+'|(?!'+j+').)*'+'(?:(?!'+j+').)',l=new RegExp(k),m='(?:(?!'+j+').)'+'(?:'+i+'|(?!'+j+').)*'+'(?:'+j+')*'+'$',n=new RegExp(m);function o(q,r){var s=r?n.exec(q):l.exec(q);return s?s[0]:q;}var p={getBackward:function(q){return o(q,true);},getForward:function(q){return o(q,false);}};f.exports=p;},null);
__d('keyCommandBackspaceWord',['DraftRemovableWord','EditorState','moveSelectionBackward','removeTextWithStrategy'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('removeTextWithStrategy')(i,function(k){var l=k.getSelection(),m=l.getStartOffset();if(m===0)return c('moveSelectionBackward')(k,1);var n=l.getStartKey(),o=k.getCurrentContent(),p=o.getBlockForKey(n).getText().slice(0,m),q=c('DraftRemovableWord').getBackward(p);return c('moveSelectionBackward')(k,q.length||1);},'backward');if(j===i.getCurrentContent())return i;return c('EditorState').push(i,j,'remove-range');}f.exports=h;},null);
__d('moveSelectionForward',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=i.getSelection(),l=k.getStartKey(),m=k.getStartOffset(),n=i.getCurrentContent(),o=l,p,q=n.getBlockForKey(l);if(j>q.getText().length-m){o=n.getKeyAfter(l);p=0;}else p=m+j;return k.merge({focusKey:o,focusOffset:p});}f.exports=h;},null);
__d('keyCommandDeleteWord',['DraftRemovableWord','EditorState','moveSelectionForward','removeTextWithStrategy'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('removeTextWithStrategy')(i,function(k){var l=k.getSelection(),m=l.getStartOffset(),n=l.getStartKey(),o=k.getCurrentContent(),p=o.getBlockForKey(n).getText().slice(m),q=c('DraftRemovableWord').getForward(p);return c('moveSelectionForward')(k,q.length||1);},'forward');if(j===i.getCurrentContent())return i;return c('EditorState').push(i,j,'remove-range');}f.exports=h;},null);
__d('keyCommandInsertNewline',['DraftModifier','EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('DraftModifier').splitBlock(i.getCurrentContent(),i.getSelection());return c('EditorState').push(i,j,'split-block');}f.exports=h;},null);
__d('keyCommandMoveSelectionToEndOfBlock',['EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getSelection(),k=j.getEndKey(),l=i.getCurrentContent(),m=l.getBlockForKey(k).getLength();return c('EditorState').set(i,{selection:j.merge({anchorKey:k,anchorOffset:m,focusKey:k,focusOffset:m,isBackward:false}),forceSelection:true});}f.exports=h;},null);
__d('keyCommandMoveSelectionToStartOfBlock',['EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getSelection(),k=j.getStartKey();return c('EditorState').set(i,{selection:j.merge({anchorKey:k,anchorOffset:0,focusKey:k,focusOffset:0,isBackward:false}),forceSelection:true});}f.exports=h;},null);
__d('keyCommandPlainBackspace',['EditorState','UnicodeUtils','moveSelectionBackward','removeTextWithStrategy'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('removeTextWithStrategy')(i,function(l){var m=l.getSelection(),n=l.getCurrentContent(),o=m.getAnchorKey(),p=m.getAnchorOffset(),q=n.getBlockForKey(o).getText()[p-1];return c('moveSelectionBackward')(l,q?c('UnicodeUtils').getUTF16Length(q,0):1);},'backward');if(j===i.getCurrentContent())return i;var k=i.getSelection();return c('EditorState').push(i,j.set('selectionBefore',k),k.isCollapsed()?'backspace-character':'remove-range');}f.exports=h;},null);
__d('keyCommandPlainDelete',['EditorState','UnicodeUtils','moveSelectionForward','removeTextWithStrategy'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=c('removeTextWithStrategy')(i,function(l){var m=l.getSelection(),n=l.getCurrentContent(),o=m.getAnchorKey(),p=m.getAnchorOffset(),q=n.getBlockForKey(o).getText()[p];return c('moveSelectionForward')(l,q?c('UnicodeUtils').getUTF16Length(q,0):1);},'forward');if(j===i.getCurrentContent())return i;var k=i.getSelection();return c('EditorState').push(i,j.set('selectionBefore',k),k.isCollapsed()?'delete-character':'remove-range');}f.exports=h;},null);
__d('keyCommandTransposeCharacters',['DraftModifier','EditorState','getContentStateFragment'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getSelection();if(!j.isCollapsed())return i;var k=j.getAnchorOffset();if(k===0)return i;var l=j.getAnchorKey(),m=i.getCurrentContent(),n=m.getBlockForKey(l),o=n.getLength();if(o<=1)return i;var p,q;if(k===o){p=j.set('anchorOffset',k-1);q=j;}else{p=j.set('focusOffset',k+1);q=p.set('anchorOffset',k+1);}var r=c('getContentStateFragment')(m,p),s=c('DraftModifier').removeRange(m,p,'backward'),t=s.getSelectionAfter(),u=t.getAnchorOffset()-1,v=t.merge({anchorOffset:u,focusOffset:u}),w=c('DraftModifier').replaceWithFragment(s,v,r),x=c('EditorState').push(i,w,'insert-fragment');return c('EditorState').acceptSelection(x,q);}f.exports=h;},null);
__d('keyCommandUndo',['EditorState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=c('EditorState').undo(j);if(j.getLastChangeType()==='spellcheck-change'){var m=l.getCurrentContent();k(c('EditorState').set(l,{nativelyRenderedContent:m}));return;}i.preventDefault();if(!j.getNativelyRenderedContent()){k(l);return;}k(c('EditorState').set(j,{nativelyRenderedContent:null}));setTimeout(function(){k(l);},0);}f.exports=h;},null);
__d('editOnKeyDown',['DraftModifier','EditorState','KeyBindingUtil','Keys','SecondaryClipboard','UserAgent','keyCommandBackspaceToStartOfLine','keyCommandBackspaceWord','keyCommandDeleteWord','keyCommandInsertNewline','keyCommandPlainBackspace','keyCommandPlainDelete','keyCommandMoveSelectionToEndOfBlock','keyCommandMoveSelectionToStartOfBlock','keyCommandTransposeCharacters','keyCommandUndo'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('KeyBindingUtil').isOptionKeyCommand,i=c('UserAgent').isBrowser('Chrome');function j(l,m){switch(l){case 'redo':return c('EditorState').redo(m);case 'delete':return c('keyCommandPlainDelete')(m);case 'delete-word':return c('keyCommandDeleteWord')(m);case 'backspace':return c('keyCommandPlainBackspace')(m);case 'backspace-word':return c('keyCommandBackspaceWord')(m);case 'backspace-to-start-of-line':return c('keyCommandBackspaceToStartOfLine')(m);case 'split-block':return c('keyCommandInsertNewline')(m);case 'transpose-characters':return c('keyCommandTransposeCharacters')(m);case 'move-selection-to-start-of-block':return c('keyCommandMoveSelectionToStartOfBlock')(m);case 'move-selection-to-end-of-block':return c('keyCommandMoveSelectionToEndOfBlock')(m);case 'secondary-cut':return c('SecondaryClipboard').cut(m);case 'secondary-paste':return c('SecondaryClipboard').paste(m);default:return m;}}function k(l){var m=l.which,n=this.props.editorState;switch(m){case c('Keys').RETURN:l.preventDefault();if(this.props.handleReturn&&this.props.handleReturn(l))return;break;case c('Keys').ESC:l.preventDefault();this.props.onEscape&&this.props.onEscape(l);return;case c('Keys').TAB:this.props.onTab&&this.props.onTab(l);return;case c('Keys').UP:this.props.onUpArrow&&this.props.onUpArrow(l);return;case c('Keys').DOWN:this.props.onDownArrow&&this.props.onDownArrow(l);return;case c('Keys').SPACE:if(i&&h(l)){l.preventDefault();var o=c('DraftModifier').replaceText(n.getCurrentContent(),n.getSelection(),'\u00a0');this.update(c('EditorState').push(n,o,'insert-characters'));return;}}var p=this.props.keyBindingFn(l);if(!p)return;if(p==='undo'){c('keyCommandUndo')(l,n,this.update);return;}l.preventDefault();if(this.props.handleKeyCommand&&this.props.handleKeyCommand(p))return;var q=j(p,n);if(q!==n)this.update(q);}f.exports=k;},null);
__d('convertFromHTMLToContentBlocks',['invariant','CharacterMetadata','ContentBlock','DefaultDraftBlockRenderMap','DraftEntity','immutable','URI','generateRandomKey','getSafeBodyFromHTML','nullthrows','sanitizeDraftText'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').OrderedSet,k='&nbsp;',l=' ',m=4,n=new RegExp('\r','g'),o=new RegExp('\n','g'),p=new RegExp(k,'g'),q={b:'BOLD',code:'CODE',del:'STRIKETHROUGH',em:'ITALIC',i:'ITALIC',s:'STRIKETHROUGH',strike:'STRIKETHROUGH',strong:'BOLD',u:'UNDERLINE'},r;function s(){return {text:'',inlines:[],entities:[],blocks:[]};}function t(ha){var ia=new Array(1);if(ha)ia[0]=ha;return {text:l,inlines:[j()],entities:ia,blocks:[]};}function u(){return {text:'\n',inlines:[j()],entities:new Array(1),blocks:[]};}function v(ha,ia){return {text:'\r',inlines:[j()],entities:new Array(1),blocks:[{type:ha,depth:Math.max(0,Math.min(m,ia))}]};}function w(ha,ia){if(ha==='li')return ia==='ol'?'ordered-list-item':'unordered-list-item';return null;}function x(ha){var ia=ha.get('unstyled').element;return ha.map(function(ja){return ja.element;}).valueSeq().toSet().filter(function(ja){return ja!==ia;}).toArray().sort();}function y(ha,ia,ja){for(var ka=0;ka<ja.length;ka++){var la=ja[ka](ha,ia);if(la)return la;}return null;}function z(ha,ia,ja){var ka=ja.filter(function(la){return la.element===ha||la.wrapper===ha;}).keySeq().toSet().toArray().sort();switch(ka.length){case 0:return 'unstyled';case 1:return ka[0];default:return (y(ha,ia,[w])||'unstyled');}}function aa(ha,ia,ja){var ka=q[ha];if(ka){ja=ja.add(ka).toOrderedSet();}else if(ia instanceof HTMLElement)(function(){var la=ia;ja=ja.withMutations(function(ma){if(la.style.fontWeight==='bold')ma.add('BOLD');if(la.style.fontStyle==='italic')ma.add('ITALIC');if(la.style.textDecoration==='underline')ma.add('UNDERLINE');if(la.style.textDecoration==='line-through')ma.add('STRIKETHROUGH');}).toOrderedSet();})();return ja;}function ba(ha,ia){var ja=ha.text.slice(-1),ka=ia.text.slice(0,1);if(ja==='\r'&&ka==='\r'){ha.text=ha.text.slice(0,-1);ha.inlines.pop();ha.entities.pop();ha.blocks.pop();}if(ja==='\r')if(ia.text===l||ia.text==='\n'){return ha;}else if(ka===l||ka==='\n'){ia.text=ia.text.slice(1);ia.inlines.shift();ia.entities.shift();}return {text:ha.text+ia.text,inlines:ha.inlines.concat(ia.inlines),entities:ha.entities.concat(ia.entities),blocks:ha.blocks.concat(ia.blocks)};}function ca(ha,ia){return ia.some(function(ja){return ha.indexOf('<'+ja)!==-1;});}function da(ha){!(ha instanceof HTMLAnchorElement)?h(0):void 0;var ia=ha.protocol;return ia==='http:'||ia==='https:';}function ea(ha,ia,ja,ka,la,ma,na,oa){var pa=ha.nodeName.toLowerCase(),qa=false,ra='unstyled',sa=r;if(pa==='#text'){var ta=ha.textContent;if(ta.trim()===''&&ka!=='pre')return t(oa);if(ka!=='pre')ta=ta.replace(o,l);r=pa;return {text:ta,inlines:Array(ta.length).fill(ia),entities:Array(ta.length).fill(oa),blocks:[]};}r=pa;if(pa==='br'){if(sa==='br'&&(!ka||z(ka,ja,na)==='unstyled'))return v('unstyled',ma);return u();}var ua=s(),va=null;ia=aa(pa,ha,ia);if(pa==='ul'||pa==='ol'){if(ja)ma+=1;ja=pa;}if(!ka&&la.indexOf(pa)!==-1){ua=v(z(pa,ja,na),ma);ka=pa;qa=true;}else if(ja&&ka==='li'&&pa==='li'){ua=v(z(pa,ja,na),ma);ka=pa;qa=true;ra=ja==='ul'?'unordered-list-item':'ordered-list-item';}var wa=ha.firstChild;if(wa!=null)pa=wa.nodeName.toLowerCase();var xa=null,ya=null;while(wa){if(pa==='a'&&wa.href&&da(wa)){ya=new (c('URI'))(wa.href).toString();xa=c('DraftEntity').create('LINK','MUTABLE',{url:ya});}else xa=undefined;va=ea(wa,ia,ja,ka,la,ma,na,xa||oa);ua=ba(ua,va);var za=wa.nextSibling;if(za&&la.indexOf(pa)>=0&&ka)ua=ba(ua,u());if(za)pa=za.nodeName.toLowerCase();wa=za;}if(qa)ua=ba(ua,v(ra,ma));return ua;}function fa(ha,ia,ja){ha=ha.trim().replace(n,'').replace(p,l);var ka=x(ja),la=ia(ha);if(!la)return null;r=null;var ma=ca(ha,ka)?ka:['div'],na=ea(la,j(),'ul',null,ma,-1,ja);if(na.text.indexOf('\r')===0)na={text:na.text.slice(1),inlines:na.inlines.slice(1),entities:na.entities.slice(1),blocks:na.blocks};if(na.text.slice(-1)==='\r'){na.text=na.text.slice(0,-1);na.inlines=na.inlines.slice(0,-1);na.entities=na.entities.slice(0,-1);na.blocks.pop();}if(na.blocks.length===0)na.blocks.push({type:'unstyled',depth:0});if(na.text.split('\r').length===na.blocks.length+1)na.blocks.unshift({type:'unstyled',depth:0});return na;}function ga(ha){var ia=arguments.length<=1||arguments[1]===undefined?c('getSafeBodyFromHTML'):arguments[1],ja=arguments.length<=2||arguments[2]===undefined?c('DefaultDraftBlockRenderMap'):arguments[2],ka=fa(ha,ia,ja);if(ka==null)return null;var la=0;return ka.text.split('\r').map(function(ma,na){ma=c('sanitizeDraftText')(ma);var oa=la+ma.length,pa=c('nullthrows')(ka).inlines.slice(la,oa),qa=c('nullthrows')(ka).entities.slice(la,oa),ra=i(pa.map(function(sa,ta){var ua={style:sa,entity:null};if(qa[ta])ua.entity=qa[ta];return c('CharacterMetadata').create(ua);}));la=oa+1;return new (c('ContentBlock'))({key:c('generateRandomKey')(),type:c('nullthrows')(ka).blocks[na].type,depth:c('nullthrows')(ka).blocks[na].depth,text:ma,characterList:ra});});}f.exports=ga;},null);
__d('DraftPasteProcessor',['CharacterMetadata','ContentBlock','immutable','convertFromHTMLToContentBlocks','generateRandomKey','getSafeBodyFromHTML','sanitizeDraftText'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i=c('immutable').Repeat,j={processHTML:function(k,l){return c('convertFromHTMLToContentBlocks')(k,c('getSafeBodyFromHTML'),l);},processText:function(k,l){return k.map(function(m){m=c('sanitizeDraftText')(m);return new (c('ContentBlock'))({key:c('generateRandomKey')(),type:'unstyled',text:m,characterList:h(i(l,m.length))});});}};f.exports=j;},null);
__d('splitTextIntoTextBlocks',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=/\r\n?|\n/g;function i(j){return j.split(h);}f.exports=i;},null);
__d('editOnPaste',['BlockMapBuilder','CharacterMetadata','DataTransfer','DraftModifier','DraftPasteProcessor','EditorState','getEntityKeyForSelection','getTextContentFromFiles','splitTextIntoTextBlocks'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(j){j.preventDefault();var k=new (c('DataTransfer'))(j.clipboardData);if(!k.isRichText()){var l=k.getFiles(),m=k.getText();if(l.length>0){if(this.props.handlePastedFiles&&this.props.handlePastedFiles(l))return;c('getTextContentFromFiles')(l,function(x){x=x||m;if(!x)return;var y=this.props.editorState,z=c('splitTextIntoTextBlocks')(x),aa=c('CharacterMetadata').create({style:y.getCurrentInlineStyle(),entity:c('getEntityKeyForSelection')(y.getCurrentContent(),y.getSelection())}),ba=c('DraftPasteProcessor').processText(z,aa),ca=c('BlockMapBuilder').createFromArray(ba),da=c('DraftModifier').replaceWithFragment(y.getCurrentContent(),y.getSelection(),ca);this.update(c('EditorState').push(y,da,'insert-fragment'));}.bind(this));return;}}var n=[],o=k.getText(),p=k.getHTML();if(this.props.handlePastedText&&this.props.handlePastedText(o,p))return;if(o)n=c('splitTextIntoTextBlocks')(o);if(!this.props.stripPastedStyles){var q=this.getClipboard();if(k.isRichText()&&q)if(p.indexOf(this.getEditorKey())!==-1||n.length===1&&q.size===1&&q.first().getText()===o){this.update(i(this.props.editorState,q));return;}if(p){var r=c('DraftPasteProcessor').processHTML(p,this.props.blockRenderMap);if(r){var s=c('BlockMapBuilder').createFromArray(r);this.update(i(this.props.editorState,s));return;}}this.setClipboard(null);}if(n){var t=this.props.editorState,u=c('CharacterMetadata').create({style:t.getCurrentInlineStyle(),entity:c('getEntityKeyForSelection')(t.getCurrentContent(),t.getSelection())}),v=c('DraftPasteProcessor').processText(n,u),w=c('BlockMapBuilder').createFromArray(v);this.update(i(this.props.editorState,w));}}function i(j,k){var l=c('DraftModifier').replaceWithFragment(j.getCurrentContent(),j.getSelection(),k);return c('EditorState').push(j,l,'insert-fragment');}f.exports=h;},null);
__d('getDraftEditorSelection',['getDraftEditorSelectionWithNodes'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=b.getSelection();if(k.rangeCount===0)return {selectionState:i.getSelection().set('hasFocus',false),needsRecovery:false};return c('getDraftEditorSelectionWithNodes')(i,j,k.anchorNode,k.anchorOffset,k.focusNode,k.focusOffset);}f.exports=h;},null);
__d('editOnSelect',['EditorState','ReactDOM','getDraftEditorSelection'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){if(this._blockSelectEvents)return;var i=this.props.editorState,j=c('getDraftEditorSelection')(i,c('ReactDOM').findDOMNode(this.refs.editorContainer).firstChild),k=j.selectionState;if(k!==i.getSelection()){if(j.needsRecovery){i=c('EditorState').forceSelection(i,k);}else i=c('EditorState').acceptSelection(i,k);this.update(i);}}f.exports=h;},null);
__d('DraftEditorEditHandler',['editOnBeforeInput','editOnBlur','editOnCompositionStart','editOnCopy','editOnCut','editOnDragOver','editOnDragStart','editOnFocus','editOnInput','editOnKeyDown','editOnPaste','editOnSelect'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={onBeforeInput:c('editOnBeforeInput'),onBlur:c('editOnBlur'),onCompositionStart:c('editOnCompositionStart'),onCopy:c('editOnCopy'),onCut:c('editOnCut'),onDragOver:c('editOnDragOver'),onDragStart:c('editOnDragStart'),onFocus:c('editOnFocus'),onInput:c('editOnInput'),onKeyDown:c('editOnKeyDown'),onPaste:c('editOnPaste'),onSelect:c('editOnSelect')};f.exports=h;},null);
__d('DraftEditorPlaceholder.react',['cx','React'],function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.shouldComponentUpdate=function(l){return (this.props.text!==l.text||this.props.editorState.getSelection().getHasFocus()!==l.editorState.getSelection().getHasFocus());};k.prototype.render=function(){var l=this.props.editorState.getSelection().getHasFocus(),m="_1p1t"+(l?' '+"_1p1u":'');return (c('React').createElement('div',{className:m},c('React').createElement('div',{className:"_1p1v",id:this.props.accessibilityID},this.props.text)));};function k(){i.apply(this,arguments);}f.exports=k;},null);
__d('getDefaultKeyBinding',['KeyBindingUtil','Keys','UserAgent'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('UserAgent').isPlatform('Mac OS X'),i=c('UserAgent').isPlatform('Windows'),j=h&&c('UserAgent').isBrowser('Firefox < 29'),k=c('KeyBindingUtil').hasCommandModifier,l=c('KeyBindingUtil').isCtrlKeyCommand;function m(r){return h&&r.altKey||l(r);}function n(r){if(k(r))return r.shiftKey?'redo':'undo';}function o(r){if(i&&r.shiftKey)return null;return m(r)?'delete-word':'delete';}function p(r){if(k(r)&&h)return 'backspace-to-start-of-line';return m(r)?'backspace-word':'backspace';}function q(r){switch(r.keyCode){case 66:return k(r)?'bold':null;case 68:return l(r)?'delete':null;case 72:return l(r)?'backspace':null;case 73:return k(r)?'italic':null;case 74:return k(r)?'code':null;case 75:return !i&&l(r)?'secondary-cut':null;case 77:return l(r)?'split-block':null;case 79:return l(r)?'split-block':null;case 84:return h&&l(r)?'transpose-characters':null;case 85:return k(r)?'underline':null;case 87:return h&&l(r)?'backspace-word':null;case 89:if(l(r))return i?'redo':'secondary-paste';return null;case 90:return n(r)||null;case c('Keys').RETURN:return 'split-block';case c('Keys').DELETE:return o(r);case c('Keys').BACKSPACE:return p(r);case c('Keys').LEFT:return (j&&k(r)?'move-selection-to-start-of-block':null);case c('Keys').RIGHT:return (j&&k(r)?'move-selection-to-end-of-block':null);default:return null;}}f.exports=q;},null);
__d('DraftEditor.react',['cx','DefaultDraftBlockRenderMap','DefaultDraftInlineStyle','DraftEditorCompositionHandler','DraftEditorContents.react','DraftEditorDragHandler','DraftEditorEditHandler','DraftEditorPlaceholder.react','EditorState','React','ReactDOM','Scroll','Style','UserAgent','emptyFunction','generateRandomKey','getDefaultKeyBinding','nullthrows','getScrollPosition'],function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('UserAgent').isBrowser('IE'),l=!k,m={edit:c('DraftEditorEditHandler'),composite:c('DraftEditorCompositionHandler'),drag:c('DraftEditorDragHandler'),cut:null,render:null};i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.defaultProps={blockRenderMap:c('DefaultDraftBlockRenderMap'),blockRendererFn:c('emptyFunction').thatReturnsNull,blockStyleFn:c('emptyFunction').thatReturns(''),keyBindingFn:c('getDefaultKeyBinding'),readOnly:false,spellCheck:false,stripPastedStyles:false};function n(o){j.constructor.call(this,o);this.$DraftEditor1=false;this.$DraftEditor2=null;this.$DraftEditor3=false;this.$DraftEditor4=null;this.$DraftEditor5=0;this.$DraftEditor6=c('generateRandomKey')();this.$DraftEditor7='placeholder-'+this.$DraftEditor6;this.$DraftEditor8=this.$DraftEditor28('onBeforeInput');this.$DraftEditor9=this.$DraftEditor28('onBlur');this.$DraftEditor10=this.$DraftEditor28('onCharacterData');this.$DraftEditor11=this.$DraftEditor28('onCompositionEnd');this.$DraftEditor12=this.$DraftEditor28('onCompositionStart');this.$DraftEditor13=this.$DraftEditor28('onCopy');this.$DraftEditor14=this.$DraftEditor28('onCut');this.$DraftEditor15=this.$DraftEditor28('onDragEnd');this.$DraftEditor16=this.$DraftEditor28('onDragOver');this.$DraftEditor17=this.$DraftEditor28('onDragStart');this.$DraftEditor18=this.$DraftEditor28('onDrop');this.$DraftEditor19=this.$DraftEditor28('onInput');this.$DraftEditor20=this.$DraftEditor28('onFocus');this.$DraftEditor21=this.$DraftEditor28('onKeyDown');this.$DraftEditor22=this.$DraftEditor28('onKeyPress');this.$DraftEditor23=this.$DraftEditor28('onKeyUp');this.$DraftEditor24=this.$DraftEditor28('onMouseDown');this.$DraftEditor25=this.$DraftEditor28('onMouseUp');this.$DraftEditor26=this.$DraftEditor28('onPaste');this.$DraftEditor27=this.$DraftEditor28('onSelect');this.focus=this.$DraftEditor29.bind(this);this.blur=this.$DraftEditor30.bind(this);this.setMode=this.$DraftEditor31.bind(this);this.exitCurrentMode=this.$DraftEditor32.bind(this);this.restoreEditorDOM=this.$DraftEditor33.bind(this);this.setRenderGuard=this.$DraftEditor34.bind(this);this.removeRenderGuard=this.$DraftEditor35.bind(this);this.setClipboard=this.$DraftEditor36.bind(this);this.getClipboard=this.$DraftEditor37.bind(this);this.getEditorKey=function(){return this.$DraftEditor6;}.bind(this);this.update=this.$DraftEditor38.bind(this);this.onDragEnter=this.$DraftEditor39.bind(this);this.onDragLeave=this.$DraftEditor40.bind(this);this.state={containerKey:0};}n.prototype.$DraftEditor28=function(o){return function(p){if(!this.props.readOnly){var q=this.$DraftEditor4&&this.$DraftEditor4[o];q&&q.call(this,p);}}.bind(this);};n.prototype.$DraftEditor41=function(){return (!!this.props.placeholder&&!this.props.editorState.isInCompositionMode()&&!this.props.editorState.getCurrentContent().hasText());};n.prototype.$DraftEditor42=function(){if(this.$DraftEditor41())return (c('React').createElement(c('DraftEditorPlaceholder.react'),{text:c('nullthrows')(this.props.placeholder),editorState:this.props.editorState,textAlignment:this.props.textAlignment,accessibilityID:this.$DraftEditor7}));return null;};n.prototype.render=function(){var o=this.props,p=o.readOnly,q=o.textAlignment,r="_5rp7"+(q==='left'?' '+"_5rp8":'')+(q==='right'?' '+"_5rp9":'')+(q==='center'?' '+"_5rpa":''),s=this.props.editorState.getCurrentContent().hasText(),t={outline:'none',whiteSpace:'pre-wrap',wordWrap:'break-word'};return (c('React').createElement('div',{className:r},this.$DraftEditor42(),c('React').createElement('div',{className:"_5rpb",key:'editor'+this.state.containerKey,ref:'editorContainer'},c('React').createElement('div',{'aria-activedescendant':p?null:this.props.ariaActiveDescendantID,'aria-autocomplete':p?null:this.props.ariaAutoComplete,'aria-describedby':this.$DraftEditor41()?this.$DraftEditor7:null,'aria-expanded':p?null:this.props.ariaExpanded,'aria-haspopup':p?null:this.props.ariaHasPopup,'aria-label':this.props.ariaLabel,'aria-owns':p?null:this.props.ariaOwneeID,className:"_5rpu",contentEditable:!p,'data-testid':this.props.webDriverTestID,onBeforeInput:this.$DraftEditor8,onBlur:this.$DraftEditor9,onCompositionEnd:this.$DraftEditor11,onCompositionStart:this.$DraftEditor12,onCopy:this.$DraftEditor13,onCut:this.$DraftEditor14,onDragEnd:this.$DraftEditor15,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.$DraftEditor16,onDragStart:this.$DraftEditor17,onDrop:this.$DraftEditor18,onFocus:this.$DraftEditor20,onInput:this.$DraftEditor19,onKeyDown:this.$DraftEditor21,onKeyPress:this.$DraftEditor22,onKeyUp:this.$DraftEditor23,onMouseUp:this.$DraftEditor25,onPaste:this.$DraftEditor26,onSelect:this.$DraftEditor27,ref:'editor',role:p?null:this.props.role||'textbox',spellCheck:l&&this.props.spellCheck,style:t,suppressContentEditableWarning:true,tabIndex:this.props.tabIndex},c('React').createElement(c('DraftEditorContents.react'),{blockRenderMap:this.props.blockRenderMap,blockRendererFn:this.props.blockRendererFn,blockStyleFn:this.props.blockStyleFn,customStyleMap:babelHelpers['extends']({},c('DefaultDraftInlineStyle'),this.props.customStyleMap),editorKey:this.$DraftEditor6,editorState:this.props.editorState})))));};n.prototype.componentDidMount=function(){this.setMode('edit');if(k)document.execCommand('AutoUrlDetect',false,false);};n.prototype.componentWillUpdate=function(){this.$DraftEditor1=true;};n.prototype.componentDidUpdate=function(){this.$DraftEditor1=false;};n.prototype.$DraftEditor29=function(o){var p=this.props.editorState,q=p.getSelection().getHasFocus(),r=c('ReactDOM').findDOMNode(this.refs.editor),s=c('Style').getScrollParent(r),t=o||c('getScrollPosition')(s),u=t.x,v=t.y;r.focus();if(s===window){window.scrollTo(u,v);}else c('Scroll').setTop(s,v);if(!q)this.update(c('EditorState').forceSelection(p,p.getSelection()));};n.prototype.$DraftEditor30=function(){c('ReactDOM').findDOMNode(this.refs.editor).blur();};n.prototype.$DraftEditor31=function(o){this.$DraftEditor4=m[o];};n.prototype.$DraftEditor32=function(){this.setMode('edit');};n.prototype.$DraftEditor33=function(o){this.setState({containerKey:this.state.containerKey+1},function(){this.$DraftEditor29(o);}.bind(this));};n.prototype.$DraftEditor34=function(){this.$DraftEditor3=true;};n.prototype.$DraftEditor35=function(){this.$DraftEditor3=false;};n.prototype.$DraftEditor36=function(o){this.$DraftEditor2=o;};n.prototype.$DraftEditor37=function(){return this.$DraftEditor2;};n.prototype.$DraftEditor38=function(o){this.props.onChange(o);};n.prototype.$DraftEditor39=function(){this.$DraftEditor5++;};n.prototype.$DraftEditor40=function(){this.$DraftEditor5--;if(this.$DraftEditor5===0)this.exitCurrentMode();};f.exports=n;},null);
__d('isSoftNewlineEvent',['Keys'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){return i.which===c('Keys').RETURN&&(i.getModifierState('Shift')||i.getModifierState('Alt')||i.getModifierState('Control'));}f.exports=h;},null);
__d('EmoticonSpan.react',['cx','DraftEntity','React','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').createClass({displayName:'EmoticonSpan',render:function(){var j=c('DraftEntity').get(this.props.entityKey),k=j.getData(),l=k.type,m=c('joinClasses')("_1ty6",'emoticon_'+l);return (c('React').createElement('span',{className:m,title:l,'data-offset-key':this.props.offsetKey},c('React').createElement('span',{className:"_5ukz"},this.props.children)));}});f.exports=i;},null);
__d('applyEmoticonToContentBlock',['CharacterMetadata','DraftEntity','EmoticonsList','immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i='\u3000';function j(k,l,m){if(!c('EmoticonsList').emotes[l])return k;var n=c('DraftEntity').create('EMOTICON','IMMUTABLE',{type:c('EmoticonsList').emotes[l],originalEmoticon:l}),o=k.getText(),p=k.getCharacterList(),q=l.length,r=p.get(m);return k.merge({text:o.slice(0,m)+i+o.slice(m+q),characterList:p.slice(0,m).concat(h.of(c('CharacterMetadata').applyEntity(r,n)),p.slice(m+q))});}f.exports=j;},null);
__d('getTextAfterNearestEntity',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=j;while(k>0&&i.getEntityAt(k-1)===null)k--;return i.getText().slice(k,j);}f.exports=h;},null);
__d('applyEmoticonToContentState',['EmoticonsList','applyEmoticonToContentBlock','getTextAfterNearestEntity'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=new RegExp(c('EmoticonsList').regexp.source,'g');function i(j,k){var l=k.getAnchorKey(),m=k.getAnchorOffset(),n=j.getBlockForKey(l),o=c('getTextAfterNearestEntity')(n,m),p,q;while(q!==null){q=h.exec(o);if(q!==null)p=q;}if(!p)return j;var r=p[1];if(!r&&m!==o.length)return j;var s=p[2],t=m-o.length,u=t+p.index+p[1].length,v=j.getBlockMap().set(l,c('applyEmoticonToContentBlock')(n,s,u));m-=s.length-1;return j.merge({blockMap:v,selectionBefore:k,selectionAfter:k.merge({anchorOffset:m,focusOffset:m})});}f.exports=i;},null);
__d('handleBeforeInputForEmoticon',['DraftModifier','EditorState','applyEmoticonToContentState'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=new RegExp(/[\s'".,!?]/);function i(j,k){var l=j.getSelection();if(!l.isCollapsed()||!k||!h.test(k))return j;var m=j.getCurrentContent(),n=c('applyEmoticonToContentState')(m,l);if(n===m)return j;var o=c('DraftModifier').insertText(n,n.getSelectionAfter(),k);return c('EditorState').push(j,o,'insert-characters');}f.exports=i;},null);
__d('handleSoftNewlineForEmoticon',['DraftModifier','EditorState','applyEmoticonToContentState'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getCurrentContent(),k=i.getSelection(),l=c('applyEmoticonToContentState')(j,k);if(l===j)return i;var m=c('DraftModifier').splitBlock(l,l.getSelectionAfter());return c('EditorState').push(i,m,'split-block');}f.exports=h;},null);
__d('getVisibleValueForContentState',['DraftEntity','emptyFunction'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getBlockMap().map(function(k){var l=k.getText(),m='';k.findEntityRanges(c('emptyFunction').thatReturnsTrue,function(n,o){var p=k.getEntityAt(n);if(p===null){m+=l.slice(n,o);}else{var q=c('DraftEntity').get(p);if(q.getType()==='EMOTICON'){m+=q.getData().originalEmoticon;}else m+=l.slice(n,o);}});return m;});return j.join('\n');}f.exports=h;},null);
__d('getEntityMatcher',['DraftEntity'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('DraftEntity').get;function i(j,k){var l=k||h;return function(m,n){m.findEntityRanges(function(o){var p=o.getEntity();return typeof p==='string'&&j(l(p));},n);};}f.exports=i;},null);
__d('insertEmoticonIntoContentState',['DraftModifier','applyEmoticonToContentBlock'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=c('DraftModifier').replaceText(j,k,i),m=k.getAnchorKey(),n=k.getAnchorOffset(),o=l.getBlockForKey(m),p=l.getBlockMap().set(m,c('applyEmoticonToContentBlock')(o,i,n));n++;return j.merge({blockMap:p,selectionBefore:k,selectionAfter:k.merge({anchorOffset:n,focusOffset:n})});}f.exports=h;},null);
__d('insertEmoticonIntoEditorState',['DraftModifier','EditorState','insertEmoticonIntoContentState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=' ';function i(j,k){var l=k.getSelection(),m=k.getCurrentContent(),n=l.getStartOffset(),o=l.getEndOffset(),p=m.getBlockForKey(l.getStartKey()).getText(),q=m.getBlockForKey(l.getEndKey()).getText(),r='';if(o<=q.length&&q[o]!==h)r=h;if(n>0&&p[n-1]!==h){m=c('DraftModifier').insertText(m,l,h);l=m.getSelectionAfter();}var s=c('insertEmoticonIntoContentState')(j,m,l);m=c('DraftModifier').insertText(s,s.getSelectionAfter(),r);return c('EditorState').push(k,m,'insert-characters');}f.exports=i;},null);
__d('CompositeDraftDecorator',['immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i='.';function j(m){this.$CompositeDraftDecorator1=m.slice();}j.prototype.getDecorations=function(m){var n=Array(m.getText().length).fill(null);this.$CompositeDraftDecorator1.forEach(function(o,p){var q=0,r=o.strategy;r(m,function(s,t){if(k(n,s,t)){l(n,s,t,p+i+q);q++;}});});return h(n);};j.prototype.getComponentForKey=function(m){var n=parseInt(m.split(i)[0],10);return this.$CompositeDraftDecorator1[n].component;};j.prototype.getPropsForKey=function(m){var n=parseInt(m.split(i)[0],10);return this.$CompositeDraftDecorator1[n].props;};function k(m,n,o){for(var p=n;p<o;p++)if(m[p]!=null)return false;return true;}function l(m,n,o,p){for(var q=n;q<o;q++)m[q]=p;}f.exports=j;},null);
__d('EmojiDispatcher',['ExplicitRegistrationDispatcher'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new (c('ExplicitRegistrationDispatcher'))({strict:false});},null);
__d('EmojiActions',['EmojiDispatcher','keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({CHANGE_CURRENT_CATEGORY:null,CHANGE_EMOJI_COLOR:null,EMOJI_COLOR_READY:null,GET_EMOJI_COLOR:null,TRAY_DATA_READY:null,UPDATE_TRAY_DATA:null}),i={Types:h,loadedTrayData:function(){c('EmojiDispatcher').dispatch({type:i.Types.TRAY_DATA_READY});},updateTrayData:function(){c('EmojiDispatcher').dispatch({type:i.Types.UPDATE_TRAY_DATA});},changeEmojiColor:function(j){c('EmojiDispatcher').dispatch({type:i.Types.CHANGE_EMOJI_COLOR,color:j});},changeCurrentCategory:function(j){c('EmojiDispatcher').dispatch({type:i.Types.CHANGE_CURRENT_CATEGORY,currentCategory:j});},getEmojiColor:function(){c('EmojiDispatcher').dispatch({type:i.Types.GET_EMOJI_COLOR});},emojiColorReady:function(j){c('EmojiDispatcher').dispatch({type:i.Types.EMOJI_COLOR_READY,color:j});}};f.exports=i;},null);
__d("XMessagingGetEmojiRecentUsageController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messaging\/emoji_recent_usage\/",{});},null);
__d('EmojiServerRequests',['Promise','AsyncRequest','XMessagingGetEmojiRecentUsageController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={fetchTrayData:function(j){return i(c('XMessagingGetEmojiRecentUsageController').getURIBuilder().getURI(),j,true);}};function i(j,k,l){return new (c('Promise'))(function(m,n){return (new (c('AsyncRequest'))(j).setHandler(function(o){return m(o.getPayload());}).setAllowCrossPageTransition(l).send());}).then(k);}f.exports=h;},null);
__d("XMessagingGetEmojiColorPrefController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messaging\/get_emoji_color\/",{});},null);
__d("XMessagingSetEmojiColorPrefController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messaging\/set_emoji_color\/",{});},null);
__d('EmojiState',['fbt','AsyncRequest','EmojiActions','EmojiServerRequests','MessengerSupportedEmoji','XMessagingGetEmojiColorPrefController','XMessagingSetEmojiColorPrefController'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=null,j=null,k=void 0,l={onTrayDataReady:function(m){if(!k)k=c('EmojiServerRequests').fetchTrayData(function(n){j=n;});k.then(function(){m();c('EmojiActions').loadedTrayData();});k.done();},getEmojiColor:function(){var m=c('XMessagingGetEmojiColorPrefController').getURIBuilder().getURI();new (c('AsyncRequest'))(m).setMethod('POST').setHandler(function(n){c('EmojiActions').emojiColorReady(n.payload);}).send();},changeEmojiColor:function(m){var n=c('XMessagingSetEmojiColorPrefController').getURIBuilder().getURI();new (c('AsyncRequest'))(n).setMethod('POST').setData({color:m}).send();},addMRUCategory:function(){if(j){var m=j.map(function(n){var o=c('MessengerSupportedEmoji').findEmoji(n);if(!o)return null;return o.emoji.split('_').map(function(p){return parseInt(p,16);});}).filter(function(n){return !!n;});i={name:h._("Recently Sent"),emojis:m,icon:[128340]};c('EmojiActions').updateTrayData();j=null;}},_addRecentlyUsedEmoji:function(m){var n=i&&i.emojis;if(!n)return;var o=function(q){var r=m[q];for(var s=0;s<n.length;++s)if(n[s].length==r.length&&n[s].every(function(t,u){return t===r[u];})){n.splice(s,1);break;}n.unshift(r);};for(var p=0;p<m.length;++p)o(p);c('EmojiActions').updateTrayData();},getMRUCategory:function(){if(!i)this.addMRUCategory();return i;},updateRecentlyUsed:function(m){if(!i){this.addMRUCategory();return;}this._addRecentlyUsedEmoji(m);}};f.exports=l;},null);
__d('ChatAnimatedGifs',['URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={shouldHideBody:function(i){if(!i.has_attachment)return false;for(var j=0;j<i.attachments.length;j++){var k=i.attachments[j];if(k.preview_url){var l=h.getRawUrlFromSafeUrl(k.preview_url);if(i.body==l)return true;}}return false;},getRawUrlFromSafeUrl:function(i){return new (c('URI'))(i).getQueryData().url;}};f.exports=h;},null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=function(i,j){this._userID=i;this._logger=c('JSLogger').create('blackbird');this._getState=function(){if(c('ChatVisibility').isOnline())return c('PresencePrivacy').allows(this._userID)?h.NORMAL:h.BLOCKED;return h.OFFLINE;};this._togglePrivacy=function(){var l=this._getState();switch(this._getState()){case h.OFFLINE:if(c('ChatVisibility').isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});c('ChatVisibility').goOnline(function(){if(!c('PresencePrivacy').allows(this._userID)){if(this._getState()!==h.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case h.BLOCKED:c('PresencePrivacy').allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case h.NORMAL:c('PresencePrivacy').disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};var k=function(){j&&j(this._getState());}.bind(this);k();this._subscribeToken=c('PresencePrivacy').subscribe('privacy-changed',k);};h.OFFLINE='offline';h.BLOCKED='blocked';h.NORMAL='normal';Object.assign(h.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&c('PresencePrivacy').unsubscribe(this._subscribeToken);}});f.exports=h;},null);
__d('ChatTabBlinking',['cx','CSS','setIntervalAcrossTransitions'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=600,j="highlightTitle",k={_blinkMap:{},_interval:null,_isHighlighting:false,blinkTab:function(l,m){if(!this._blinkMap[l])this._blinkMap[l]={view:m,elem:m.getTabElem()};this.checkInterval();},unblinkTab:function(l){if(this._blinkMap[l]){var m=this._blinkMap[l].elem;if(m)c('CSS').removeClass(m,j);delete this._blinkMap[l];}this.checkInterval();},checkInterval:function(){var l=Object.keys(this._blinkMap).length;if(l>0){if(!this._interval)this._interval=c('setIntervalAcrossTransitions')(this._toggleBlinkHighlight.bind(this),i);}else if(this._interval){clearInterval(this._interval);this._interval=null;}},_toggleBlinkHighlight:function(){this._isHighlighting=!this._isHighlighting;for(var l in this._blinkMap)if(this._blinkMap.hasOwnProperty(l)){var m=this._blinkMap[l],n=m.elem,o=m.view;if(n&&n.parentNode&&!o.isFocused()){c('CSS').conditionClass(n,j,this._isHighlighting);}else this.unblinkTab(l);}}};f.exports=k;},null);
__d('ChatDateBreak.react',['cx','React','formatDate','joinClasses'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'ChatDateBreak',propTypes:{date:i.instanceOf(Date).isRequired},shouldComponentUpdate:function(k){return this.props.date.getTime()!==k.date.getTime();},render:function(){var k=c('formatDate')(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (c('React').createElement('time',{className:c('joinClasses')(this.props.className,"_5w-5")},c('React').createElement('span',{className:"_5w-6"},k)));}});f.exports=j;},null);
__d('ChatAttachmentProgressBar.react',['cx','Animation','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=34,k=c('React').createClass({displayName:'ChatAttachmentProgressBar',propTypes:{ephemeralTTLMode:i.number.isRequired,timestamp:i.number.isRequired,isMessageAuthor:i.bool},componentDidMount:function(){if(!this.refs.progressBar)return;var l=j,m=this.props.ephemeralTTLMode,n=l/m*(Date.now()-this.props.timestamp),o=this._getRemainingTime();if(o>0&&n<l){var p=this.props.isMessageAuthor?'left':'right';new (c('Animation'))(this.refs.progressBar).from(p,n).to(p,l).duration(o).go();}},_getRemainingTime:function(){return this.props.ephemeralTTLMode-(Date.now()-this.props.timestamp);},render:function(){return (c('React').createElement('a',{className:"_4yo"},c('React').createElement('span',{className:"_1gxq"}),c('React').createElement('span',{className:"_1gxr",ref:'progressBar'},c('React').createElement('span',{className:"_4yu"}))));}});f.exports=k;},null);
__d('ChatProgressBar.react',['cx','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=2000,k=250,l=c('React').createClass({displayName:'ChatProgressBar',_timer:null,propTypes:{isMessageAuthor:i.bool,onDone:i.func,setExpiredAnimation:i.func,timestamp:i.number.isRequired,ttl:i.number.isRequired},getInitialState:function(){return {percentage:this._getRemainingPercentage()};},componentDidMount:function(){if(this._getRemainingTime()>0){this._animateProgressBar();}else this.props.setExpiredAnimation&&this.props.setExpiredAnimation();},componentWillUnmount:function(){this._timer&&clearTimeout(this._timer);},render:function(){return (c('React').createElement('div',{className:"_3pcc"+(this._getRemainingTime()<0?' '+"_3pcd":''),ref:'item',style:{width:this.state.percentage.toString()+'%'}}));},_getRemainingTime:function(){return this.props.ttl-(Date.now()-this.props.timestamp)-j;},_getRemainingPercentage:function(){return 100-(Date.now()-this.props.timestamp)/(this.props.ttl-j)*100;},_animateProgressBar:function(){this._timer=setInterval(function(){if(this.isMounted())this.setState({percentage:this._getRemainingPercentage()});if(this._getRemainingTime()<0){clearTimeout(this._timer);this.props.onDone&&this.props.onDone();}}.bind(this),k);}});f.exports=l;},null);
__d('EmojiFormat',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j){return j.split('_').map(function(k){return parseInt(k,16);});}function i(j){return j.map(function(k){return k.toString(16);}).join('_');}f.exports={codeArrayToCodeString:i,codeStringToCodeArray:h};},null);
__d('EmojiOnlyMessage.react',['cx','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'EmojiOnlyMessage',propTypes:{sourceURIs:i.arrayOf(i.shape({emoji:i.any,type:i.string.isRequired,title:i.string,url:i.string.isRequired})).isRequired},render:function(){var k=this.props.sourceURIs,l=0,m=k.map(function(n){l++;if(n.emoji)return c('React').createElement('span',{key:l,title:n.title},n.emoji);return c('React').createElement('span',{className:"_5qi2",key:l,style:{backgroundImage:'url('+n.url+')'},title:n.title});});return (c('React').createElement('div',{className:this.props.className,tabIndex:'0'},m));}});f.exports=j;},null);
__d('MessageBubbleMixin',['DOMDimensions','ReactDOM'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=2,i={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(j){if(j.maxWidth!==this.props.maxWidth||j.body!==this.props.body||!j.attachments&&this.props.attachments)this._restyleBubble(j);},_restyleBubble:function(j){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var k=c('ReactDOM').findDOMNode(this.refs.bubble);if(j.maxWidth!==this.props.maxWidth||c('DOMDimensions').getElementDimensions(k).width>this.props.maxWidth){var l=this.props.maxWidth;this.setState({bubbleWidth:l},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var j=c('ReactDOM').findDOMNode(this.refs.bubble),k=c('DOMDimensions').getElementDimensions(j).width,l=c('ReactDOM').findDOMNode(this.refs.content),m=l?c('DOMDimensions').getElementDimensions(l).width+c('DOMDimensions').measureElementBox(c('ReactDOM').findDOMNode(this.refs.contentWrapper),'width',true,false,false):0,n=m+h;if(m>0&&n<this.props.maxWidth&&k-n-this.getBoxWidth()>0)this.setState({bubbleWidth:n});}};f.exports=i;},null);
__d('messengerCustomColorUtils',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){j=j||{};j.backgroundColor=i;return j;}f.exports={customBubbleStyle:h};},null);
__d('ChatBubble.react',['cx','Animation','ChatProgressBar.react','DOMDimensions','EmojiLikeUtils','EmojiOnlyMessage.react','MercuryAttachment','MercuryMessageBody.react','MessageBubbleMixin','MessagingGiftWrap.react','React','ReactDOM','joinClasses','messengerCustomColorUtils'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=1000,k=c('React').createClass({displayName:'ChatBubble',_boxWidth:0,mixins:[c('MessageBubbleMixin')],propTypes:{attachments:i.node,body:i.string,customColor:i.string,customLike:i.object,isEmojiLike:i.bool,isGiftWrapped:i.bool,isMessageAuthor:i.bool,maxWidth:i.number.isRequired,metaRanges:i.array,onUnwrap:i.func,ranges:i.array,threadID:i.string,timestamp:i.number,ttl:i.number},getInitialState:function(){return {emojis:undefined,ephemeralExpiring:false,ephemeralExpired:false};},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var l=this.props.body||'',m=c('EmojiLikeUtils').richContent(l);if(m)this.setState({emojis:m});}},render:function(){var l=this.props.body||'';return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')("_5w1r"+(this._isEpehmeralStylePreferred()?' '+"_4gx-":'')+(this.state.ephemeralExpiring?' '+"_1xti":'')+(this.state.ephemeralExpired?' '+"_1xtj":'')+(!this.state.emojis?' '+"_3_om":'')+(!!this.state.emojis?' '+"_31xx":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:l.length>=15?'break-word':'inherit'}}),this._renderProgressBar(),c('React').createElement('div',{className:"_4gx_",ref:'inner'},this._renderContent(),this.props.attachments),this.props.isGiftWrapped?c('React').createElement(c('MessagingGiftWrap.react'),{onUnwrap:this.props.onUnwrap}):null));},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;var l={};if(this.state.emojis){var m=c('EmojiLikeUtils').getSourceURIs(this.state.emojis),n=c('React').createElement(c('EmojiOnlyMessage.react'),{sourceURIs:m});}else{n=c('React').createElement(c('MercuryMessageBody.react'),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike});if(this.props.customColor)l=c('messengerCustomColorUtils').customBubbleStyle(this.props.customColor,l);}return (c('React').createElement('div',{className:"_d97"+(!!this.state.emojis?' '+"_31xy":''),ref:'contentWrapper',style:l},c('React').createElement('span',{className:"_5yl5",ref:'content'},n)));},_isEpehmeralStylePreferred:function(){if(!this.props.ttl)return false;if(!this.props.attachments)return true;return this.props.attachments.props.attachments.every(function(l){return c('MercuryAttachment').isEphemeralTextStyle(l);});},_onProgressBarAnimationDone:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});new (c('Animation'))(this.refs.inner).to('opacity',0).duration(j).go();}},_setExpiredAnimation:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});this.setState({ephemeralExpired:true});}},_renderProgressBar:function(){if(!this.props.timestamp||!this.props.ttl||!this._isEpehmeralStylePreferred()||this.state.emojis&&this.state.emojis.length>0)return null;return (c('React').createElement(c('ChatProgressBar.react'),{ttl:this.props.ttl,timestamp:this.props.timestamp,isMessageAuthor:this.props.isMessageAuthor,onDone:this._onProgressBarAnimationDone,setExpiredAnimation:this._setExpiredAnimation}));},contentWraps:function(){var l=c('ReactDOM').findDOMNode(this.refs.content);if(!l)return false;var m=l.getClientRects(),n=c('DOMDimensions').getElementDimensions(l).height;return m&&m.length>1&&m[0].height<n;},getBoxWidth:function(){if(!this._boxWidth)this._boxWidth=c('DOMDimensions').measureElementBox(c('ReactDOM').findDOMNode(this.refs.bubble),'width',true,true,false);return this._boxWidth;}});f.exports=k;},null);
__d('convertMIGColorToFIGColor',['cssVar'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={'#0077e5':"#4080ff",'#44bec7':"#54C7EC",'#ffc300':'#f5c33b','#fa3c4c':"#F35369",'#d696bb':'#d696bb','#6699cc':"#A3CEDF",'#13cf13':"#42b72a",'#ff7e29':"#F7923B",'#e68585':'#e68585','#7646ff':"#8C72CB",'#20cef5':"#54C7EC",'#67b868':"#A3CE71",'#d4a88c':'#cfa588','#ff5ca1':"#EC7EBD",'#a695c7':"#AF9CDA"};function j(k){return k&&i[k]||k;}f.exports=j;},null);
__d('ChatMessage.react',['cssVar','cx','fbt','BootloadedComponent.react','ChatAnimatedGifs','ChatAttachmentProgressBar.react','ChatBubble.react','EmojiLikeUtils','MercuryTimestamp','CSS','immutable','ImmutableObject','JSResource','MercuryAttachment','MercuryConfig','MercuryErrorInfo','MercuryIDs','MercuryMessageActions','MercuryMessageCustomizations','MercuryMessageError.react','MercuryMessageInfo','MessageBorderType','MessageCustomizationType','MessagingFlowerBorder.react','MessagingGiftWrapChecker','MNCommerceMessageType','MercuryDisplayTimeFilterMessageRenderer','React','ReactDOM','XUISpinner.react','convertMIGColorToFIGColor','isRTL','joinClasses'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'ChatMessage',propTypes:{message:k.instanceOf(c('ImmutableObject')).isRequired,maxBubbleWidth:k.number.isRequired,onAttachmentLoad:k.func,onStickerClick:k.func,thread:k.instanceOf(c('ImmutableObject'))},componentDidMount:function(){c('CSS').conditionClass(c('ReactDOM').findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var m=this.props.message;return (c('MercuryMessageInfo').isInbound(m)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(m,n){var o=m.message!==this.props.message,p=this.props.thread.custom_like_icon!==m.thread.custom_like_icon,q=this.props.thread.custom_color!==m.thread.custom_color;return (o||p||q);},render:function(){var m=this.props.message,n=c('MercuryAttachment').get(m).length>0,o=c('MercuryMessageInfo').isInbound(m),p=c('MercuryIDs').isGroupChat(m.thread_id),q=c('isRTL')(m.body),r=c('MercuryErrorInfo').hasErrorStatus(m),s="_5wd4"+(o?' '+"_1nc7":'')+(!o?' '+"_1nc6":'')+(n?' '+"_2_-t":'')+(o&&p?' '+"_5ysy":'')+(r?' '+"_1zcs":'')+(q?' '+"direction_rtl":'')+(!q?' '+"direction_ltr":'');return (c('React').createElement('div',{className:c('joinClasses')(this.props.className,s)},this._renderInner(),this._renderUndertext()));},_renderInner:function(){var m=this.props.message,n={};if(c('MercuryMessageInfo').isOutbound(m)){var o=j._("{time}",[j.param('time',c('MercuryTimestamp').getPreciseTimestamp(m.timestamp))]);n['data-hover']='tooltip';n['data-tooltip-position']='right';n['data-tooltip-content']=o;}if(m.is_filtered_content)return (c('React').createElement('div',babelHelpers['extends']({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:'inner'},n),c('MercuryDisplayTimeFilterMessageRenderer').renderFilteredContent(m)));return (c('React').createElement('div',babelHelpers['extends']({className:"_5wd9",ref:'inner'},n),this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (c('React').createElement('div',{className:"_3ry4",ref:'undertext'},c('React').createElement(c('MercuryMessageError.react'),{className:"_5wda clearfix",message:this.props.message,ref:'status'}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('span',null),bootloadLoader:c('JSResource')('MercurySpoofWarning.react').__setRef('ChatMessage.react'),authorID:this.props.message.author,className:"_5wdb"}):null);},_getAttachmentPlaceholder:function(){return (c('React').createElement('div',{style:{padding:'20px',text_align:'center'}},c('React').createElement(c('XUISpinner.react'),null)));},_renderProgressBar:function(){var m=this.props.message;if(!m.ephemeral_ttl_mode||!m.timestamp)return null;return (c('React').createElement(c('ChatAttachmentProgressBar.react'),{ephemeralTTLMode:m.ephemeral_ttl_mode,timestamp:m.timestamp,isMessageAuthor:!c('MercuryMessageInfo').isInbound(m)}));},_renderAttachments:function(m){if(this.props.message.commerce_message_type===c('MNCommerceMessageType').RIDE_INTENT)return null;var n=this.props.message,o=this.props.thread?this.props.thread.custom_like_icon:null,p=m=='inside'?'attachmentsInside':'attachmentsOutside',q=c('MercuryAttachment').get(n).filter(function(t){var u=c('MercuryAttachment').isBubblePreferred(t);return u&&m==='inside'||!u&&m==='outside';}),r=n.attachments.length>0&&n.attachments.every(function(t){return c('MercuryAttachment').isEphemeralAttachmentStyle(t);}),s=this.props.thread&&c('MercuryConfig').ChatMessengerStyles?c('convertMIGColorToFIGColor')(this.props.thread.custom_color):'';if(q.length>0)return (c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:this._getAttachmentPlaceholder(),bootloadLoader:c('JSResource')('MercuryAttachments.react').__setRef('ChatMessage.react'),className:(m==='outside'?"_3e7u":'')+(!!n.body?' '+"_16ys":'')+(!!n.ephemeral_ttl_mode?' '+"_3-rb":'')+(!!s?' '+"_3al":'')+(' '+"_n4o"),attachments:q,customLike:o,customColor:s,hasFlowerBorder:c('MercuryConfig').WWWMessengerFlowerBorderViewer&&c('MercuryMessageCustomizations').getCustomizationValue(n,c('MessageCustomizationType').BORDER)===c('MessageBorderType').FLOWERS&&m==='outside',isChat:true,isGiftWrapped:c('MessagingGiftWrapChecker').shouldRenderWithGiftWrap(n)&&m==='outside',maxWidth:this.props.maxBubbleWidth,message:n,onUnwrap:this._handleUnwrap,renderProgressBar:r?this._renderProgressBar:null,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:p}));},_renderBubble:function(){var m=this.props.message,n=m.body,o=this._renderAttachments('inside'),p=c('MercuryMessageInfo').isInbound(m),q=c('MercuryConfig').WWWMessengerFlowerBorderViewer&&c('MercuryMessageCustomizations').getCustomizationValue(m,c('MessageCustomizationType').BORDER)===c('MessageBorderType').FLOWERS;if(c('ChatAnimatedGifs').shouldHideBody(m))n='';if(n||o)return (c('React').createElement('div',{className:"_5wde"+(' '+"_n4o")+(q?' '+"_337n":'')},c('React').createElement(c('ChatBubble.react'),{attachments:o,body:n,className:"_5wdf",isMessageAuthor:!p,maxWidth:this.props.maxBubbleWidth,ranges:m.ranges,metaRanges:m.meta_ranges,ref:'bubble',isEmojiLike:c('EmojiLikeUtils').isEmojiLike(m),isGiftWrapped:c('MessagingGiftWrapChecker').shouldRenderWithGiftWrap(m),onUnwrap:this._handleUnwrap,threadID:m.thread_id,ttl:m.ephemeral_ttl_mode,timestamp:m.timestamp,customLike:m.customLike,customColor:c('MercuryConfig').ChatMessengerStyles&&this.props.thread&&this.props.isFromViewer?c('convertMIGColorToFIGColor')(this.props.thread.custom_color):''}),q?c('React').createElement(c('MessagingFlowerBorder.react'),null):null));},_handleUnwrap:function(){var m="2500ms";setTimeout(function(){return this._persistUnwrapping();}.bind(this),m.substring(0,m.length-2));},_persistUnwrapping:function(){c('MercuryMessageActions').get().unwrap(this.props.message);}});f.exports=l;},null);
__d('ChatMessageGroup.react',['cx','fbt','ChatConfig','ChatDateBreak.react','ChatMessage.react','Image.react','immutable','ImmutableObject','MercuryConfig','MercuryIDs','MercuryParticipants','MercuryTimestamp','MessengerTextWithEmoticons.react','React','StoreAndPropBasedStateMixin'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=new (c('ImmutableObject'))({name:'',href:'#',image_src:''}),l=c('ChatConfig').get('chattab_rounded_profile',false),m=c('React').createClass({displayName:'ChatMessageGroup',mixins:[c('StoreAndPropBasedStateMixin')(c('MercuryParticipants'))],propTypes:{activeMessageID:j.string,author:j.string,hasDateBreak:j.bool,isCanonical:j.bool,isFromViewer:j.bool,isPageMessage:j.bool,maxBubbleWidth:j.number,messages:j.instanceOf(c('immutable').List).isRequired,onAttachmentLoad:j.func,onStickerClick:j.func,thread:j.instanceOf(c('ImmutableObject')),threadID:j.string},statics:{calculateState:function(o){return {participants:n(o)};}},shouldComponentUpdate:function(o,p){return (this.props.activeMessageID!==o.activeMessageID||this.props.isFromViewer!==o.isFromViewer||!c('immutable').is(this.props.messages,o.messages)||!c('immutable').is(this.state.participants,p.participants)||!c('immutable').is(this.props.thread,o.thread));},render:function(){return (c('React').createElement('div',{className:"_4tdt"},this._renderProfileColumn(),this._renderName(),c('React').createElement('div',{className:"_4tdv"},this._renderMessages())));},_renderProfileColumn:function(){if(this.props.isFromViewer)return null;var o=this.state.participants.get(this.props.author)||k,p=i._("{name} {time}",[i.param('name',o.name),i.param('time',c('MercuryTimestamp').getPreciseTimestamp(this.props.messages.last().timestamp))]),q=o.image_src?c('React').createElement(c('Image.react'),{src:o.image_src}):null;return (c('React').createElement('div',{className:"_31o4"+(l?' '+"_3njy":'')},c('React').createElement('a',{'aria-label':p,className:"_4tdw",'data-hover':'tooltip','data-tooltip-content':p,'data-tooltip-position':'left',href:o.href,ref:'link'},q)));},_renderName:function(){if(this.props.isCanonical||this.props.isFromViewer)return null;var o=this.state.participants.get(this.props.messages.first().author);if(!o)return null;var p=o.short_name;if(this.props.thread&&this.props.thread.custom_nickname){var q=c('MercuryIDs').getUserIDFromParticipantID(o.id);if(this.props.thread.custom_nickname[q]){p=this.props.thread.custom_nickname[q];if(c('MercuryConfig').MessengerNewEmojiGK)p=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:p});}}return (c('React').createElement('div',{className:"_4tdx"},p));},_renderMessages:function(){var o=this.props.messages.size,p=[];this.props.messages.forEach(function(q,r,s){var t=q.message_id===this.props.activeMessageID;if(t&&!(r===0&&this.props.hasDateBreak))p.push(c('React').createElement(c('ChatDateBreak.react'),{date:new Date(q.timestamp),key:'db:'+q.message_id}));p.push(c('React').createElement(c('ChatMessage.react'),{isFromViewer:this.props.isFromViewer,key:q.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:q,nextTimestamp:this._getNextTimestamp(s,o,r),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread}));}.bind(this));return p;},_getNextTimestamp:function(o,p,q){return q<p-1?o.get(q+1).timestamp:this.props.nextTimestamp;}});function n(o){return c('immutable').Map().withMutations(function(p){o.readReceipts.forEach(function(q,r){p.set(r,c('MercuryParticipants').getOrFetch(r));});p.set(o.author,c('MercuryParticipants').getOrFetch(o.author));});}f.exports=m;},null);
__d('MercuryLogMessage.react',['cx','fbt','DOM','DOMDimensions','Event','ImmutableObject','MercuryLogMessageRenderer','MercuryMeMessageProcessor','MercuryLogMessageType','React','ReactDOM','cancelAnimationFrame','emptyFunction','formatDate','joinClasses','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('React').createClass({displayName:'MercuryLogMessage',propTypes:{loadMoreMessages:j.func,maxWidth:j.number,message:j.instanceOf(c('ImmutableObject')).isRequired,onImageLoad:j.func,thread:j.object},getDefaultProps:function(){return {onImageLoad:c('emptyFunction')};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillUnmount:function(){if(this._raf)c('cancelAnimationFrame')(this._raf);},_renderErrorMessage:function(){return (c('React').createElement('a',{onClick:this._loadMoreMessages},i._("Show previous messages.")));},_loadMoreMessages:function(){var l=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(l){this.setState({messageText:this._renderErrorMessage()});}else{var m=i._("Couldn't find previous messages.");this.setState({messageText:m});}},componentWillReceiveProps:function(l){if(l.message.log_message_type===c('MercuryLogMessageType').SERVER_ERROR){this._loadMoreMessages();return;}if(c('MercuryMeMessageProcessor').shouldTransform(l.message)){c('MercuryMeMessageProcessor').transformSnippet(l.message.body,l.message.author,l.thread,function(m){this.setState({messageText:m});}.bind(this));return;}c('MercuryLogMessageRenderer').renderText(l.message,l.thread,function(m){this.setState({messageText:m});}.bind(this));},shouldComponentUpdate:function(l,m){return (this.state.messageText!=m.messageText||l.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){this._informAttachmentLoaded();if(!this.refs.attachment)return;c('MercuryLogMessageRenderer').renderAttachmentLegacy(this.refs.attachment,this.props.message);c('DOM').scry(this.refs.wrap,'img').forEach(function(l){var m=c('Event').listen(l,'load',function(){this._informAttachmentLoaded();m.remove();}.bind(this));}.bind(this));},render:function(){return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_5ye6"),ref:'wrap',style:babelHelpers['extends']({},this.props.style,this._getStyle()),title:c('formatDate')(new Date(this.props.message.timestamp),'g:ia')}),c('React').createElement('div',{className:"_5ye7"},c('MercuryLogMessageRenderer').renderIcon(this.props.message),this.state.messageText),c('React').createElement('div',{className:"_5ye8",ref:'attachment'})));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;},_informAttachmentLoaded:function(){if(this._raf)c('cancelAnimationFrame')(this._raf);this._raf=c('requestAnimationFrame')(function(){this.props.onImageLoad&&this.props.onImageLoad(c('DOMDimensions').getElementDimensions(this.refs.wrap).height);delete this._raf;}.bind(this));}});f.exports=k;},null);
__d('MessengerDomIDs',['uniqueID'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={COMPOSER_INPUT_DESCRIPTION:c('uniqueID')(),CONVERSATION:c('uniqueID')(),MAIN_LABEL:c('uniqueID')(),MUTE_DIALOG_TITLE:c('uniqueID')(),THREAD_INFO_PANEL:c('uniqueID')(),THREAD_TITLE:c('uniqueID')()};f.exports=h;},null);
__d('MessageList.react',['cx','immutable','ImmutableObject','MercuryActionType','MercuryIDs','MercuryMeMessageProcessor','MercuryMessageGroup','MercuryShareAttachmentRenderLocations','MessengerDomIDs','ReactComponentWithPureRenderMixin','React','ReactDOM','MercuryLogMessageType'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=1000*60*60,k=c('React').createClass({displayName:'MessageList',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{DateBreak:i.func.isRequired,deliveryTimestamp:i.number.isRequired,isCanonical:i.bool,isPageMessage:i.bool,location:i.string.isRequired,LogMessage:i.func.isRequired,loadMoreMessages:i.func,MessageGroup:i.func.isRequired,messages:i.instanceOf(c('immutable').List).isRequired,onAttachmentLoad:i.func,onStickerClick:i.func,readReceipts:i.instanceOf(c('immutable').OrderedMap).isRequired,viewer:i.string.isRequired,thread:i.object,threadID:i.string},getInitialState:function(){return {activeMessageID:null,messageGroups:c('MercuryMessageGroup').calculateMessageGroups(this.props.messages,this.props.location)};},componentWillReceiveProps:function(q){if(q.messages!==this.props.messages)this.setState({messageGroups:c('MercuryMessageGroup').calculateMessageGroups(q.messages,q.location)});},render:function(){var q=this.props,r=q.DateBreak,s=q.location,t=q.MessageGroup,u=[],v=this.state.activeMessageID,w=this.state.messageGroups,x=w.length,y=this.props.readReceipts,z=y.last()||0,aa=c('MercuryIDs').getParticipantIDFromUserID(this.props.viewer);for(var ba=0;ba<x;ba++){var ca=ba>0?w[ba-1]:null,da=ca&&ca.length>0?ca[ca.length-1]:null,ea=w[ba],fa=ea[0],ga=ea[ea.length-1],ha=false;if(!da||fa.timestamp-da.timestamp>j){ha=true;u.push(c('React').createElement(r,{date:new Date(fa.timestamp),key:'db:'+fa.message_id,ref:'db:'+fa.message_id}));}if(fa.action_type==c('MercuryActionType').LOG_MESSAGE){if((s===c('MercuryShareAttachmentRenderLocations').CHAT||s===c('MercuryShareAttachmentRenderLocations').MESSENGER)&&(fa.log_message_type===c('MercuryLogMessageType').VIDEO_CALL||fa.log_message_type===c('MercuryLogMessageType').PHONE_CALL)){var ia=this._createRTCMessageGroup(fa,aa,w,x,ba,y,z,ga);u.push(ia);}else{var ja=this._createLogMessageGroup(fa);u.push(ja);}continue;}if(c('MercuryMeMessageProcessor').shouldTransform(fa)){u.push(this._createLogMessageGroup(fa));continue;}ea=c('immutable').List(ea);var ka=m(w,x,ba),la=!o(y,ea,ka),ma=n(z,ga),na=p(this.props.deliveryTimestamp,ga);u.push(c('React').createElement(t,{activeMessageID:l(v,ea),author:ea.first().author,deliveryTimestamp:na,hasDateBreak:ha,isCanonical:this.props.isCanonical,isFromViewer:aa===fa.author,isPageMessage:this.props.isPageMessage,key:'mg:'+fa.message_id,lastReadTimestamp:ma,maxBubbleWidth:this.props.maxBubbleWidth,messages:ea,nextTimestamp:ka,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,onStickerClick:this.props.onStickerClick,readReceipts:la?y:c('immutable').OrderedMap(),ref:'mg:'+fa.message_id,thread:this.props.thread,threadID:this.props.threadID}));}return (c('React').createElement('div',{id:s===c('MercuryShareAttachmentRenderLocations').MESSENGER?c('MessengerDomIDs').CONVERSATION:null},u));},getMessageElement:function(q,r){if(r){var s=this.refs['db:'+q];if(s)return c('ReactDOM').findDOMNode(s);}var t=this.state.messageGroups.find(function(w){return w.some(function(x){return x.message_id===q;});});if(!t)return null;var u=t[0].message_id,v=this.refs['mg:'+u];if(!v)return null;if(r&&u===q)return c('ReactDOM').findDOMNode(v);return v.getMessageElement(q);},_handleMessageDeselect:function(q){this.setState(function(r){return {activeMessageID:r.activeMessageID===q?null:r.activeMessageID};});},_handleMessageSelect:function(q){this.setState({activeMessageID:q});},_createRTCMessageGroup:function(q,r,s,t,u,v,w,x){var y=this.props.MessageGroup,z={attach_type:'share',share:{style_list:['rtc_call_log','fallback'],log_message_body:q.log_message_body,log_message_data:q.log_message_data,log_message_type:q.log_message_type,timestamp:q.timestamp}},aa=c('ImmutableObject').setProperty(q,'attachments',[z]);aa=c('ImmutableObject').setProperty(aa,'body','');var ba=c('immutable').List([aa]),ca=m(s,t,u),da=!o(v,ba,ca),ea=n(w,x),fa=p(this.props.deliveryTimestamp,x);return (c('React').createElement(y,{author:ba.first().author,deliveryTimestamp:fa,isFromViewer:r===q.author,key:q.message_id,lastReadTimestamp:ea,maxBubbleWidth:this.props.maxBubbleWidth,messages:ba,nextTimestamp:ca,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,onStickerClick:this.props.onStickerClick,readReceipts:da?v:c('immutable').OrderedMap(),thread:this.props.thread,threadID:this.props.threadID}));},_createLogMessageGroup:function(q){var r=this.props.LogMessage;return (c('React').createElement(r,{className:this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT?"_5w0o":null,key:q.message_id,loadMoreMessages:this.props.loadMoreMessages,message:q,onImageLoad:this.props.onAttachmentLoad,viewer:this.props.viewer,thread:this.props.thread}));}});function l(q,r){return r.find(function(s){return s.message_id===q;})?q:null;}function m(q,r,s){return s<r-1?q[s+1][0].timestamp:Infinity;}function n(q,r){return r.timestamp>q?q:Infinity;}function o(q,r,s){return (r.isEmpty()||q.last()<r.first().timestamp||q.first()>=s);}function p(q,r){return r.timestamp>q?q:Infinity;}f.exports=k;},null);
__d('ChatConversation.react',['invariant','ChatDateBreak.react','ChatMessageGroup.react','immutable','MercuryLogMessage.react','MessageList.react','React','MercuryShareAttachmentRenderLocations','cancelAnimationFrame','requestAnimationFrame'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'ChatConversation',_raf:(undefined,Number),_onMountTimeout:(undefined,Number),propTypes:{contextBanner:i.object,isCanonical:i.bool.isRequired,loadMoreMessages:i.func,maxBubbleWidth:i.number.isRequired,messages:i.instanceOf(c('immutable').List).isRequired,onAttachmentLoad:i.func,onMount:i.func,onStickerClick:i.func,viewer:i.string.isRequired,thread:i.object,threadID:i.string},componentDidMount:function(){this._raf=c('requestAnimationFrame')(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount();delete this._onMountTimeout;}.bind(this),0);delete this._raf;}.bind(this));},componentWillUnmount:function(){if(this._raf)c('cancelAnimationFrame')(this._raf);clearTimeout(this._onMountTimeout);},componentWillReceiveProps:function(k){!(k.maxBubbleWidth===this.props.maxBubbleWidth)?h(0):void 0;},render:function(){return (c('React').createElement('div',null,this.props.contextBanner,c('React').createElement(c('MessageList.react'),{DateBreak:c('ChatDateBreak.react'),LogMessage:c('MercuryLogMessage.react'),MessageGroup:c('ChatMessageGroup.react'),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:c('MercuryShareAttachmentRenderLocations').CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,readReceipts:c('immutable').OrderedMap(),viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID})));}});f.exports=j;},null);
__d('MercuryTypingAnimation.react',['cx','React','joinClasses'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MercuryTypingAnimation',propTypes:{color:i.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var k="_4a0v"+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":'');return (c('React').createElement('div',{className:c('joinClasses')(this.props.className,k)},c('React').createElement('div',{className:"_4b0g"},c('React').createElement('div',{className:"_5pd7"}),c('React').createElement('div',{className:"_5pd7"}),c('React').createElement('div',{className:"_5pd7"}))));}});f.exports=j;},null);
__d('ChatTypingIndicator.react',['cx','fbt','ChatConfig','Image.react','MercuryParticipants','MercuryTypingAnimation.react','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('ChatConfig').get('chattab_rounded_profile',false),l=c('React').createClass({displayName:'ChatTypingIndicator',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{userID:j.string,showName:j.bool},render:function(){var n=void 0;if(this.props.userID)n=c('MercuryParticipants').getNow(this.props.userID);if(!n)return null;return (c('React').createElement('div',{className:"_4tdt"},m(n),this._renderBubble()));},getBubble:function(){return this.refs.bubble;},_renderBubble:function(){var n=this.props.showName;return (c('React').createElement('div',{className:"_4tdv"},c('React').createElement('div',{className:"_5wd4"+(' '+"_1nc7")+(' '+"_2cnu")+(n?' '+"_5ysy":'')},c('React').createElement('div',{className:"_5wd9"+(' '+"_n4o")},c('React').createElement('div',{className:"_5w1r"+(' '+"_5wdf")+(' '+"_3_om")},c('React').createElement(c('MercuryTypingAnimation.react'),{className:"_5x7x",ref:'bubble'}))))));}});function m(n){var o=i._("{name}",[i.param('name',n.name)]);return (c('React').createElement('div',{className:"_31o4"+(k?' '+"_3njy":'')},c('React').createElement('a',{'aria-label':o,className:"_4tdw",'data-hover':'tooltip','data-tooltip-content':o,'data-tooltip-position':'left',href:n.href||'#',ref:'link'},c('React').createElement(c('Image.react'),{src:n.image_src,ref:'image'}))));}f.exports=l;},null);
__d('ChatTypingIndicators.react',['fbt','ChatTypingIndicator.react','DOM','MercuryIDs','MercuryThreadInformer','MercuryTypingReceiver','MercuryParticipants','React','ReactDOM','SubscriptionsHandler','TooltipData','createObjectFrom','emptyFunction'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorClass:i.func,indicatorsWillShow:i.func,indicatorsDidShow:i.func,rootClassName:i.string,threadID:i.string.isRequired,viewer:i.string.isRequired},getDefaultProps:function(){return {indicatorClass:c('ChatTypingIndicator.react'),indicatorsWillShow:c('emptyFunction'),indicatorsDidShow:c('emptyFunction')};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){var k=c('MercuryThreadInformer').getForFBID(this.props.viewer),l=c('MercuryTypingReceiver').getForFBID(this.props.viewer);this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(l.addRetroactiveListener('state-changed',this.typingStateChanged),k.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(k){if(k.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(k,l){if(l.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();c('MercuryParticipants').getMulti(this.state.typingUserIDs,function(k){if(this.isMounted())this.state.typingUserIDs.forEach(function(l){var m=k[l],n=this.refs[l]&&this.refs[l].getBubble();if(n&&m)c('TooltipData').set(c('ReactDOM').findDOMNode(n),this.renderTooltip(m.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var k=c('MercuryIDs').isGroupChat(this.props.threadID);return (c('React').createElement('div',{className:this.props.rootClassName},this.state.typingUserIDs.map(function(l){return (this._renderTypingIndicator(l,!!k));}.bind(this))));},_renderTypingIndicator:function(k,l){var m=this.props.indicatorClass;return (c('React').createElement(m,{key:k,ref:k,showName:l,userID:k}));},renderTooltip:function(k){var l=c('DOM').create('span');c('ReactDOM').render(c('React').createElement('span',null,h._("{name} is typing...",[h.param('name',k)])),l);return l;},typingStateChanged:function(k){if(this.props.threadID in k)this.setState({typingUserIDs:k[this.props.threadID].slice().sort()});},messagesReceived:function(k,l){if(this.props.threadID in l){var m=l[this.props.threadID],n=c('createObjectFrom')(m.map(function(o){return o.author;}));this.setState({typingUserIDs:this.state.typingUserIDs.filter(function(o){return !n[o];}).sort()});}}});f.exports=j;},null);
__d('MercuryMessageList',['immutable','LogHistory','Map','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('LogHistory').getInstance('mercury_message_list');function i(k){this.$MercuryMessageList1=c('immutable').List(k||[]);this.$MercuryMessageList2();}i.prototype.append=function(k){var l;this.$MercuryMessageList1=(l=this.$MercuryMessageList1).push.apply(l,k);this.$MercuryMessageList2();j('append',k);};i.prototype.prepend=function(k){var l;this.$MercuryMessageList1=(l=this.$MercuryMessageList1).unshift.apply(l,k);this.$MercuryMessageList2();j('prepend',k);};i.prototype.update=function(k){var l=k.filter(function(m){return this.contains(m);}.bind(this));if(l.length===0)return;this.$MercuryMessageList1=this.$MercuryMessageList1.withMutations(function(m){l.forEach(function(n){var o=this.$MercuryMessageList3.get(n.message_id);if(o!==undefined)m.set(o,n);}.bind(this));}.bind(this));j('update',l);};i.prototype.reorder=function(k){this.$MercuryMessageList1=c('immutable').List(k);this.$MercuryMessageList2();j('reorder',k);};i.prototype.at=function(k){return this.$MercuryMessageList1.get(k);};i.prototype.contains=function(k){return this.$MercuryMessageList3.has(k.message_id);};i.prototype.toArray=function(){return this.$MercuryMessageList1.toArray();};i.prototype.toMap=function(){return new (c('Map'))(c('immutable').Seq(this.$MercuryMessageList1).map(function(k){return [k.message_id,k];}));};i.prototype.$MercuryMessageList2=function(){this.$MercuryMessageList3=new (c('Map'))(c('immutable').Seq(this.$MercuryMessageList1).map(function(k,l){return [k.message_id,l];}));};function j(event,k){c('setTimeoutAcrossTransitions')(function(){h.debug(event,JSON.stringify({messageIDs:k.map(function(l){return l.message_id;})}));},0);}f.exports=i;},null);
__d('MercuryMessageStore',['MercuryAPIArgsSource','LogHistory','MercuryMessages','MercuryViewer','MercuryMessageList','SubscriptionsHandler','MercuryThreadInformer','MercuryThreadlistConstants','MercuryThreads','mixInEventEmitter','setImmediate','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreads').get(),i=c('LogHistory').getInstance('mercury_message_store');function j(l,m,n){this.$MercuryMessageStore1=l;this.$MercuryMessageStore2=new (c('MercuryMessageList'))();this.$MercuryMessageStore3=n?c('MercuryMessages').getForFBID(n):c('MercuryMessages').get();this.$MercuryMessageStore4=1;this.$MercuryMessageStore5=null;this.$MercuryMessageStore6=0;this.$MercuryMessageStore7=m||c('MercuryThreadlistConstants').RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore8=n?c('MercuryThreadInformer').getForFBID(n):c('MercuryThreadInformer').get();this.$MercuryMessageStore9=new (c('SubscriptionsHandler'))();this.$MercuryMessageStore9.addSubscriptions(this.$MercuryMessageStore8.subscribe('messages-received',function(o,p){return this.$MercuryMessageStore10(p);}.bind(this)),this.$MercuryMessageStore8.subscribe('messages-updated',function(o,p){return p[this.$MercuryMessageStore1]&&this.$MercuryMessageStore11(p[this.$MercuryMessageStore1]);}.bind(this)),this.$MercuryMessageStore8.subscribe('messages-reordered',function(o,p){return p[this.$MercuryMessageStore1]&&this.$MercuryMessageStore12();}.bind(this)),this.$MercuryMessageStore8.subscribe('thread-invalidated',function(o,p){return p[this.$MercuryMessageStore1]&&this.$MercuryMessageStore13();}.bind(this)));i.debug('constructed',JSON.stringify({threadID:this.$MercuryMessageStore1}));this.$MercuryMessageStore14();}j.prototype.setNewThreadID=function(l){this.$MercuryMessageStore15=l;};j.prototype.destroy=function(){this.$MercuryMessageStore9&&this.$MercuryMessageStore9.release();i.debug('destroyed',JSON.stringify({threadID:this.$MercuryMessageStore1}));};j.prototype.subscribe=function(l){return this.addRetroactiveListener('updated',l);};j.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStore14();return true;};j.prototype.hasFetchedAll=function(){if(this.$MercuryMessageStore3.hasLoadedExactlyNMessages(this.$MercuryMessageStore1,this.$MercuryMessageStore6)&&this.$MercuryMessageStore3.hasLoadedAllMessages(this.$MercuryMessageStore1))return true;return h.isNewEmptyLocalThread(this.$MercuryMessageStore1);};j.prototype.$MercuryMessageStore14=function(){var l=this.$MercuryMessageStore6+this.$MercuryMessageStore7*this.$MercuryMessageStore4;i.debug('fetching',JSON.stringify({threadID:this.$MercuryMessageStore1,limit:l}));this.$MercuryMessageStore3.getThreadMessagesRange(this.$MercuryMessageStore1,0,l,this.$MercuryMessageStore16.bind(this),null,c('MercuryAPIArgsSource').MERCURY);if(this.$MercuryMessageStore4<10)this.$MercuryMessageStore4+=1;if(this.$MercuryMessageStore3.hasLoadedNMessages(this.$MercuryMessageStore1,l))c('setImmediate')(function(){this.$MercuryMessageStore12();}.bind(this));};j.prototype.$MercuryMessageStore16=function(l){if(l&&l.length){this.$MercuryMessageStore5=l[0].timestamp;this.$MercuryMessageStore6=l.length;i.debug('fetched',JSON.stringify({threadID:this.$MercuryMessageStore1,earliestMessageTimestamp:this.$MercuryMessageStore5,count:this.$MercuryMessageStore6}));}else if(l&&!l.length&&!this.$MercuryMessageStore6)this.$MercuryMessageStore17(j.THREAD_IS_EMPTY);};j.prototype.$MercuryMessageStore10=function(l){var m=[],n=l[this.$MercuryMessageStore1];if(n&&n.length)m=m.concat(n);if(this.$MercuryMessageStore15){var o=l[this.$MercuryMessageStore15];if(o&&o.length){m=m.concat(o);this.$MercuryMessageStore15=null;}}if(m.length){this.$MercuryMessageStore2.append(m);this.$MercuryMessageStore6+=m.length;var p=m.every(function(q){return q.author!=c('MercuryViewer').getID();});this.$MercuryMessageStore17(j.MESSAGES_RECEIVED,{allFromOthers:p});}};j.prototype.$MercuryMessageStore11=function(l){this.$MercuryMessageStore2.update(this.$MercuryMessageStore3.getMessagesFromIDs(Object.keys(l)));this.$MercuryMessageStore18();this.$MercuryMessageStore17(j.MESSAGES_CHANGED);};j.prototype.$MercuryMessageStore12=function(){if(!this.$MercuryMessageStore5)return;this.$MercuryMessageStore2.reorder(this.$MercuryMessageStore3.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore1,this.$MercuryMessageStore5));this.$MercuryMessageStore18();this.$MercuryMessageStore17(j.MESSAGES_REORDERED);};j.prototype.$MercuryMessageStore13=function(){this.$MercuryMessageStore2=new (c('MercuryMessageList'))();this.$MercuryMessageStore4=1;this.$MercuryMessageStore5=null;this.$MercuryMessageStore6=0;this.$MercuryMessageStore14();};j.prototype.$MercuryMessageStore17=function(l,m){var n=this.$MercuryMessageStore2.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',babelHelpers['extends']({messages:n,eventType:l},m));k(this.$MercuryMessageStore1,l,n);};j.prototype.$MercuryMessageStore18=function(){var l=this.$MercuryMessageStore2.at(0);if(l)this.$MercuryMessageStore5=l.timestamp;};function k(l,m,n){c('setTimeoutAcrossTransitions')(function(){i.debug('update:'+m,JSON.stringify({threadID:l,messageIDs:n.map(function(o){return o.message_id;})}));},0);}Object.assign(j,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});c('mixInEventEmitter')(j,{updated:true});f.exports=j;},null);
__d('ChatTabMessagesView',['Animation','Arbiter','BanzaiLogger','Bootloader','CSS','ChatConversation.react','ChatPerfInstrumentation','ChatTabViewEvents','ChatTypingIndicators.react','ChatWelcomeMessage','CurrentUser','DOM','Event','immutable','MercuryLastMessageIndicator.react','LiveTimer','MercuryIDs','MercuryThreads','MercuryMessageStore','MessengerContextBannerBootloader','MessengerHotLikePreviewEvents','React','ReactDOM','ReactComponentRenderer','MercuryShareAttachmentRenderLocations','Scroll','ServerTime','Style','SubscriptionsHandler','UserAgent_DEPRECATED','arrayContains','getElementPosition','throttle','isEventSupported'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryThreads').get(),i=64,j=null,k=20;function l(n){if(j===null){var o=n.childNodes[0];c('Style').set(n,'overflow','scroll');j=o.clientWidth-i;c('Style').set(n,'overflow','');}return j;}function m(n,o,p,q,r,s,t,u,v){this.loadingIcon=r;this.threadID=n;this.sheetController=o;this.scrollContainer=p;this.conversationElem=q;this.contextBannerEligible=v;this.contextBannerElem=null;this.tabView=u;c('LiveTimer').restart(c('ServerTime').get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function w(){c('ChatTabViewEvents').inform('interaction-with-tab',n);}this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(c('Arbiter').subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),c('Event').listen(this.scrollContainer,'mousedown',w));this._initOverflowObserver();var x=c('isEventSupported')('wheel')?'wheel':c('isEventSupported')('mousewheel')?'mousewheel':'DOMMouseScroll';this._subscriptions.addSubscriptions(c('Event').listen(this.scrollContainer,x,w));this._subscriptions.addSubscriptions(c('Event').listen(this.scrollContainer,'scroll',c('throttle')(this.scrolling,50,this)));var y=void 0;c('ReactDOM').render(c('React').createElement(c('ChatTypingIndicators.react'),{threadID:this.threadID,indicatorsWillShow:function(){return (y=this.isScrolledToBottom());}.bind(this),indicatorsDidShow:function(){return (y&&this.scrollToBottom(true));}.bind(this),viewer:c('CurrentUser').getID()}),t);var z=void 0;this.lastMessageIndicatorNode=s;this.lastMessageIndicator=new (c('ReactComponentRenderer'))(c('MercuryLastMessageIndicator.react'),this.lastMessageIndicatorNode);this.lastMessageIndicator.setProps({threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return z=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return z&&this.scrollToBottom(true);}.bind(this)});this.initializeConversation();}Object.assign(m.prototype,{initializeConversation:function(){this._store=new (c('MercuryMessageStore'))(this.threadID);this._conversation=new (c('ReactComponentRenderer'))(c('ChatConversation.react'),this.conversationElem);this._conversation.setProps({isCanonical:c('MercuryIDs').isCanonical(this.threadID),loadMoreMessages:this._loadMoreMessages.bind(this),maxBubbleWidth:l(this.scrollContainer),messages:c('immutable').List(),onAttachmentLoad:function(n){var o=this.scrollContainer,p=c('Scroll').getTop(o)+o.clientHeight;if(p+n>=o.scrollHeight-k||this._shouldScrollToBottom){this._shouldScrollToBottom=true;this.scrollToBottom();}}.bind(this),onMount:this.scrollToBottom.bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:c('CurrentUser').getID(),threadID:this.threadID});h.getThreadMeta(this.threadID,function(n){return this._conversation.setProps({thread:n});}.bind(this));this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').START,function(n,o){if(this.threadID!==o)return;this._likePreview=n;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').STOP,function(n){if(this.threadID!==n)return;this._likePreview=null;}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').FINISH_ANIMATION,function(n){clearInterval(this._scrollToBottomInterval);}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').REMOVE,function(n){if(this.threadID!==n)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}.bind(this)));},_initOverflowObserver:function(){if(!c('UserAgent_DEPRECATED').firefox())return;var n=function(){return c('Style').get(document.body,'overflowX')+' '+c('Style').get(document.body,'overflowY');},o=n(),p=function(){var s=n();if(s!==o){o=s;c('Arbiter').inform('overflow-applied-to-body');}};if('MutationObserver' in window){var q=new MutationObserver(p),r={attributes:true,attributeFilter:['class','style']};q.observe(document.documentElement,r);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))p();},false);},_updateMessageFromStore:function(n){if(n.eventType==c('MercuryMessageStore').MESSAGES_RECEIVED&&n.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;this._shouldScrollToBottom=false;}if(n.eventType==c('MercuryMessageStore').MESSAGES_REORDERED){this._loadingMoreMessages=false;c('CSS').hide(this.loadingIcon);}var o=this.isScrolledToBottom(),p=this._getLoadingHeight(),q=this.scrollContainer.scrollHeight,r=c('Scroll').getTop(this.scrollContainer);this._messages=n.messages;var s=c('ChatWelcomeMessage').getWelcomeMessage(this.threadID);if(s)this._messages.push(s);this._conversation.setProps({messages:this._getNormalizedMessages()},function(){if(o||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(n.eventType==c('MercuryMessageStore').MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-q-p+r);if(!this._initialLoadFinished){this._initialLoadFinished=true;c('ChatPerfInstrumentation').logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible)this.renderContextBanner(this.threadID);}.bind(this));h.getThreadMeta(this.threadID,function(t){return this._conversation.setProps({thread:t});}.bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(n.eventType==c('MercuryMessageStore').MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(n){this._shouldScrollToBottom=n;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){c('CSS').show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&c('Scroll').getTop(this.scrollContainer);},getThreadID:function(){return this.threadID;},destroy:function(){c('DOM').scry(this.conversationElem,'.stickerContainer').forEach(function(n){return c('ReactDOM').unmountComponentAtNode(n);});this.unmountContextBanner();c('ReactDOM').unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();c('ReactDOM').unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},isScrolledToBottom:function(n){var o=this.scrollContainer;n=n||k;return c('Scroll').getTop(o)+o.clientHeight>=o.scrollHeight-n;},isScrolledNearTop:function(){return c('Scroll').getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(n){this.scrollToPosition(this.scrollContainer.scrollHeight,n);},scrollToPosition:function(n,o){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(o===true){this._scrollTopAnimation=new (c('Animation'))(this.scrollContainer).to('scrollTop',n).ease(c('Animation').ease.end).duration(400).go();}else c('Scroll').setTop(this.scrollContainer,n);},_loadMoreMessages:function(){return this._store.fetchMoreMessages();},_onStickerClick:function(n,o){if(!n||!this.threadID)return;c('BanzaiLogger').log('StickersLoggerConfig',{event:'click_sticker',packid:n,stickerid:o});c('Bootloader').loadModules(["StickerState","StickerActions","StickerStoreController"],function(p,q,r){p.onTrayDataReady(function(){if(c('arrayContains')(p.getPackIDsInTray(),n)){var s=p.getPack(n);if(s&&s.isPromoted)q.addPack(n);q.selectPack(n);q.showStickerTray(this.threadID);}else r.showStore(n);}.bind(this));}.bind(this),'ChatTabMessagesView');},_checkToAnimateSticker:function(){var n=c('getElementPosition')(this.scrollContainer);c('Arbiter').inform('chatScrolled/'+this.threadID,{scrollTop:c('Scroll').getTop(this.scrollContainer),top:n.y,viewHeight:n.height});},setNewThreadID:function(n){this._store.setNewThreadID(n);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(n){return !n.is_like_preview;});return c('immutable').List(this._messages);},renderContextBanner:function(n,o){c('MessengerContextBannerBootloader').getBootloadedComponent(n,c('MercuryShareAttachmentRenderLocations').CHAT,function(p){c('Style').set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:p});}.bind(this),o,function(p){c('Style').set(this.conversationElem,'padding-top',p+'px');}.bind(this));},unmountContextBanner:function(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});f.exports=m;},null);
__d('ChatNubLogger',['BanzaiLogger','ScriptPath','pageID'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='TimeSpentChatNubLoggerConfig',i={INPUT_ACTIVE:'active',INPUT_INACTIVE:'inactive'},j={ENTER:'enter',LEAVE:'leave'},k=i.INPUT_INACTIVE,l=0,m=false;function n(){if(k==i.INPUT_ACTIVE&&!m){k=i.INPUT_INACTIVE;o(j.LEAVE);l=0;}else if(k==i.INPUT_INACTIVE&&m){k=i.INPUT_ACTIVE;l=Date.now();o(j.ENTER);}}function o(event){var q=c('BanzaiLogger').create({retry:true}),r=Date.now();q.log(h,{event:event,client_event_time_ms:r,active_time_ms:event==j.LEAVE?r-l:0,page_id:c('pageID'),script_path:c('ScriptPath').getScriptPath(),page_data:c('ScriptPath').getPageInfo()?c('ScriptPath').getPageInfo().extraData:{}});}var p={processEvent:function(q){switch(q){case 'focus':m=true;break;case 'blur':m=false;break;default:break;}n();}};f.exports=p;},null);
__d('ContextualLayerAutoFlipHorizontal',['ContextualLayerAutoFlip'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('ContextualLayerAutoFlip'));i=h&&h.prototype;j.prototype.getValidPositions=function(k){'use strict';return [k.getPosition()];};function j(){'use strict';h.apply(this,arguments);}f.exports=j;},null);
__d('ChatContentSearchContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','LayerHideOnEscape','ReactAbstractContextualDialog','ReactLayer'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal'),c('LayerHideOnEscape')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:47,length:16}}}));f.exports=i;},null);
__d('ChatFlyoutPlaceholder.react',['React','XUISpinner.react'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={padding:'30px',textAlign:'center'},i=function(){return (c('React').createElement('div',{style:h},c('React').createElement(c('XUISpinner.react'),{size:'large'})));};f.exports=i;},null);
__d('ChatContentSearchButton.react',['cx','fbt','BootloadOnRender.react','ChatFlyoutPlaceholder.react','ChatContentSearchContextualDialog.react','JSResource','LazyComponent.react','Link.react','ReactComponentWithPureRenderMixin','React','ReactLayeredComponentMixin','MercuryShareAttachmentRenderLocations','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatContentSearchButton',_clickGuard:false,mixins:[c('ReactComponentWithPureRenderMixin'),c('ReactLayeredComponentMixin')],propTypes:{ContextualDialogClass:j.func,flyoutAlignment:j.oneOf(['left','right']),getQuery:j.func.isRequired,location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),onLoad:j.func,onSelect:j.func.isRequired},getDefaultProps:function(){return {flyoutAlignment:'left',location:c('MercuryShareAttachmentRenderLocations').CHAT};},getInitialState:function(){return {query:'',shown:false};},componentDidMount:function(){this.props.onLoad&&this.props.onLoad(this);},updateQuery:function(){this.setState({query:this.props.getQuery()});},hideFlyout:function(){this.setState(this.getInitialState());},render:function(){return (c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:'button',title:i._("Choose a gif or sticker"),ref:'link'}));},renderLayers:function(){if(!this.state.shown)return {};var m=this.props.ContextualDialogClass||c('ChatContentSearchContextualDialog.react');return {contextualDialog:c('React').createElement(m,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link;}.bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{location:this.props.location,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,query:this.state.query}),loader:c('JSResource')('ChatContentSearchFlyout.react').__setRef('ChatContentSearchButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)}))};},_handleMouseDown:function(m){this._clickGuard=this.state.shown;},_handleClick:function(m){m.stopPropagation();if(this.state.shown||this._clickGuard)return;this.setState({query:this.props.getQuery(),shown:!this.state.shown});},_handleSelect:function(m,n){this.props.onSelect(m,n);this.hideFlyout();},_handleContextualDialogToggle:function(m){this.setState({shown:m});}});f.exports=l;},null);
__d('ChatEmojiButton.react',['cx','fbt','Bootloader','BootloadOnRender.react','ChatFlyoutPlaceholder.react','JSResource','LazyComponent.react','Link.react','ReactComponentWithPureRenderMixin','React','ReactLayeredComponentMixin','XUIContextualDialog.react','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatEmojiButton',_clickGuard:false,mixins:[c('ReactComponentWithPureRenderMixin'),c('ReactLayeredComponentMixin')],propTypes:{ContextualDialogClass:j.func.isRequired,flyoutAlignment:j.oneOf(['left','right']),onSelect:j.func},getDefaultProps:function(){return {ContextualDialogClass:c('XUIContextualDialog.react'),flyoutAlignment:'left'};},getInitialState:function(){return {shown:false};},hideFlyout:function(){this.setState(this.getInitialState());this.props.getInput&&this.props.getInput().focus();},render:function(){return (c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:'button',title:i._("Choose an emoji"),ref:'link'}));},renderLayers:function(){if(!this.state.shown)return {};var m=this.props.ContextualDialogClass;return {contextualDialog:c('React').createElement(m,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link;}.bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{onCategorySelect:this._focusInput,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,width:k}),loader:c('JSResource')('ChatEmojiFlyout.react').__setRef('ChatEmojiButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)}))};},_focusInput:function(){this.props.getInput&&this.props.getInput().focus();},_handleMouseDown:function(){this._clickGuard=this.state.shown;},_handleClick:function(m){m.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.setState({shown:!this.state.shown});this._focusInput();},_handleSelect:function(m){this.props.onSelect&&this.props.onSelect(m);},_handleContextualDialogToggle:function(m){this.setState({shown:m});}});f.exports=l;},null);
__d('MessengerEmojiSpan.react',['cx','DraftEntity','EmojiLikeConstants','EmojiLikeCxData','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MessengerEmojiSpan',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{children:i.arrayOf(i.object),entityKey:i.string.isRequired,offsetKey:i.string},render:function(){var k=c('DraftEntity').get(this.props.entityKey),l=k.getData(),m=l.type,n=c('EmojiLikeCxData').getUrl(m,c('EmojiLikeConstants').size.SMALL);n=n?n:'';return (c('React').createElement('span',{className:"_21wj",style:{backgroundImage:'url('+n+')'},'data-offset-key':this.props.offsetKey},c('React').createElement('span',{className:"_21wk"},this.props.children)));}});f.exports=j;},null);
__d('MessengerEmoticonSpan.react',['cx','DraftEntity','EmojiLikeConstants','EmojiLikeCxData','EmoticonEmojiList','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'MessengerEmoticonSpan',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{children:i.arrayOf(i.object),entityKey:i.string.isRequired,offsetKey:i.string},render:function(){var k=c('DraftEntity').get(this.props.entityKey),l=k.getData(),m=l.type,n=c('EmoticonEmojiList').emote2emojis[m],o=c('EmojiLikeCxData').getUrl(n,c('EmojiLikeConstants').size.XSMALL);o=o?o:'';return (c('React').createElement('span',{className:"_21wj",style:{backgroundImage:'url('+o+')'},'data-offset-key':this.props.offsetKey},c('React').createElement('span',{className:"_21wk"},this.props.children)));}});f.exports=j;},null);
__d('getVisibleValueForContentStateWithMessengerEmoji',['ContentState','DraftEntity','EmojiFormat','emptyFunction'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getBlockMap().map(function(k){var l=k.getText(),m='';k.findEntityRanges(c('emptyFunction').thatReturnsTrue,function(n,o){var p=k.getEntityAt(n);if(!p){m+=l.slice(n,o);}else{var q=c('DraftEntity').get(p);if(q.getType()==='EMOTICON'){m+=q.getData().originalEmoticon;}else if(q.getType()==='EMOJI'){var r=q.getData().type,s=c('EmojiFormat').codeStringToCodeArray(r);m+=String.fromCodePoint.apply(String,s);}else m+=l.slice(n,o);}});return m;});return j.join('\n');}f.exports=h;},null);
__d('insertMessengerEmojiIntoContentState',['ContentState','DraftEntity','DraftModifier','SelectionState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h='\u3000';function i(j,k,l,m){var n=c('DraftEntity').create('EMOJI','IMMUTABLE',{type:j});return c('DraftModifier').insertText(k,l,h,m,n);}f.exports=i;},null);
__d('handleBeforeInputForMessengerEmoji',['EditorState','MessengerSupportedEmoji','insertMessengerEmojiIntoContentState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=i.getSelection();if(!k.isCollapsed()||!j)return i;var l=c('MessengerSupportedEmoji').findEmoji(j);if(!l)return i;var m=c('insertMessengerEmojiIntoContentState')(l.emoji,i.getCurrentContent(),k,i.getCurrentInlineStyle());return c('EditorState').push(i,m,'insert-characters');}f.exports=h;},null);
__d('applyMessengerEmoticonToContentBlock',['CharacterMetadata','DraftEntity','EmoticonEmojiList','immutable'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i='\u3000';function j(k,l,m){if(!c('EmoticonEmojiList').names[l])return k;var n=c('DraftEntity').create('EMOTICON','IMMUTABLE',{type:c('EmoticonEmojiList').names[l],originalEmoticon:l}),o=k.getText(),p=k.getCharacterList(),q=l.length,r=p.get(m);return k.merge({text:o.slice(0,m)+i+o.slice(m+q),characterList:p.slice(0,m).concat(h.of(c('CharacterMetadata').applyEntity(r,n)),p.slice(m+q))});}f.exports=j;},null);
__d('applyMessengerEmoticonToContentState',['EmoticonEmojiList','applyMessengerEmoticonToContentBlock','getTextAfterNearestEntity'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i,j){var k=j.getAnchorKey(),l=j.getAnchorOffset(),m=i.getBlockForKey(k),n=c('getTextAfterNearestEntity')(m,l),o=c('EmoticonEmojiList').regexp.exec(n);if(!o)return i;var p=o[1];if(!p&&l!==n.length)return i;var q=o[2],r=l-n.length,s=r+o.index+o[1].length,t=i.getBlockMap().set(k,c('applyMessengerEmoticonToContentBlock')(m,q,s));l-=q.length-1;return i.merge({blockMap:t,selectionBefore:j,selectionAfter:j.merge({anchorOffset:l,focusOffset:l})});}f.exports=h;},null);
__d('handleBeforeInputForMessengerEmoticon',['DraftModifier','EditorState','applyMessengerEmoticonToContentState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=new RegExp(/[\s'".,!?]/);function i(j,k){var l=j.getSelection();if(!l.isCollapsed()||!k||!h.test(k))return j;var m=j.getCurrentContent(),n=c('applyMessengerEmoticonToContentState')(m,l);if(n===m)return j;var o=c('DraftModifier').insertText(n,n.getSelectionAfter(),k);return c('EditorState').push(j,o,'insert-characters');}f.exports=i;},null);
__d('handleSoftNewlineForMessengerEmoticon',['DraftModifier','EditorState','applyMessengerEmoticonToContentState'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(i){var j=i.getCurrentContent(),k=i.getSelection(),l=c('applyMessengerEmoticonToContentState')(j,k);if(l===j)return i;var m=c('DraftModifier').splitBlock(l,l.getSelectionAfter());return c('EditorState').push(i,m,'split-block');}f.exports=h;},null);
__d('ChatInput.react',['ContentState','CompositeDraftDecorator','DraftEditor.react','DraftModifier','EditorState','EmojiFormat','EmoticonSpan.react','MercuryConfig','MessengerEmojiSpan.react','MessengerEmoticonSpan.react','React','ReactDOM','clearImmediate','emptyFunction','getDefaultKeyBinding','getEntityMatcher','getVisibleValueForContentState','getVisibleValueForContentStateWithMessengerEmoji','handleBeforeInputForEmoticon','handleBeforeInputForMessengerEmoji','handleBeforeInputForMessengerEmoticon','handleSoftNewlineForEmoticon','handleSoftNewlineForMessengerEmoticon','insertEmoticonIntoEditorState','insertMessengerEmojiIntoContentState','isSoftNewlineEvent','setImmediate'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('emptyFunction').thatReturnsNull,j=c('React').createClass({displayName:'ChatInput',propTypes:{blockStyleFn:h.func,initializeThingsWithInputFn:h.func,inputKeyDown:h.func,keyBindingFn:h.func,onBeforeInput:h.func,onBlur:h.func,onEscape:h.func,onFocus:h.func,onTab:h.func,resizeFn:h.func},getDefaultProps:function(){return {blockStyleFn:i,keyBindingFn:c('getDefaultKeyBinding')};},componentDidMount:function(){this._oldHeight=c('ReactDOM').findDOMNode(this).getBoundingClientRect().height;this.props.resizeFn(this._oldHeight);this.props.initializeThingsWithInputFn(c('ReactDOM').findDOMNode(this.refs.input),this.getValue);this.setState({triggeredWord:this.props.triggeredWord});},componentWillUnmount:function(){if(this._updateToken)c('clearImmediate')(this._updateToken);this._updateToken=null;},componentWillReceiveProps:function(k){if(this.state.triggeredWord!==k.triggeredWord)this.setState({triggeredWord:k.triggeredWord},this._updateDecorator);},componentDidUpdate:function(){this._updateToken=c('setImmediate')(function(){this._updateToken=null;var k=c('ReactDOM').findDOMNode(this).getBoundingClientRect(),l=k.height;if(this._oldHeight!==l)this.props.resizeFn(l);this._oldHeight=l;}.bind(this));},getInitialState:function(){return {editorState:this._createEmptyEditorState()};},_createEmptyEditorState:function(){return c('EditorState').createWithContent(c('ContentState').createFromText(''),this._getDecorator());},resetState:function(){if(this.state.typeaheadReporter){this.state.typeaheadReporter.sessionEnd();this.state.typeaheadReporter.sessionStart();}this.setState({editorState:c('EditorState').moveFocusToEnd(this._createEmptyEditorState()),triggeredWord:null});},_updateDecorator:function(){var k=this._getDecorator();c('setImmediate')(function(){var l=c('EditorState').set(this.state.editorState,{decorator:k});this.setState({editorState:l});}.bind(this));},_getDecorator:function(){var k=c('MercuryConfig').MessengerNewEmojiGK,l=k?c('MessengerEmoticonSpan.react'):c('EmoticonSpan.react'),m=[{strategy:c('getEntityMatcher')(function(n){return n.getType()==='EMOTICON';}),component:l}];if(k)m.push({strategy:c('getEntityMatcher')(function(n){return n.getType()==='EMOJI';}),component:c('MessengerEmojiSpan.react')});return new (c('CompositeDraftDecorator'))(m);},onChange:function(k){this.setState({editorState:k});},onReturn:function(event){if(c('isSoftNewlineEvent')(event)){var k=c('MercuryConfig').MessengerNewEmojiGK?c('handleSoftNewlineForMessengerEmoticon')(this.state.editorState):c('handleSoftNewlineForEmoticon')(this.state.editorState);if(k===this.state.editorState)return false;this.setState({editorState:k});return true;}this.props.inputKeyDown(event,this.getValue());return true;},getValueFromEditorState:function(k){var l=k.getCurrentContent();return c('MercuryConfig').MessengerNewEmojiGK?c('getVisibleValueForContentStateWithMessengerEmoji')(l):c('getVisibleValueForContentState')(l);},getValue:function(){return this.getValueFromEditorState(this.state.editorState);},focus:function(){this.refs.input.focus();},_handleBeforeInput:function(k){this.props.onBeforeInput&&this.props.onBeforeInput();var l=this._handleBeforeInputForEmoticon(k),m=this._handleBeforeInputForEmoji(k);return l||m;},_handleBeforeInputForEmoticon:function(k){var l=c('MercuryConfig').MessengerNewEmojiGK?c('handleBeforeInputForMessengerEmoticon')(this.state.editorState,k):c('handleBeforeInputForEmoticon')(this.state.editorState,k);if(l===this.state.editorState)return false;this.setState({editorState:l});return true;},_handleBeforeInputForEmoji:function(k){if(!c('MercuryConfig').MessengerNewEmojiGK)return false;var l=c('handleBeforeInputForMessengerEmoji')(this.state.editorState,k);if(l===this.state.editorState)return false;this.setState({editorState:l});return true;},_handleFiles:function(k){var l=/^image\//,m=k.filter(function(n){return l.test(n.type);});if(m.length){this.props.uploadPhotoFn(m[0]);return true;}return false;},_handlePastedFiles:function(k){return this._handleFiles(k);},_handleDroppedFiles:function(k,l){return this._handleFiles(l);},insertEmoticon:function(k){var l=c('insertEmoticonIntoEditorState')(k,this.state.editorState);if(l!==this.state.editorState)this.setState({editorState:l});},insertEmoji:function(k){var l=this.state.editorState,m=c('insertMessengerEmojiIntoContentState')(c('EmojiFormat').codeArrayToCodeString(k),l.getCurrentContent(),l.getSelection(),l.getCurrentInlineStyle()),n=c('EditorState').push(l,m,'insert-characters');if(n!==this.state.editorState)this.setState({editorState:c('EditorState').forceSelection(n,m.getSelectionAfter())});},appendText:function(k){var l=this.state.editorState,m=l.getSelection(),n=l.getCurrentContent();n=c('DraftModifier').insertText(n,m,k);l=c('EditorState').push(l,n,'insert-characters');this.setState({editorState:l});},render:function(){return (c('React').createElement(c('DraftEditor.react'),babelHelpers['extends']({ref:'input'},this.props,{editorState:this.state.editorState,onChange:this.onChange,handleBeforeInput:this._handleBeforeInput,handlePastedFiles:this._handlePastedFiles,handleDroppedFiles:this._handleDroppedFiles,handleReturn:this.onReturn,spellCheck:true,stripPastedStyles:true})));}});f.exports=j;},null);
__d('ChatPhotoUploader.react',['cx','fbt','Promise','Bootloader','InlineBlock.react','Link.react','MercuryConfig','React','ReactDOM','SubscriptionsHandler','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=c('React').createClass({displayName:'ChatPhotoUploader',_uploader:null,_uploaderPromiseIsResolving:false,_uploaderPromise:null,_subscriptions:null,propTypes:{actionURI:j.string,allowCrossPage:j.bool,customUI:j.bool,disabled:j.bool,imageClassName:j.string,imagesOnly:j.bool,linkClassName:j.string,onSubmit:j.func,onAllUploadsComplete:j.func,onLastUploadFail:j.func,onLastUploadCancel:j.func,onMount:j.func,onUploadError:j.func},getDefaultProps:function(){return {actionURI:c('MercuryConfig').upload_url,allowCrossPage:true,costomUI:false,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:c('emptyFunction'),onAllUploadsComplete:c('emptyFunction'),onLastUploadFail:c('emptyFunction'),onLastUploadCancel:c('emptyFunction')};},shouldComponentUpdate:function(l){return l.actionURI!=this.props.actionURI||l.disabled!==this.props.disabled;},componentDidMount:function(){if(this.props.onMount)this.props.onMount(this);},componentDidUpdate:function(l){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var l=this.props.imagesOnly?i._("Add Photos"):i._("Add Files"),m=c('joinClasses')("_4q61"+(!this.props.customUI?' '+"_5f0v":'')+(!this.props.customUI?' '+"_509v":''),this.props.linkClassName);return (c('React').createElement('form',{action:this.props.actionURI,className:"_vzk",title:l,method:'post',onClick:function(n){n.stopPropagation();if(this.props.disabled)n.preventDefault();}.bind(this),ref:'form'},c('React').createElement('input',{type:'hidden',name:'attach_id',ref:'attachID'}),c('React').createElement('input',{type:'hidden',name:'images_only',value:this.props.imagesOnly}),c('React').createElement(c('InlineBlock.react'),{onClick:this._bootloadChatAutoSendPhotoUploader,className:c('joinClasses')(this.props.className,"_m _4q60 _3rzn")},c('React').createElement('input',{disabled:this.props.disabled,type:'file',className:"_n _2__f",name:'attachment[]',multiple:'true',accept:this.props.imagesOnly?'image/*':'*',ref:'input',title:l}),c('React').createElement(c('Link.react'),{className:m,tabIndex:-1},c('React').createElement('i',{className:this.props.imageClassName,alt:i._("Camera")})))));},_handleSubmit:function(l,m){this.props.onSubmit&&this.props.onSubmit(l,m);},_handleAllUploadsCompleted:function(l,m){this.props.onAllUploadsComplete&&this.props.onAllUploadsComplete(l,m);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(l,m){this.props.onLastUploadFail&&this.props.onLastUploadFail(l,m);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(l,m){this.props.onLastUploadCancel&&this.props.onLastUploadCancel(l,m);if(!this.isMounted())this._cleanup();},_handleUploadError:function(l,m){this.props.onUploadError&&this.props.onUploadError(m);if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new (c('Promise'))(function(l){c('Bootloader').loadModules(["ChatAutoSendPhotoUploader"],function(m){this._uploaderPromiseIsResolving=false;var n=new m(c('ReactDOM').findDOMNode(this.refs.form),c('ReactDOM').findDOMNode(this.refs.input),c('ReactDOM').findDOMNode(this.refs.attachID),c('MercuryConfig').msgr_region);n.setAllowCrossPage(this.props.allowCrossPage);var o=new (c('SubscriptionsHandler'))();o.addSubscriptions(n.subscribe('submit',this._handleSubmit),n.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),n.subscribe('last-upload-failed',this._handleLastUploadFailed),n.subscribe('last-upload-canceled',this._handleLastUploadCanceled),n.subscribe('file-upload-error',this._handleUploadError));this._subscriptions=o;this._uploader=n;l(this._uploader);}.bind(this),'ChatPhotoUploader.react');}.bind(this));}return this._uploaderPromise;},uploadFiles:function(l){this._bootloadChatAutoSendPhotoUploader().then(function(m){m.uploadFiles(l);});},uploadURL:function(l){this._bootloadChatAutoSendPhotoUploader().then(function(m){m.uploadURL(l);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});f.exports=k;},null);
__d('StickerContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','MercuryConfig','ReactAbstractContextualDialog','ReactLayer'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=7,j=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:i,length:16}}}));j.WIDTH={NORMAL:312,WIDE:400};f.exports=j;},null);
__d('ChatStickerButton.react',['cx','fbt','BootloadOnRender.react','ChatFlyoutPlaceholder.react','JSResource','LazyComponent.react','Link.react','MercuryConfig','React','ReactLayeredComponentMixin','StickerActions','StickerContextualDialog.react','StickerStateStore','StoreAndPropBasedStateMixin','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatStickerButton',_clickGuard:false,mixins:[c('ReactLayeredComponentMixin'),c('StoreAndPropBasedStateMixin')(c('StickerStateStore'))],propTypes:{className:j.string,ContextualDialogClass:j.func.isRequired,disabled:j.bool,flyoutClassName:j.string,flyoutWidth:j.number,getInput:j.func,onLoad:j.func,onStickerSelect:j.func.isRequired,onEmoticonSelect:j.func.isRequired,onFlyoutShown:j.func,onFlyoutHidden:j.func,threadID:j.string},statics:{calculateState:function(m){var n=c('StickerStateStore').getState();return {shown:n.showTray&&m.threadID===n.threadID};}},getDefaultProps:function(){return {ContextualDialogClass:c('StickerContextualDialog.react'),disabled:false,flyoutWidth:k,onStickerSelect:c('emptyFunction'),onEmoticonSelect:c('emptyFunction')};},componentDidMount:function(){this.props.onLoad&&this.props.onLoad(this);},componentDidUpdate:function(m,n){var o=this.state&&this.state.shown;if(o!==n.shown)if(o){this.props.onFlyoutShown&&this.props.onFlyoutShown();}else this.props.onFlyoutHidden&&this.props.onFlyoutHidden();},componentWillUnmount:function(){if(this.state.shown)this._hideFlyout();},shouldComponentUpdate:function(m,n){return this.props.disabled!==m.disabled||this.state.shown!==n.shown;},render:function(){var m=c('MercuryConfig').MessengerNewEmojiGK?i._("Choose a sticker"):i._("Choose a sticker or emoticon");return (c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onClick:this.showFlyout,onMouseDown:this._prepareForClick,role:'button',title:m,ref:'link'}));},renderLayers:function(){if(!this.state.shown)return {};var m=this.props.ContextualDialogClass;return {contextualDialog:c('React').createElement(m,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBeforeHide:this._handleBeforeHide,onBlur:this._hideFlyout,position:'above',shown:this.state.shown,width:this.props.flyoutWidth},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{className:this.props.flyoutClassName,onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,shown:this.state.shown}),loader:c('JSResource')('StickersFlyout.react').__setRef('ChatStickerButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(m){m&&m.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}c('StickerActions').showStickerTray(this.props.threadID);},_handleBeforeHide:function(){if(this.state.shown){this._hideFlyout();return false;}},_hideFlyout:function(){var m=this.props.getInput&&this.props.getInput();m&&m.focus&&m.focus();c('StickerActions').hideStickerTray();},_handleStickerSelected:function(m){this.props.onStickerSelect(m);},_handleEmoticonSelected:function(m){this._hideFlyout();this.props.onEmoticonSelect(m);}});f.exports=l;},null);
__d('MessengerHotLikeOutlineSVG.react',['cssVar','fbt','React','MercuryShareAttachmentRenderLocations','uniqueID','UserAgent'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k='transparent',l=i._("Thumbs Up Sign"),m=c('React').createClass({displayName:'MessengerHotLikeOutlineSVG',propTypes:{color:j.string,location:j.string},getInitialState:function(){return {titleId:c('uniqueID')()};},render:function(){var n=this.props.color||"#0084ff",o=c('UserAgent').isBrowser('Safari')?'0 0 40.16 42.24':'-1 -1 40.16 42.24',p=void 0;if(this.props.location!==c('MercuryShareAttachmentRenderLocations').CHAT&&this.props.location!==c('MercuryShareAttachmentRenderLocations').PAGES_INBOX)p={width:'66%'};return (c('React').createElement('svg',{'aria-labelledby':this.state.titleId,version:'1.1',viewBox:o,height:'90%',preserveAspectRatio:'xMinYMax meet',style:p},c('React').createElement('title',{id:this.state.titleId},l),c('React').createElement('path',{d:'M935.36,1582.44a0,0,0,0,0,0,.06,3.59,3.59,0,0,1-.72,6.53,0,0,0,0,0,0,0,3.56,3.56,0,0,1,.71,2.13,3.6,3.6,0,0,1-3,3.54, 0,0,0,0,0,0,.05,3.56,3.56,0,0,1,.38,1.61,3.61,3.61,0,0,1-3.42,3.6H910v-19.6l5.27-7.9a4,4,0,0,0,.66-2.31l-0.1-4c-0.22-2.4-.09-2.06, 1.13-2.37,2-.51,7.16,1.59,5.13,12.17h11.06A3.59,3.59,0,0,1,935.36,1582.44ZM899,1581h7v22h-7v-22Z',transform:'translate(-898.5 -1563.26)',fill:k,fillRule:'evenodd',stroke:n,strokeLinecap:'round',strokeWidth:'5%'})));}});f.exports=m;},null);
__d('MessengerHotLikeButton.react',['cx','fbt','EmojiLikeConstants','EmojiLikeCxData','Image.react','ImmutableObject','Keys','KeyStatus','Link.react','MercuryConfig','MercuryMessageObject','MercurySourceType','MessengerHotLikePreviewEvents','MessengerHotLikeOutlineSVG.react','MessengerHotLikeUtils','ReactComponentWithPureRenderMixin','React','StickerActions','StickerConstants','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('MercuryMessageObject').get(),k=c('React').PropTypes,l=c('React').createClass({displayName:'MessengerHotLikeButton',mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{onMouseDown:k.func,customLike:k.object,customColor:k.string,location:k.string,sendSticker:k.func.isRequired,sendCustomLike:k.func,threadID:k.string,disabled:k.bool,renderSize:k.number},_popTimeout:null,_pressedSince:null,_subscription:null,componentDidMount:function(){this._subscription=c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').FINISH_ANIMATION,function(m,n,o){if(m===this.props.threadID)if(o&&this.props.customLike&&this.props.sendCustomLike){this.props.sendCustomLike(this.props.customLike,o);}else this.props.sendSticker(n);}.bind(this));},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},render:function(){var m=null,n={};if(this.props.customLike!=null){if(c('MercuryConfig').MessengerNewEmojiGK){var o=this.props.customLike.emoji,p=c('EmojiLikeCxData').getNewEmojiData(o,c('EmojiLikeConstants').size.SMALL),q=this.props.renderSize?this.props.renderSize:16;n.background='none';m=c('React').createElement(c('Image.react'),{src:p.url,style:{padding:q==16?0:3,display:'block',height:q,width:q}});}else{o=this.props.customLike.medium;if(o){n.background='none';m=c('React').createElement(c('Image.react'),{src:o,style:{display:'block',height:16,width:16}});}}}else if(this.props.customColor)m=c('React').createElement(c('MessengerHotLikeOutlineSVG.react'),{color:this.props.customColor,location:this.props.location});var r=i._("Send a Like");return (c('React').createElement(c('Link.react'),{'aria-label':r,className:c('joinClasses')(this.props.customColor?"_5j_u":'',this.props.className),disabled:this.props.disabled,href:'#',onClick:this._handleClickEvent,onDragStart:function(s){return s.preventDefault();},onMouseDown:this._handleMouseDown,onMouseLeave:this._cancelSend,onMouseUp:this._handleMouseUp,role:'button',style:n,title:r},m));},_handleMouseDown:function(m){if(this.props.disabled||this._pressedSince){m.preventDefault();m.stopPropagation();}if(this.props.disabled||m.button!==0)return;c('StickerActions').hideStickerTray();this.props.onMouseDown&&this.props.onMouseDown();this._pressedSince=Date.now();this._informPreviewStart();this._preparePop();},_handleMouseUp:function(){if(!(this.props.threadID&&this._pressedSince))return;this._pressedSince=0;this._cancelPop();this._informPreviewStop();},_informPreviewStart:function(){if(!this.props.threadID)return;c('MessengerHotLikePreviewEvents').emit(c('MessengerHotLikePreviewEvents').START,this._getFakeMessage(),this.props.threadID);},_informPreviewStop:function(){if(!this.props.threadID)return;c('MessengerHotLikePreviewEvents').emit(c('MessengerHotLikePreviewEvents').STOP,this.props.threadID);},_informPreviewPop:function(){if(!this.props.threadID)return;c('MessengerHotLikePreviewEvents').emit(c('MessengerHotLikePreviewEvents').POP,this.props.threadID);},_getFakeMessage:function(){if(!this.props.threadID)return null;var m=j.constructStickerMessageObject(c('StickerConstants').HOT_LIKE_SMALL_STICKER_ID,c('MercurySourceType').MESSENGER_WEB,this.props.threadID);j.normalizeNewMessage(m);m.is_like_preview=true;m.like_preview_since=this._pressedSince;m.customLike=this.props.customLike;m.body='';return new (c('ImmutableObject'))(m);},_preparePop:function(){this._cancelPop();this._popTimeout=setTimeout(this._informPreviewPop,c('MessengerHotLikeUtils').SizeTimes.large);},_cancelSend:function(){if(this._pressedSince){this._pressedSince=0;this._cancelPop();this._informPreviewPop();}},_cancelPop:function(){clearTimeout(this._popTimeout);},_handleClickEvent:function(m){m.stopPropagation();if(this.props.disabled)return;if(c('KeyStatus').getKeyDownCode()===c('Keys').RETURN||!this.props.threadID){var n=this.props.sendCustomLike;if(this.props.customLike&&n){n(this.props.customLike,c('MessengerHotLikeUtils').getEmojiSizeForTime(1));}else this.props.sendSticker(c('MessengerHotLikeUtils').getStickerIDForTime(1));}}});f.exports=l;},null);
__d('ChatTabComposer.react',['csx','cx','fbt','ChatConfig','ChatContentSearchButton.react','ChatEmojiButton.react','ChatInput.react','ChatPhotoUploader.react','ChatStickerButton.react','CSS','JSResource','MercuryConfig','MessengerHotLikeButton.react','MessengerHotLikeUtils','P2PSendMoneyContainerBootloader.react','ReactComponentWithPureRenderMixin','React','MercuryShareAttachmentRenderLocations','StickerActions','convertMIGColorToFIGColor'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=77,m=c('ChatConfig').get('chat_basic_input_module')||c('ChatInput.react'),n=c('React').createClass({displayName:'ChatTabComposer',_fileUploader:null,_photoUploader:null,mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{disableFileUploads:k.bool,initializeThingsWithInputFn:k.func,inputKeyDown:k.func,onBlur:k.func,onEmojiSelect:k.func,onEscape:k.func,onFocus:k.func,onTab:k.func,p2pProps:k.object,participantIDs:k.arrayOf(k.string),photoUploaderProps:k.object,placeHolder:k.string,resizeFn:k.func,showP2PButton:k.bool,stickerButtonProps:k.object,uploadPhotoFn:k.func},getInitialState:function(){return {inputHeight:0,stickerFlyoutShown:false};},render:function(){return (c('React').createElement('div',{className:"_1d4_",onClick:this._handleClick},this._renderInput(),c('React').createElement('div',{className:"_552n"},this._renderIcons())));},resetInput:function(){this.refs.input.resetState();},uploadURL:function(o){var p=this._fileUploader||this._photoUploader;if(!p)return;p.uploadURL(o);},isUploading:function(){return !!(this._fileUploader&&this._fileUploader.isUploading()||this._photoUploader&&this._photoUploader.isUploading());},getInput:function(){return this.refs.input;},_renderInput:function(){var o={};if(this.state.inputHeight)o.minHeight=this.state.inputHeight;return (c('React').createElement('div',{className:"_552h",style:o},c('React').createElement(m,{initializeThingsWithInputFn:this.props.initializeThingsWithInputFn,inputKeyDown:this.props.inputKeyDown,onBeforeInput:function(){return this.refs.emojiButton&&this.refs.emojiButton.hideFlyout();}.bind(this),onBlur:this.props.onBlur,onEscape:this._handleEscape,onFocus:this.props.onFocus,onTab:this.props.onTab,ref:'input',resizeFn:function(p){p=Math.min(p,l);this.setState({inputHeight:p});this.props.resizeFn&&this.props.resizeFn(p);}.bind(this),uploadPhotoFn:function(p){this._photoUploader&&this._photoUploader.uploadFiles([p]);}.bind(this),placeholder:this.props.placeholder})));},_renderIcons:function(){return [this._renderPhotoUploader(),this._renderStickerButton(),this._renderContentSearchButton(),this._renderEmojiButton(),this._renderP2PButton(),this._renderFileUploader(),this._renderLikeButton()];},_renderPhotoUploader:function(){var o=this.props.photoUploaderProps||{};return (c('React').createElement(c('ChatPhotoUploader.react'),babelHelpers['extends']({key:'photos',onMount:function(p){return this._photoUploader=p;}.bind(this)},o)));},_renderFileUploader:function(){if(this.props.disableFileUploads)return null;var o=this.props.fileUploaderProps||{};return (c('React').createElement(c('ChatPhotoUploader.react'),babelHelpers['extends']({key:'files',onMount:function(p){return this._fileUploader=p;}.bind(this)},o)));},_renderStickerButton:function(){var o=this.props.stickerButtonProps;if(!o)return null;return (c('React').createElement('div',{className:"_6gd",key:'stickers'},c('React').createElement(c('ChatStickerButton.react'),babelHelpers['extends']({},o,{onFlyoutShown:function(){this.refs.input.focus();this.setState({stickerFlyoutShown:true});}.bind(this),onFlyoutHidden:function(){this.setState({stickerFlyoutShown:false});}.bind(this)}))));},_renderContentSearchButton:function(){if(!c('ChatConfig').get('chat_content_search'))return null;return (c('React').createElement('div',{className:"_6gd",key:'contentsearch'},c('React').createElement(c('ChatContentSearchButton.react'),{className:"_6gb _6gs",getQuery:function(){return this.refs.input.getValue();}.bind(this),onSelect:this._handleContentSearchSelect})));},_renderEmojiButton:function(){if(!c('ChatConfig').get('www_messenger_emoji_picker'))return null;return (c('React').createElement('div',{className:"_6gd",key:'emojipicker'},c('React').createElement(c('ChatEmojiButton.react'),{className:"_6gb _3oxr",getInput:function(){return this.refs.input;}.bind(this),onSelect:this.props.onEmojiSelect,ref:'emojiButton'})));},_renderLikeButton:function(){if(!c('ChatConfig').get('hotlike'))return null;var o=this.props.thread,p=c('MercuryConfig').ChatMessengerStyles?c('convertMIGColorToFIGColor')(o&&o.custom_color)||'':'',q=(!p?"_6h1":'')+(' '+"_6gb");return (c('React').createElement('div',{className:"_6gd _5ep3",key:'like'},c('React').createElement(c('MessengerHotLikeButton.react'),{className:q,customColor:p,customLike:c('MessengerHotLikeUtils').getCustomEmojiFromThread(o)||undefined,location:c('MercuryShareAttachmentRenderLocations').CHAT,sendSticker:this.props.onStickerSelect,sendCustomLike:this.props.onCustomLikeSelect,threadID:this.props.threadID})));},_renderP2PButton:function(){if(!this.props.p2pProps||!this.props.showP2PButton)return null;var o=this.props.p2pProps;o.threadID=this.props.threadID;if(this.props.participantIDs&&this.props.participantIDs.length)o.participantIDs=this.props.participantIDs;return (c('React').createElement('div',{className:"_6gd",key:'p2p'},c('React').createElement(c('P2PSendMoneyContainerBootloader.react'),o)));},_handleClick:function(o){if(c('CSS').matchesSelector(o.target,"._1d4_")||c('CSS').matchesSelector(o.target,"._552h")||c('CSS').matchesSelector(o.target,"._552n"))this.refs.input.focus();},_handleEscape:function(o){if(this.state.stickerFlyoutShown)return c('StickerActions').hideStickerTray();this.props.onEscape&&this.props.onEscape(o);},_handleContentSearchSelect:function(o,p){if(o.platformFBID.toString()!==c('MercuryConfig').MessengerAppID){this.uploadURL({attribution_app_id:o.platformFBID,errorDialogParams:{body:j._("There was a problem sending this GIF. Choose another one and try again."),title:j._("Couldn't Send GIF")},external_image_url:o.source.url,preview_url:o.media.preview?o.media.preview.url:o.media.thumbnail.url,source:o.source});}else this.props.onStickerSelect&&this.props.onStickerSelect(o.resultID.toString);}});f.exports=n;},null);
__d('ChatTabComposerContainer.react',['cx','fbt','ChatTabComposer.react','MercuryIDs','MercuryThreads','MercuryMessageActions','P2PGKValues','ReactComponentWithPureRenderMixin','React','MercuryShareAttachmentRenderLocations','SimpleXUIDialog','StoreAndPropBasedStateMixin'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j='right',k=c('React').PropTypes,l=c('React').createClass({displayName:'ChatTabComposerContainer',mixins:[c('ReactComponentWithPureRenderMixin'),c('StoreAndPropBasedStateMixin')(c('MercuryThreads'))],propTypes:{threadID:k.string,viewer:k.string.isRequired,onEmoticonSelect:k.func,onFileUploadFail:k.func,onPhotoUploadFail:k.func,onStickerSelect:k.func,onUploadCancel:k.func,onUploadComplete:k.func,onUploadSubmit:k.func},statics:{calculateState:function(m){var n=c('MercuryThreads').getForFBID(m.viewer),o=m.threadID?n.getOrFetch(m.threadID):null,p=c('P2PGKValues').P2PVisible&&m.viewer!==c('MercuryIDs').getUserIDFromThreadID(m.threadID);return {thread:o,showP2PButton:p,participantIDs:[],placeholder:m.placeholder};}},componentDidMount:function(){this.props.onMount(this);},render:function(){return (c('React').createElement(c('ChatTabComposer.react'),babelHelpers['extends']({fileUploaderProps:this._getFileUploaderProps(),ref:'composer',thread:this.state.thread},this.props,{p2pProps:this._getP2PProps(),participantIDs:this.state.participantIDs,photoUploaderProps:this._getPhotoUploaderProps(),placeholder:this.state.placeholder,showP2PButton:this.state.showP2PButton,stickerButtonProps:this._getStickerButtonProps()})));},onSend:function(){this.refs.composer.resetInput();},setPlaceholder:function(m){this.setState({placeholder:m});},setParticipantIDs:function(m){m=m||[];this.setState({participantIDs:m});},getInput:function(){return this.refs.composer.getInput();},isUploading:function(){return this.refs.composer.isUploading();},_getP2PProps:function(){if(!this.state.showP2PButton)return {};return {button:c('React').createElement('i',{className:"hidden_elem"}),className:"_6ga _6gb",flyoutAlignment:j,referrer:c('MercuryShareAttachmentRenderLocations').CHAT,threadID:this.props.threadID,onTrigger:this.props.onP2PTrigger};},_getStickerButtonProps:function(){var m={className:"_6gb _6gf",flyoutAlignment:j,threadID:this.props.threadID,onEmoticonSelect:this.props.onEmoticonSelect,onStickerSelect:this.props.onStickerSelect};return m;},_getPhotoUploaderProps:function(){var m={className:"_6gd",customUI:true,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge",onLastUploadCancel:this._handleUploadCancel,onAllUploadsComplete:this._handleUploadComplete,onLastUploadFail:this._handlePhotoUploadFail,onUploadError:this._handleUploadError,onSubmit:this._handleUploadSubmit};return m;},_getFileUploaderProps:function(){var m=this._getPhotoUploaderProps();m.linkClassName="_6gb _6gg";m.imagesOnly=false;m.onLastUploadFail=this._handleFileUploadFail;return m;},_handleUploadComplete:function(m,n){c('MercuryMessageActions').getForFBID(this.props.viewer).confirmAttachmentPlaceholder(n.upload_id,n);this.props.onUploadComplete&&this.props.onUploadComplete(n);},_handleUploadError:function(m){var n=void 0,o=void 0;switch(m.error){case 'size-exceeded':n=i._("The file you have selected is too large");o=i._("The file you have selected is too large. The maximum size is 25MB.");break;default:n=i._("File Upload Failed");o=i._("Please try again. There was a problem uploading the file.");}this._showErrorDialog(n,o);this.props.onFileUploadFail&&this.props.onFileUploadFail(m);},_handleUploadCancel:function(m,n){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(n.upload_id,n);this.props.onUploadCancel&&this.props.onUploadCancel(n);},_handleFileUploadFail:function(m,n){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(n.upload_id,n);var o=i._("File Upload Failed"),p=i._("Please try again. There was a problem uploading the file.");if(n.errorDialogParams){o=n.errorDialogParams.title||o;p=n.errorDialogParams.body||p;}this._showErrorDialog(o,p);this.props.onFileUploadFail&&this.props.onFileUploadFail(n);},_handlePhotoUploadFail:function(m,n){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(n.upload_id,n);var o=i._("Photo Upload Failed"),p=i._("Please try again. Make sure you are uploading a valid photo.");if(n.errorDialogParams){o=n.errorDialogParams.title||o;p=n.errorDialogParams.body||p;}this._showErrorDialog(o,p);this.props.onPhotoUploadFail&&this.props.onPhotoUploadFail(n);},_handleUploadSubmit:function(m,n){this.props.onUploadSubmit&&this.props.onUploadSubmit(n);},_showErrorDialog:function(m,n){c('SimpleXUIDialog').show(n,m);}});f.exports=l;},null);
__d('ChatTabSheetListener',['invariant','ChatPrivacyActionController','MercuryIDs','MercuryParticipants','MercuryThreadInformer','MercuryThreads','MercuryViewer'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){this.$ChatTabSheetListener1=k;this.$ChatTabSheetListener3=j;this.$ChatTabSheetListener4=c('MercuryIDs').getUserIDFromThreadID(this.$ChatTabSheetListener3);c('MercuryThreadInformer').get().subscribe('threads-updated',function(){return this.$ChatTabSheetListener5();}.bind(this));if(this.$ChatTabSheetListener4)this.$ChatTabSheetListener2=new (c('ChatPrivacyActionController'))(this.$ChatTabSheetListener4,function(l){return this.$ChatTabSheetListener6(l);}.bind(this));}i.prototype.destroy=function(){this.$ChatTabSheetListener2&&this.$ChatTabSheetListener2.destroy();};i.prototype.$ChatTabSheetListener5=function(){var j=c('MercuryThreads').get();j.getThreadMeta(this.$ChatTabSheetListener3,function(k){var l=c('MercuryViewer').getID(),m=k.participants.filter(function(n){return n!==l;});m.length<1&&!j.isNewEmptyLocalThread(this.$ChatTabSheetListener3)?this.$ChatTabSheetListener1.openNoRecipientsSheet():this.$ChatTabSheetListener1.closeNoRecipientsSheet();}.bind(this));};i.prototype.$ChatTabSheetListener6=function(j){switch(j){case c('ChatPrivacyActionController').OFFLINE:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.openOfflineSheet();break;case c('ChatPrivacyActionController').NORMAL:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.closeOfflineSheet();break;case c('ChatPrivacyActionController').BLOCKED:this.$ChatTabSheetListener1.closeOfflineSheet();!!!this.$ChatTabSheetListener4?h(0):void 0;c('MercuryParticipants').get(c('MercuryIDs').getParticipantIDFromUserID(this.$ChatTabSheetListener4),function(k){k.is_friend?this.$ChatTabSheetListener1.openUserBlockedSheet():this.$ChatTabSheetListener1.closeUserBlockedSheet();}.bind(this));break;}};f.exports=i;},null);
__d('ChatTabSheetController',['Bootloader','ChatTabSheetListener','Deferred','MercurySheetPolicy'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=function(i,j,k,l){this._threadID=i;this._rootElement=j;this._tabElement=k;this._view=l;this._deferred=new (c('Deferred'))();this._isLoading=false;this._listener=new (c('ChatTabSheetListener'))(this._threadID,this);};Object.assign(h.prototype,{openAddFriendsSheet:function(){this._load(function(){this._addFriendsTabSheet.open();}.bind(this));},openMessageBlockedTabSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}.bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(i){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet,{automatic:i});}.bind(this));},openReadOnlySheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}.bind(this));},openPermanentReadOnlySheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}.bind(this));},openNewMessagesSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}.bind(this));},openUploadWarningTabSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUploadWarningTabSheet);}.bind(this));},openThreadIsMutedTabSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}.bind(this));},openEmployeeAwaySheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatEmployeeAwaySheet);}.bind(this));},openUserFocusSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserFocusSheet);}.bind(this));},openOfflineSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}.bind(this));},openUserBlockedSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);}.bind(this));},openNoRecipientsSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);}.bind(this));},openSecretModeSheet:function(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatThreadSecretModeSheet);}.bind(this));},openPageResponsivenessSheet:function(i){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator,{description:i});}.bind(this));},closeAddFriendsSheet:function(){this._lazy(function(){this._addFriendsTabSheet.close();}.bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}.bind(this));},closeUserBlockedSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);}.bind(this));},closeUploadWarningTabSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatUploadWarningTabSheet);}.bind(this));},closeSecretModeSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatThreadSecretModeSheet);}.bind(this));},closeMessageBlockedTabSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}.bind(this));},closeOfflineSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}.bind(this));},closeNoRecipientsSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);}.bind(this));},closeNewMessagesSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}.bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}.bind(this));},closePageResponsivenessSheet:function(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator);}.bind(this));},onResize:function(i){this._lazy(function(){this._sheetView.subscribe('resize',i);}.bind(this));},onTokensChanged:function(i){this._lazy(function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',i);}.bind(this));},onEscape:function(i){this._lazy(function(){this._addFriendsTabSheet.subscribe('esc-pressed',i);}.bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();},_load:function(i){this._bootload();this._deferred.done(i);},_lazy:function(i){this._deferred.done(i);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;c('Bootloader').loadModules(["ChatAddFriendsTabSheet","MercurySheetView"],function(i,j){this._sheetView=new j(this._threadID,this._rootElement,this._tabElement,this._view);this._addFriendsTabSheet=new i(this._threadID,this._rootElement,this._sheetView,this._view);this._deferred.resolve();}.bind(this),'ChatTabSheetController');}});f.exports=h;},null);
__d('ChatTitleLink.react',['cx','ChatEditParticipantsUtils','Link.react','MercuryThreads','MercuryThreadTitle.react','MessengerAdminGroupUtils','React','TrackingNodes','UserAgent'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('MercuryThreads').get(),j=c('React').PropTypes,k=c('React').createClass({displayName:'ChatTitleLink',propTypes:{href:j.string,thread:j.object,viewer:j.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (c('React').createElement(c('Link.react'),{'aria-level':'3',className:"titlebarText"+(c('UserAgent').isBrowser('Chrome')&&!c('UserAgent').isPlatform('Windows')?' '+"fixemoji":'')+(this.props.href===null?' '+"noLink":''),'data-ft':c('TrackingNodes').getTrackingInfo(c('TrackingNodes').types.TITLE),'data-hover':'tooltip',onClick:function(l){return this._handleClick(l);}.bind(this),href:this.props.href},c('React').createElement(c('MercuryThreadTitle.react'),{ref:'threadTitle',isNewThread:i.isNewEmptyLocalThread(this.props.thread.thread_id),thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));},_handleClick:function(l){if(c('MessengerAdminGroupUtils').showParticipantsModal(this.props.thread.is_canonical,i.isEmptyLocalThread(this.props.thread.thread_id),this.props.thread)){c('ChatEditParticipantsUtils').showParticipantsModal(this.props.thread.thread_id);l.preventDefault();}}});f.exports=k;},null);
__d("XMNCommercePostbackCTAController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/postback\/",{cta_id:{type:"String",required:true}});},null);
__d('MNCommercePostbackCTADataManager',['AsyncRequest','BanzaiODS','CurrentUser','MercuryConfig','MercuryMessageActions','MercuryMessageObject','MercurySourceType','XMNCommercePostbackCTAController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('MercuryMessageActions').get();i.prototype.send=function(j){var k=c('XMNCommercePostbackCTAController').getURIBuilder().setString('cta_id',j).getURI();new (c('AsyncRequest'))().setURI(k).setMethod('post').send();};i.prototype.sendAndConfirm=function(j,k,l){this.send(j);if(!c('MercuryConfig').WWWMessengerSendMessageOnPostbackGK)return;if(!l){c('BanzaiODS').bumpEntityKey('messenger_commerce','confirm_message_failed.empty_threadID');}else{var m=new (c('MercuryMessageObject'))(c('CurrentUser').getID());h.send(m.constructCTAConfirmationMessageObject(k,c('MercurySourceType').TITAN_WEB,l));}};function i(){}f.exports=new i();},null);
__d('MercuryCanonicalGroupThreadManager',['Bootloader','KeyedCallbackManager','MercuryIDs','MercuryServerPayloadPreprocessor','MercurySingletonProvider','MercuryThreads','MercuryServerDispatcher','SubscriptionsHandler'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(j){this.$MercuryCanonicalGroupThreadManager1=j;this.$MercuryCanonicalGroupThreadManager2=new (c('KeyedCallbackManager'))();this.$MercuryCanonicalGroupThreadManager3=c('MercuryServerPayloadPreprocessor').getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager6=c('MercuryThreads').getForFBID(this.$MercuryCanonicalGroupThreadManager1);this.$MercuryCanonicalGroupThreadManager4={};this.$MercuryCanonicalGroupThreadManager7();this.$MercuryCanonicalGroupThreadManager8();}h.getForFBID=function(j){return i.getForFBID(j);};h.get=function(){return i.get();};h.prototype.getCanonicalGroupThreadIDForParticipants=function(j,k){j=this.$MercuryCanonicalGroupThreadManager9(j);var l=this.$MercuryCanonicalGroupThreadManager10(j),m=this.$MercuryCanonicalGroupThreadManager2.executeOrEnqueue(l,k);this.$MercuryCanonicalGroupThreadManager11(j);return m;};h.prototype.unsubscribe=function(j){if(j)this.$MercuryCanonicalGroupThreadManager2.unsubscribe(j);};h.prototype.$MercuryCanonicalGroupThreadManager10=function(j){return j.sort().join(',');};h.prototype.$MercuryCanonicalGroupThreadManager12=function(j,k){var l=c('MercuryIDs').getThreadIDFromThreadFBID(k);this.$MercuryCanonicalGroupThreadManager2.setResource(j,l);this.$MercuryCanonicalGroupThreadManager4[l]=j;};h.prototype.$MercuryCanonicalGroupThreadManager11=function(j){var k={canonical_group_key:this.$MercuryCanonicalGroupThreadManager10(j),participants:j};c('MercuryServerDispatcher').trySend('/ajax/mercury/search_canonical_groups.php',k,null,this.$MercuryCanonicalGroupThreadManager1);};h.prototype.$MercuryCanonicalGroupThreadManager7=function(){c('MercuryServerDispatcher').registerEndpoints({'/ajax/mercury/search_canonical_groups.php':{request_user_id:this.$MercuryCanonicalGroupThreadManager1,mode:c('MercuryServerDispatcher').IMMEDIATE,handler:function(j){this.handleUpdate(j);}.bind(this)}});};h.prototype.$MercuryCanonicalGroupThreadManager9=function(j){if(j.indexOf(this.$MercuryCanonicalGroupThreadManager1)===-1)j.push(this.$MercuryCanonicalGroupThreadManager1);return j;};h.prototype.handleUpdate=function(j){if(j.mercury_payload)this.$MercuryCanonicalGroupThreadManager3.handleUpdate(j.mercury_payload);var k=j.canonical_group;if(k)for(var l in k)this.$MercuryCanonicalGroupThreadManager12(l,k[l]);};h.prototype.getNow=function(j){var k=this.$MercuryCanonicalGroupThreadManager10(this.$MercuryCanonicalGroupThreadManager9(j));return this.$MercuryCanonicalGroupThreadManager2.getResource(k);};h.prototype.$MercuryCanonicalGroupThreadManager8=function(){c('Bootloader').loadModules(["MercuryThreadInformer"],function(j){var k=j.getForFBID(this.$MercuryCanonicalGroupThreadManager1),l=new (c('SubscriptionsHandler'))();l.addSubscriptions(k.subscribe('threads-deleted',function(m,n){for(var o in n)if(this.$MercuryCanonicalGroupThreadManager4[o]){this.$MercuryCanonicalGroupThreadManager2.setResource(this.$MercuryCanonicalGroupThreadManager4[o],undefined);delete this.$MercuryCanonicalGroupThreadManager4[o];}}.bind(this)));this.$MercuryCanonicalGroupThreadManager5=l;}.bind(this),'MercuryCanonicalGroupThreadManager');};var i=new (c('MercurySingletonProvider'))(h);f.exports=h;},null);
__d('MessengerEmojiUsageUtils',['MessengerSupportedEmoji'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={findAllEmojis:function(i){var j=[];while(i.length>0){var k=c('MessengerSupportedEmoji').findEmoji(i);if(!k)break;var l=k.emoji.split('_').map(function(m){return parseInt(m,16);});j.push(l);i=i.substr(k.index+k[0].length);}return j;}};f.exports=h;},null);
__d("XPagesMercuryIndicatorController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null);
__d('PagesMercuryChatTabIndicatorHandler',['AsyncRequest','AvailableListConstants','ChatPrivacyActionController','ChatVisibility','DOM','FBID','MercuryIDs','PresencePrivacy','XPagesMercuryIndicatorController'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();h.tryCreateHandler=function(i,j,k,l){var m=c('MercuryIDs').getUserIDFromThreadID(i);if(!m||c('FBID').isUser(m))return null;return new h(m,j,k,l);};function h(i,j,k,l){this.$PagesMercuryChatTabIndicatorHandler2=false;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler5=j;this.$PagesMercuryChatTabIndicatorHandler6=false;this.$PagesMercuryChatTabIndicatorHandler7=i;this.$PagesMercuryChatTabIndicatorHandler10=k;this.$PagesMercuryChatTabIndicatorHandler9=l;this.$PagesMercuryChatTabIndicatorHandler8=new (c('ChatPrivacyActionController'))(i,function(m){return this.$PagesMercuryChatTabIndicatorHandler11(m);}.bind(this));}h.prototype.__getEnableTimeSwitch=function(){return this.$PagesMercuryChatTabIndicatorHandler2;};h.prototype.__getIsShown=function(){return this.$PagesMercuryChatTabIndicatorHandler4;};h.prototype.__getPageOnlineStatus=function(){return this.$PagesMercuryChatTabIndicatorHandler5;};h.prototype.__getShouldPreventFutureShown=function(){return this.$PagesMercuryChatTabIndicatorHandler6;};h.prototype.__getTargetID=function(){return this.$PagesMercuryChatTabIndicatorHandler7;};h.prototype.__getIsChecking=function(){return this.$PagesMercuryChatTabIndicatorHandler3;};h.prototype.__getResponsivenessDescription=function(){return this.$PagesMercuryChatTabIndicatorHandler1;};h.prototype.checkResponsiveness=function(){if(this.$PagesMercuryChatTabIndicatorHandler3)return;var i=c('XPagesMercuryIndicatorController').getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler3=true;new (c('AsyncRequest'))().setURI(i).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler7}).setHandler(function(j){this.$PagesMercuryChatTabIndicatorHandler3=false;var k=j.payload;if(k.responsiveness)this.$PagesMercuryChatTabIndicatorHandler12(k.responsiveness,k.enableTimeSwitch);}.bind(this)).send();};h.prototype.hideIndicator=function(){this.$PagesMercuryChatTabIndicatorHandler13(false);};h.prototype.hideIndicatorAndPreventFutureShow=function(){this.$PagesMercuryChatTabIndicatorHandler13(true);};h.prototype.$PagesMercuryChatTabIndicatorHandler13=function(i){this.$PagesMercuryChatTabIndicatorHandler6=this.$PagesMercuryChatTabIndicatorHandler6||i;if(this.$PagesMercuryChatTabIndicatorHandler4){this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler9();}};h.prototype.showIndicator=function(){if(this.$PagesMercuryChatTabIndicatorHandler4||this.$PagesMercuryChatTabIndicatorHandler5!==c('AvailableListConstants').OFFLINE||!this.$PagesMercuryChatTabIndicatorHandler1||!c('ChatVisibility').isOnline()||!c('PresencePrivacy').allows(this.targetID)||this.$PagesMercuryChatTabIndicatorHandler6)return;this.$PagesMercuryChatTabIndicatorHandler4=true;this.$PagesMercuryChatTabIndicatorHandler10(this.$PagesMercuryChatTabIndicatorHandler1);};h.prototype.notifyPageOnlineStatusChanged=function(i){if(this.$PagesMercuryChatTabIndicatorHandler5===i)return;this.$PagesMercuryChatTabIndicatorHandler5=i;if(!this.$PagesMercuryChatTabIndicatorHandler2)return;switch(i){case c('AvailableListConstants').ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};h.prototype.$PagesMercuryChatTabIndicatorHandler12=function(i,j){this.$PagesMercuryChatTabIndicatorHandler1=i;this.$PagesMercuryChatTabIndicatorHandler2=j;this.showIndicator();};h.prototype.$PagesMercuryChatTabIndicatorHandler11=function(i){switch(i){case c('ChatPrivacyActionController').OFFLINE:case c('ChatPrivacyActionController').BLOCKED:this.$PagesMercuryChatTabIndicatorHandler13(true);break;}};f.exports=h;},null);
__d("XMNCommercePageNullStateCTAController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/page\/nullstate\/",{});},null);
__d('ChatTabView',['csx','cx','fbt','Promise','AsyncRequest','AsyncSignal','AvailableListConstants','BootloadedComponent.react','Bootloader','ChatBehavior','ChatConfig','ChatNubLogger','ChatOpenTab','ChatPerfInstrumentation','ChatTabActions','ChatTabBlinking','ChatTabComposerContainer.react','ChatTabLazyFocus','ChatTabMessagesView','ChatTabSheetController','ChatTabViewEvents','ChatTabViewInstances','ChatTitleLink.react','ChatVisibility','CSS','CurrentUser','Dock','DOM','DOMQuery','DragDropTarget','EmojiLikeUtils','EmojiState','EmoticonsList','Event','FBID','JSResource','Keys','LogHistory','MercuryBlockedParticipants','MercuryCanonicalGroupThreadManager','MercuryConfig','MercuryIDs','MercuryParticipants','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryThreadInfo','MercuryThreadTitle.react','MercuryTypingAnimation.react','MercuryTypingReceiver','MercuryViewer','MessageRequestUtils','MessagingTag','MessengerEmojiUsageUtils','MNCommercePostbackCTADataManager','NubController','PagesMercuryChatTabIndicatorHandler','Parent','PhotosUploadWaterfall','PresenceStatus','React','ReactComponentRenderer','ReactDOM','Run','Scroll','ShortProfiles','SimpleXUIDialog','SiteData','Style','SubscriptionsHandler','SyntheticMouseEvent','ChatTabTemplates','TooltipData','TypingDetectorController','UserAgent_DEPRECATED','WaterfallIDGenerator','WebMessengerThreadPermalinks','WorkFileUploadsGating','WorkFocusMode','WorkModeConfig','createCancelableFunction','convertMIGColorToFIGColor','emptyFunction','getActiveElement','getVendorPrefixedEventName','ifRequired','isEmpty','requireWeak','setIntervalAcrossTransitions','MercuryMessageObject','MercuryMessages','MercuryServerRequests','MercuryThreadActions','MercuryThreadIDMap','MercuryThreadInformer','MercuryThreads','MercuryMessageActions','XMNCommercePageNullStateCTAController'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('MercuryTypingReceiver').get(),l=c('MercuryMessageObject').get(),m=c('MercuryMessages').get(),n=c('MercuryServerRequests').get(),o=c('MercuryThreadActions').get(),p=c('MercuryThreadIDMap').get(),q=c('MercuryThreadInformer').get(),r=c('MercuryThreads').get(),s=c('MercuryMessageActions').get(),t=/^\s*$/,u=c('ChatTabViewInstances'),v=960,w=10,x=c('ChatConfig').get('chat_simple_group_title_tooltip'),y='\n',z=/\D+/g,aa=c('MercuryConfig').ChatMessengerStyles,ba=c('MercuryConfig').CloseAnimation,ca=c('ChatConfig').get('web_messenger_thread_null_state_cta'),da=c('ChatConfig').get('always_enable_cta_instead_of_composer'),ea=c('LogHistory').getInstance('chat_tab_view');c('requireWeak')('AvailableList',function(ua){ua.subscribe(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,ra);});function fa(ua,va){var wa=c('DOM').create('div'),xa=[];va=va&&va.filter(function(ab){return ab!=c('MercuryViewer').getID();});if(c('isEmpty')(va))return c('TooltipData').remove(ua);var ya=va.length,za=ya-w;if(za>1)va=va.slice(0,w);c('MercuryParticipants').getMulti(va,function(ab){for(var bb in ab){var cb=ab[bb];if(x){xa.push(cb.name);continue;}var db=c('ChatTabTemplates')[':fb:mercury:chat:multichat-tooltip-item'].build();c('DOM').setContent(db.getNode('name'),cb.name);var eb=c('MercuryIDs').getUserIDFromParticipantID(bb),fb=eb&&c('PresenceStatus').get(eb)==c('AvailableListConstants').ACTIVE;c('CSS').conditionShow(db.getNode('icon'),fb);c('CSS').conditionClass(db.getNode('name'),"_1aly",fb);c('DOM').appendContent(wa,db.getRoot());}if(za>1){var gb=j._("and {number of hidden chat participants} more.",[j.param('number of hidden chat participants',za)]);if(!x){c('DOM').appendContent(wa,c('DOM').create('div',{},gb));}else xa.push(gb);}c('TooltipData').set(ua,x?xa.join(y):wa,'above');});}function ga(ua){var va=c('MercuryIDs').tokenize(ua);switch(va.type){case 'user':return c('ChatTabTemplates')[':fb:mercury:chat:user-tab'].build();}return c('ChatTabTemplates')[':fb:mercury:chat:multichat-tab'].build();}function ha(ua){var va=ua._getInputValue();c('EmojiState').updateRecentlyUsed(c('MessengerEmojiUsageUtils').findAllEmojis(va));var wa=ua._filesUploader,xa=wa?wa.getAttachments():[];if(ma(ua))ja(ua,va,xa,function(ya){ya=ta(ya,wa);s.send(ya,function(za){var ab=r.getThreadMetaNow(za);if(ab&&c('MessageRequestUtils').isMessageRequest(ab))o.movePendingToInbox(za);if(ab&&ab.other_user_fbid&&!c('FBID').isUser(ab.other_user_fbid))c('ChatTabViewEvents').inform('chat-send-to-page',{pageID:ab.other_user_fbid});});wa&&wa.removeAttachments();if(ua._sharePreview)ua._sharePreview.setProps({share:null,uri:null});ua._composer&&ua._composer.onSend();ua._typingDetector&&ua._typingDetector.resetState();if(ua._messagesView){ua._messagesView.scrollToBottom();ua._messagesView.setShouldScrollToBottom(true);ua.tryMarkAsRead();}});}function ia(ua,va){if(va===0)return;oa(ua,c('PhotosUploadWaterfall').POST_PUBLISHED,{count:va});ua._waterfallID=c('WaterfallIDGenerator').generate();}function ja(ua,va,wa,xa){r.getThreadMeta(ua._threadID,function(ya){if(ya&&ya.is_canonical&&!c('MercuryThreadInfo').canReply(ya)){ua._showMessageBlockedDialog(ya);return;}var za=c('MercurySourceType').CHAT_WEB,ab=l.constructUserGeneratedMessageObject(va,za,ua._threadID);if(wa.length>0){ab.has_attachment=true;ab.raw_attachments=wa;}if(ua._sharePreview&&ua._sharePreview.component){var bb=ua._sharePreview.component.getShareData();if(bb){ab.has_attachment=true;ab.shareable_attachment=bb;}}if(r.isNewEmptyLocalThread(ua._threadID)){var cb=ua._sheetController.getAddFriendsParticipants();ua._sheetController.closeAddFriendsSheet();if(cb===null||cb.length===0)return;cb=cb.filter(function(fb){return fb!=c('MercuryViewer').getID();});if(cb.length===0){ab.thread_id=c('MercuryIDs').getThreadIDFromUserID(c('CurrentUser').getID());}else if(cb.length===1){ab.thread_id=c('MercuryIDs').getThreadIDFromParticipantID(cb[0]);}else{var db=ua.getMessagesView().getThreadID();if(db!=ua._threadID)ab.thread_id=db;o.addParticipants(ua._threadID,cb);}}if(r.isEmptyLocalThread(ua._threadID)){ab.offline_threading_id=c('MercuryIDs').tokenize(ua._threadID).value;var eb=r.getThreadMetaNow(ya.thread_id);ab.specific_to_list=Array.from(eb.participants);}if(ab!=undefined)ab.signatureID=ua._signatureID;ab.ui_push_phase=c('SiteData').push_phase;xa(ab);if(ua._threadID!==ab.thread_id&&!ua.isUploading())(function(){var fb=ua._getInputValue();if(c('WorkFocusMode').currentViewerInFocusMode()&&c('WorkFocusMode').currentViewerInFocusMode(ua._threadID))c('WorkFocusMode').addBypassFocusModeForThread(ab.thread_id);c('ChatTabActions').closeTab(ua._threadID);c('ChatOpenTab').openThread(ab.thread_id,'ChatTabView',null,va?c('emptyFunction'):function(gb){return gb.appendTextToInput(fb);});})();});}function ka(ua){ua._blocked=true;ua._sheetController.openUploadWarningTabSheet();}function la(ua){return ua.isUploading();}function ma(ua){var va=ua._getInputValue();if(!t.test(va))return true;var wa=ua._filesUploader;if(wa&&(wa.getAttachments().length>0||wa.getImageFiles().length>0||wa.getAnimatedImageFiles().length>0||wa.getVideoFiles().length>0||wa.getAudioFiles().length>0||wa.getFiles().length>0))return true;if(ua._sharePreview&&ua._sharePreview.component.getShareData())return true;return false;}function na(ua){ua._nubController.flyoutContentChanged();var va=ua._getNode('attachmentShelf');c('Scroll').setTop(va,va.scrollHeight);}function oa(ua,va,wa){c('PhotosUploadWaterfall').sendSignal(babelHelpers['extends']({qn:ua._waterfallID,step:va,uploader:c('PhotosUploadWaterfall').APP_CHAT},wa||{}));}function pa(ua,va,wa,xa,ya){if(va)n.ensureThreadIsFetched(va);this._threadID=ua;this._signatureID=wa;this._eventListeners=[];this._onlineStatus=c('AvailableListConstants').OFFLINE;this._tabTemplate=ga(ua);this._tabElem=this._tabTemplate.getRoot();if(ya&&ya.getTabElem()){this.insertBefore(ya);}else this.appendTo(xa);this._messagesView=null;this._customColor=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._nubButton=c('DOMQuery').scry(this._tabElem,".fbNubButton")[0];this._waterfallID=c('WaterfallIDGenerator').generate();this._subscriptionsHandler=new (c('SubscriptionsHandler'))();this._canonicalGroupSearchSubscriptionID=null;this._initializeSheetController();var za=[c('emptyFunction'),this._initializeDockUIListeners.bind(this),function(){this.updateAvailableStatus();this.updateTab();}.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this)];this._flyoutInitializers=[this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeTitleHREF.bind(this),this._initializeInput.bind(this),this._initializeDragDropTarget.bind(this),this._initializeUnloadListeners.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializePagesGreeting.bind(this)];for(var ab=za,bb=Array.isArray(ab),cb=0,ab=bb?ab:ab[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var db;if(bb){if(cb>=ab.length)break;db=ab[cb++];}else{cb=ab.next();if(cb.done)break;db=cb.value;}var eb=db;eb();}if(!c('ChatConfig').get('www_chat_smart_render'))this._initFlyout();u.set(ua,this);this._logOpenTab();}function qa(ua){if(ua._photoUploader&&ua._photoUploader.isUploading())oa(ua,c('PhotosUploadWaterfall').CANCEL_DURING_UPLOAD);}function ra(){for(var ua=u.values(),va=Array.isArray(ua),wa=0,ua=va?ua:ua[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var xa;if(va){if(wa>=ua.length)break;xa=ua[wa++];}else{wa=ua.next();if(wa.done)break;xa=wa.value;}var ya=xa;ya.updateAvailableStatus();ya.updateTitlebarTooltip();}}c('ChatBehavior').subscribe(c('ChatBehavior').ON_CHANGED,function(){for(var ua=u.keys(),va=Array.isArray(ua),wa=0,ua=va?ua:ua[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var xa;if(va){if(wa>=ua.length)break;xa=ua[wa++];}else{wa=ua.next();if(wa.done)break;xa=wa.value;}var ya=xa;r.getThreadMeta(ya,function(za){u.get(ya)._updateUnreadCount(za);});}});k.addRetroactiveListener('state-changed',function(ua){for(var va in ua){var wa=ua[va]&&ua[va].length,xa=u.get(va);xa&&xa.showTypingIndicator(wa);}});q.subscribe('threads-updated',function(ua,va){for(var wa=u.keys(),xa=Array.isArray(wa),ya=0,wa=xa?wa:wa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var za;if(xa){if(ya>=wa.length)break;za=wa[ya++];}else{ya=wa.next();if(ya.done)break;za=ya.value;}var ab=za,bb=u.get(ab);va[ab]&&bb.updateTab();if(bb._newThreadIDFromPhotoUpload&&!bb.isUploading()&&va[bb._newThreadIDFromPhotoUpload]){c('ChatTabActions').closeTab(bb._threadID);c('ChatOpenTab').openThread(bb._newThreadIDFromPhotoUpload,'ChatTabView');bb._newThreadIDFromPhotoUpload=null;}}});q.subscribe('threads-deleted',function(ua,va){for(var wa=u.keys(),xa=Array.isArray(wa),ya=0,wa=xa?wa:wa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var za;if(xa){if(ya>=wa.length)break;za=wa[ya++];}else{ya=wa.next();if(ya.done)break;za=ya.value;}var ab=za;va[ab]&&c('ChatTabActions').closeTab(ab,'thread_deleted');if(r.isNewEmptyLocalThread(ab)){var bb=u.get(ab);bb.ensureValidCanonicalGroup(va);}}});Object.assign(pa.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout(function(){this._sheetController.openAddFriendsSheet();}.bind(this),0);},showNameConversation:function(ua){setTimeout(function(){this._sheetController.openNameConversationSheet(ua);}.bind(this),0);},hideAutomaticNameConversation:function(){setTimeout(function(){this._sheetController.closeAutomaticNameConversationSheet();}.bind(this),0);},isVisible:function(){return c('CSS').shown(this._tabElem);},isUploading:function(){var ua=this._composer&&this._composer.isUploading();return !!(ua||this._filesUploader&&this._filesUploader.isUploading()||this._sharePreview&&this._sharePreview.component.isLoading());},setVisibleState:function(ua,va){if(ua)this._initFlyout();if(ua&&!va)c('ChatPerfInstrumentation').logDisplayDone();var wa=c('CSS').shown(this._tabElem),xa=c('CSS').hasClass(this._tabElem,'opened');c('CSS').conditionShow(this._tabElem,ua);c('CSS').conditionClass(this._tabElem,'opened',va);if(!(wa&&xa)&&ua&&va){if(!this._messagesView)this._updateChatTabMessagesView(this._threadID);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();this.setP2PChatThreadBannerContainerVisibility();}},newMessageClicked:function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();},_updateChatTabMessagesView:function(ua){if(this._messagesView&&this._messagesView.getThreadID()===ua)return;var va=c('MercuryIDs').tokenize(ua);this._messagesView&&this._messagesView.destroy();this._messagesView=new (c('ChatTabMessagesView'))(ua,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,c('MercuryConfig').ShowContextBanner&&va.type==='user');},focus:function(){if(c('CSS').hasClass(this._tabElem,'opened')){try{this._focusInput();}catch(ua){}}else this._getNode('dockButton').focus();},isFocused:function(){var ua=c('getActiveElement')();return c('Parent').bySelector(ua,"._50mz")===this._tabElem;},hasEmptyInput:function(){return t.test(this._getInputValue());},getInputElem:function(){return this._composer&&c('ReactDOM').findDOMNode(this._composer.getInput());},getMessagesView:function(){return this._messagesView;},loadShareFromParams:function(ua,va){this._getSharePreview().done(function(wa){wa.setProps({share:{params:va,type:ua},uri:null});});},_linkDropped:function(ua){this._getSharePreview().done(function(va){va.setProps({share:null,uri:ua});});},_filesDropped:function(ua){this._loadReactMenu().done(function(va){var wa=va.component.getFileUploaderPromise();if(wa)wa.done(function(xa){setTimeout(function(){xa.addDroppedFiles(ua);},0);});});},insertBefore:function(ua){c('DOM').insertBefore(ua.getTabElem(),this._tabElem);},appendTo:function(ua){c('DOM').appendContent(ua,this._tabElem);},nextTabIs:function(ua){var va=ua&&ua.getTabElem();return this._tabElem.nextSibling==va;},getScrollTop:function(){return c('Scroll').getTop(c('DOM').find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(ua){c('Scroll').setTop(c('DOM').find(this._tabElem,'.fbNubFlyoutBody.scrollable'),ua);},destroy:function(){this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();c('ReactDOM').unmountComponentAtNode(this._getNode('animationContainer'));c('ReactDOM').unmountComponentAtNode(this._getNode('menuContainer'));if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmount();this._videoCallButton=null;}if(this._voiceCallButton){this._voiceCallButton.unmount();this._voiceCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}this._subscriptionsHandler&&this._subscriptionsHandler.release();c('ReactDOM').unmountComponentAtNode(this._getNode('name'));c('ReactDOM').unmountComponentAtNode(this._getNode('footer'));c('DOM').remove(this._tabElem);u['delete'](this._threadID);c('Dock').unregisterNubController(this._nubController);},updateAvailableStatus:function(){r.getThreadMeta(this._threadID,function(ua){var va=c('AvailableListConstants').OFFLINE,wa=this._getCanonicalUserID(),xa=null;if(wa){va=c('PresenceStatus').get(wa);xa=c('ShortProfiles').getNow(wa);}else{var ya=ua.participants.map(function(ab){return c('MercuryIDs').getUserIDFromParticipantID(ab);});va=c('PresenceStatus').getGroup(ya);}if(!c('ChatVisibility').isOnline())va=c('AvailableListConstants').OFFLINE;c('CSS').conditionClass(this._tabElem,"_5238",va===c('AvailableListConstants').ACTIVE&&(xa===undefined||xa===null||!xa.is_messenger_only));var za=this._getNode('presenceIndicator');this._onlineStatus=va;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(va);switch(va){case c('AvailableListConstants').ACTIVE:za.setAttribute('alt',j._("Online"));break;default:za.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){r.getThreadMeta(this._threadID,function(ua){if(aa){this._customColor=c('convertMIGColorToFIGColor')(ua.custom_color);if(this._titlebar&&!ua.ephemeral_ttl_mode)this._setCustomColor(this._titlebar,this._customColor);}var va=[this._getNode('name')];if(this._title)this._title.setProps({thread:ua},function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}.bind(this));for(var wa=va,xa=Array.isArray(wa),ya=0,wa=xa?wa:wa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var za;if(xa){if(ya>=wa.length)break;za=wa[ya++];}else{ya=wa.next();if(ya.done)break;za=ya.value;}var ab=za;c('ReactDOM').render(c('React').createElement(c('MercuryThreadTitle.react'),{isNewThread:r.isNewEmptyLocalThread(this._threadID),thread:ua,useAndSeparator:true,useShortName:!ua.is_canonical,viewer:c('CurrentUser').getID()}),ab);}this._updateControls(ua);this._updateMessageBlockSettings(ua);this._updateMessageManageSettings(ua);this._updateSecretModeSettings(ua);this._updateMutingSettings(ua);this._updateUnreadCount(ua);this.updateTitlebarTooltip();this._updateArchiveWarning(ua);this._updateConfidentialStatus(ua);this._updateEmployeeAwayWarning(ua);this._updateUserInFocusWarning(ua);this._updateOfficeStatus(ua);this._updateNewThread(ua);this._updateNameConversationSheet(ua);this._updateReadOnlySheet(ua);this._updateSwitchToWork(ua);}.bind(this));},_updateNameConversationSheet:function(ua){this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(ua){var va=c('MercuryThreadInfo').showComposer(ua),wa=c('MercuryThreadInfo').canReply(ua),xa=r.isEmptyLocalThread(ua.thread_id);if(c('MercuryConfig').ViewerIsReadOnly){this._sheetController.openPermanentReadOnlySheet();}else if(!wa&&!va&&!xa)this._sheetController.openReadOnlySheet();},_updateMessageManageSettings:function(ua){var va=c('MercuryIDs').getParticipantIDFromFromThreadID(ua.thread_id),wa=va?c('MercuryParticipants').getNow(va):null;this._updateMenuPropsSafe({isBusinessEnabled:wa&&wa.is_business_enabled});},updateSignatureID:function(ua){this._signatureID=ua;},_updateMessageBlockSettings:function(ua){this._updateMenuPropsSafe({hasMessageBlocked:c('MercuryBlockedParticipants').get().isMessageBlocked(ua),isEmptyConversation:ua&&ua.message_count==0});},_updateSecretModeSettings:function(ua){var va=!!(ua&&ua.ephemeral_ttl_mode);this._updateMenuPropsSafe({hasSecretModeOn:va});c('CSS').conditionClass(this._tabElem,"_5iq8",va);var wa=va?j._("Type a disappearing message..."):j._("Type a message...");this._composer&&this._composer.setPlaceholder(wa);},_updateMutingSettings:function(ua){var va=!!ua&&c('MercuryThreadInfo').isMuted(ua);va&&!this._reactChatTabMenu&&this._loadReactMenu();this._updateMenuPropsSafe({isMuted:va});},_updateMenuPropsSafe:function(ua){if(this._menuPromise)this._menuPromise.done(function(va){va&&va.component&&va.component.isMounted()&&va.setProps(ua);});},_updateArchiveWarning:function(ua){if(c('CurrentUser').isEmployee())c('MercuryParticipants').getMulti(ua.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateConfidentialStatus:function(ua){if(ua.other_user_fbid)c('MercuryParticipants').getMulti(ua.participants,function(va){var wa=this._getNode('titlebarConfidentialStatus');if(wa){var xa=ua.other_user_fbid&&va[c('MercuryIDs').getParticipantIDFromUserID(ua.other_user_fbid)].is_anonymous_crisis_support;c('CSS').conditionShow(wa,xa);}}.bind(this));},_updateEmployeeAwayWarning:function(ua){if(!c('CurrentUser').isEmployee())return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatEmployeeAwayWarning"],function(va){va.updateEmployeeAwayWarning(ua,function(){this._sheetController.openEmployeeAwaySheet();}.bind(this),c('emptyFunction'));}.bind(this),'ChatTabView');}.bind(this));},_getFocusWarning:function(){if(!this._focusModulePromise)this._focusModulePromise=new (c('Promise'))(function(ua){c('requireWeak')('ChatUserFocusWarning',function(va){return ua(va);});});return this._focusModulePromise;},_updateUserInFocusWarning:function(ua){this._getFocusWarning().done(function(va){va.updateUserFocusWarning(ua,function(){this._sheetController.openUserFocusSheet();}.bind(this),c('emptyFunction'));}.bind(this));},_updateOfficeStatus:function(ua){var va=this._getNode('officeStatus');if(!va||c('MercuryIDs').isGroupChat(ua.thread_id))return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatTabOfficeStatus"],function(wa){var xa=c('MercuryIDs').getParticipantIDFromUserID(ua.other_user_fbid);c('MercuryParticipants').get(xa,function(ya){wa.update(va,ya);});},'ChatTabView');});},_updateSwitchToWork:function(ua){if(c('CurrentUser').isEmployee()&&c('CurrentUser').hasWorkUser()&&c('MercuryIDs').isGroupChat(ua.thread_id)){c('MercuryParticipants').getMulti(ua.participants,function(va){var wa=this._isEmployeesOnly(va);this._updateMenuPropsSafe({hasSwitchToWork:wa});}.bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function(ua,va,wa){var xa=this._isPageChat(),ya=c('MercuryThreadInfo').showComposer(ua)&&(!c('isEmpty')(ua.participants)||!!va)&&!this._composerNullState&&!c('MercuryConfig').ViewerIsReadOnly,za=this._getNode('footer');c('CSS').conditionShow(za,ya);c('CSS').conditionShow(this._getNode('menuContainer'),ya);var ab={isEmptyChat:r.isNewEmptyLocalThread(ua.thread_id),show:ya};if(xa)ab.showAddFriend=null;this._updateMenuPropsSafe(ab);var bb=ya&&!xa;this._addToThreadButton&&this._addToThreadButton.setProps({shown:bb});if(wa&&wa.length===1&&c('MercuryConfig').ShowContextBanner&&c('MercuryConfig').ShowContextBannerNullState){this._messagesView&&this._messagesView.renderContextBanner(null,wa[0].info&&wa[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();},_updateNewThread:function(ua){if(r.isNewEmptyLocalThread(ua.thread_id))this.showAddFriend();},_isEmployeesOnly:function(ua){for(var va in ua)if(!ua[va].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(ua){var va=this._isEmployeesOnly(ua)&&Object.keys(ua).length>1,wa=this._getNode('archiveContainer');if(wa){if(this._titlebarTooltipAnchor)c('CSS').conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',va);c('CSS').conditionShow(wa,va);this._archiveWarning&&this._archiveWarning.setProps({shown:va});}},updateTitlebarTooltip:function(){if(!this._title)return;r.getThreadMeta(this._threadID,function(ua){var va=c('ReactDOM').findDOMNode(this._title.component);if(!va)return;fa(va,ua.participants);}.bind(this));},_getNode:function(ua){return this._tabTemplate.getNode(ua);},_getCanonicalUserID:function(){return c('MercuryIDs').getUserIDFromThreadID(this._threadID);},_listen:function(ua,event,va,wa){var xa=this._getNode(ua);if(xa){this._eventListeners.push(c('Event').listen(xa,event,va.bind(this)));}else if(!wa)throw new Error('Could not find node "'+ua+'"');},_closePreClicked:function(ua){this._closeMouseDown=true;},_closeClicked:function(ua){qa(this);this.animateClose(function(){return c('ChatTabActions').closeTab(this._threadID,'close_click');}.bind(this));if(ua instanceof c('SyntheticMouseEvent')){ua.stopPropagation();return;}ua.kill();},animateClose:function(ua){if(ba){this._animationendFailsafeTimeout=setTimeout(ua,1.2*c('ifRequired')('cssVar',function(wa){return "300ms".replace(z,'');},function(){return 300;}));var va=c('Event').listen(this._tabElem,c('getVendorPrefixedEventName')('animationend'),function(wa){if(wa.animationName==='closeChatTab'){ua();clearTimeout(this._animationendFailsafeTimeout);}}.bind(this));this._subscriptionsHandler&&this._subscriptionsHandler.addSubscriptions(va);c('CSS').addClass(this._tabElem,"_2suj");}else ua();},_closeEnter:function(ua){if(ua.keyCode===c('Keys').RETURN)this._closeClicked(ua);},_nubClicked:function(ua){ua.kill();this._initFlyout();return c('ChatTabViewEvents').inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===c('Keys').RETURN||event.keyCode===c('Keys').SPACE){c('ChatTabViewEvents').inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===c('Keys').ESC){this._handleEscape();event.kill();}else if(event.keyCode===c('Keys').TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var ua=c('ChatTabViewEvents').inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});!ua&&event.preventDefault();}},_handleEscape:function(){qa(this);if(this.hasEmptyInput()){this.animateClose(function(){return c('ChatTabViewEvents').inform('esc-pressed',this._threadID);}.bind(this));}else{var ua=j._("Are you sure you want to close this chat window?"),va=j._("You haven't sent your message.");c('SimpleXUIDialog').showConfirm(ua,va,function(wa){if(wa){c('ChatTabViewEvents').inform('esc-pressed',this._threadID);}else this.focus();}.bind(this),{autofocusConfirm:true,useReactFocusBehavior:true});}},_titleClicked:function(event){var ua=event.getTarget();if(!c('Parent').byClass(ua,'titlebarText')&&!c('Parent').byClass(ua,'uiSelector')&&(!c('Parent').bySelector(ua,"._3olv")||c('Parent').bySelector(ua,"._14lt"))&&!c('Parent').byClass(ua,'close')){event.kill();c('ChatTabActions').lowerTab(this._threadID);this.focus();}},_addFriendLinkClicked:function(){this.showAddFriend();},_getUserParticipants:function(ua){var va=[];ua.forEach(function(wa){var xa=c('MercuryIDs').getUserIDFromParticipantID(wa);xa&&va.push(xa);});return va;},_enableDesktopNotif:function(){Notification.requestPermission();},_inputPasted:function(event){if(c('UserAgent_DEPRECATED').chrome()){var ua=event.clipboardData||event.originalEvent.clipboardData;if(!ua||!ua.items||ua.items.length<1)return;var va=ua.items[0].type;if(va!=='image/png')return;if(ua.items[0].getAsFile){var wa=ua.items[0].getAsFile();this._photoUploader&&this._photoUploader.uploadFiles([wa]);}}},_focusInput:function(){c('ChatNubLogger').processEvent('focus');this._composer?this._composer.getInput().focus():this._focusOnComposerMount=true;},_focusTab:function(){c('CSS').addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);c('ChatTabViewEvents').inform('focus-tab',this._threadID);},_blurTab:function(){c('ChatNubLogger').processEvent('blur');c('CSS').removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(ua){if(this._closeButton){this._closeButton.setProps({active:ua});return;}var va=this._getNode('titlebarCloseButton');if(!va)return;var wa=ua?j._("Press Esc to close"):j._("Close tab");c('TooltipData').set(va,wa,'above');},_initFlyout:function(event){this._initFlyout=c('emptyFunction');for(var ua=this._flyoutInitializers,va=Array.isArray(ua),wa=0,ua=va?ua:ua[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var xa;if(va){if(wa>=ua.length)break;xa=ua[wa++];}else{wa=ua.next();if(wa.done)break;xa=wa.value;}var ya=xa;ya();}},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===c('Keys').RETURN&&!event.shiftKey){if(la(this)){ka(this);event.kill&&event.kill();return;}ha(this);event.kill?event.kill():event.preventDefault();return;}if(event.keyCode===c('Keys').DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();c('ChatTabActions').lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(ua){var va=this._getCanonicalUserID();if(!va)return;var wa='fbid:'+va;c('MercuryParticipants').get(wa,function(xa){c('Bootloader').loadModules(["MessageBlockedDialog"],function(ya){ya.show(ua.thread_id,ua.can_reply,c('MercuryBlockedParticipants').get().isMessageBlocked(ua),xa.short_name);},'ChatTabView');});},_initializeInput:function(){var ua=new (c('ReactComponentRenderer'))(c('ChatTabComposerContainer.react'),this._getNode('footer'));ua.setProps({disableFileUploads:!c('WorkFileUploadsGating').canUploadFiles,initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onMount:function(va){this._composer=va;var wa=false;if(this._focusOnComposerMount){wa=true;this._focusOnComposerMount=false;}if(c('ChatTabLazyFocus').get()===this._threadID){wa=true;c('ChatTabLazyFocus').clear();}if(wa)setTimeout(function(){this._composer.getInput().focus();}.bind(this),0);}.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),resizeFn:function(){this._nubController.flyoutContentChanged();}.bind(this),placeholder:j._("Type a message..."),onCustomLikeSelect:this._customLikeSelected.bind(this),onEmojiSelect:this._emojiSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onFileUploadFail:this._handleFileLastUploadFailed.bind(this),onP2PTrigger:this._p2pTriggered.bind(this),onPhotoUploadFail:this._handlePULastUploadFailed.bind(this),onStickerSelect:this._stickerSelected.bind(this),onUploadCancel:this._handlePULastUploadCanceled.bind(this),onUploadComplete:this._handlePUAllUploadsCompleted.bind(this),onUploadSubmit:this._handleUploadSubmit.bind(this),threadID:this._threadID,viewer:c('CurrentUser').getID()});},_initializeSharePreview:function(ua,va){c('Event').listen(ua,'keyup',function(){var wa=va?va():ua.value;if(!wa.length)if(this._urlScraper){this._urlScraper.reset();delete this._urlScraperData;}}.bind(this));c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["URLScraper"],function(wa){this._urlScraper=new wa(ua,va);this._urlScraper.subscribe('match',function(xa,ya){this._urlScraperData=ya;this._getSharePreview().done(function(za){var ab=this._urlScraperData;za.setProps({share:null,uri:ab&&ab.url});}.bind(this));}.bind(this));}.bind(this),'ChatTabView');}.bind(this));},_getSharePreview:function(){if(!this._sharePreview&&!this._sharePreviewPromise){this._sharePreviewLoading=true;this._sharePreviewPromise=new (c('Promise'))(function(ua){c('Bootloader').loadModules(["MercurySharePreview.react"],function(va){this._sharePreview=new (c('ReactComponentRenderer'))(va,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:v,height:v},location:c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:function(){na(this);this._unblockSend();}.bind(this)});this._sharePreviewLoading=false;ua(this._sharePreview);}.bind(this),'ChatTabView');}.bind(this));}return this._sharePreviewPromise;},_initializeThingsWithInputFn:function(ua,va){var wa=this;this._getValueFromReactComposer=va;this._initializeSharePreview(ua,va);r.getThreadMeta(this._threadID,function(xa){if(xa){if(c('MessageRequestUtils').isMessageRequest(xa))(function(){var cb=c('DOM').create('div');c('DOM').appendContent(wa._getNode('chatConv'),cb);wa._composerNullState=cb;var db=c('MessageRequestUtils').isFiltered(xa);c('ReactDOM').render(c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{height:27}}),bootloadLoader:c('JSResource')('ChatPendingActions.react').__setRef('ChatTabView'),isFiltered:db,onDeleteClick:function(eb){if(db){c('Bootloader').loadModules(["WebMessengerDeleteThreadDialog"],function(fb){fb.show(this._threadID);}.bind(this),'ChatTabView');}else{o.changeFolder(this._threadID,c('MessagingTag').OTHER);c('ChatTabActions').closeTab(this._threadID);}}.bind(wa),onReplyClick:function(eb){o.changeFolder(this._threadID,c('MessagingTag').INBOX);c('DOM').remove(cb);delete this._composerNullState;this._updateControls(xa);this._nubController.flyoutContentChanged();}.bind(wa)}),cb);})();var ya=ca&&xa.message_count===0,za=da;if(this._isPageChat()&&(ya||za)){var ab=this._getPageID(),bb=c('XMNCommercePageNullStateCTAController').getURIBuilder();new (c('AsyncRequest'))().setURI(bb.getURI()).setMethod('POST').setData({page_id:ab}).setHandler(function(cb){var db=this;if(cb&&cb.payload)(function(){var eb=c('DOM').create('div');db._composerNullState=eb;var fb=cb.payload;c('DOM').appendContent(db._getNode('chatConv'),eb);db._composerNullState=eb;c('ReactDOM').render(c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{height:27}}),bootloadLoader:c('JSResource')('ChatPageComposerNullState.react').__setRef('ChatTabView'),title:fb.title,onClick:function(gb){c('MNCommercePostbackCTADataManager').send(fb.id);c('DOM').remove(eb);delete this._composerNullState;this._updateControls(xa);this._nubController.flyoutContentChanged();}.bind(db)}),eb);db._updateControls(xa);db._nubController.flyoutContentChanged();})();}.bind(this)).send();}}p.getServerIDFromClientID(this._threadID,function(cb){this._typingDetector=new (c('TypingDetectorController'))(this._getCanonicalUserID(),ua,'mercury-chat',null,cb,va);}.bind(this));}.bind(this));},_getInputValue:function(){if(this._getValueFromReactComposer)return this._getValueFromReactComposer();if(!this._chatInput||!this._chatInput.component.isMounted())return '';return this._chatInput.component.getValue()||'';},appendTextToInput:function(ua){this._composer&&this._composer.getInput().appendText(ua);},_hasUnfinishedPost:function(){return ma(this)||this.isUploading();},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){o.markRead(this._threadID);o.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(ua){this.tryMarkAsRead();if(c('Parent').byTag(ua.getTarget(),'a')||c('DOM').getSelection())return;this.focus();},_inputContainerClicked:function(ua){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){this._pagesMessageIndicatorHandler=c('PagesMercuryChatTabIndicatorHandler').tryCreateHandler(this._threadID,this._onlineStatus,this._sheetController.openPageResponsivenessSheet.bind(this._sheetController),this._sheetController.closePageResponsivenessSheet.bind(this._sheetController));this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},_initializePagesGreeting:function(){var ua=c('DOMQuery').scry(this._tabElem,"._av1"),va=this._threadID,wa=c('MercuryIDs').getUserIDFromThreadID(va);if(!ua||ua.length===0)return;if(c('FBID').isUser(wa)){c('CSS').hide(ua[0]);return;}var xa=c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',null),bootloadLoader:c('JSResource')('MercuryChatTabPagesGreetingContainer.react').__setRef('ChatTabView'),threadID:va});c('ReactDOM').render(xa,ua[0]);},showTypingIndicator:function(ua){this._renderTypingIndicator();c('CSS').conditionClass(this._tabElem,"_54m8",ua);},_renderTypingIndicator:function(){var ua=c('CSS').hasClass(this._tabElem,'highlightTab')?'light':'dark';c('ReactDOM').render(c('React').createElement(c('MercuryTypingAnimation.react'),{color:ua}),this._getNode('animationContainer'));},_updateUnreadCount:function(ua){var va=ua.unread_count;if(c('WorkFocusMode').currentViewerInFocusMode(ua.id))return;if(va!=undefined){var wa=!!va&&(!c('ChatBehavior').showsTabUnreadUI||c('ChatBehavior').showsTabUnreadUI()),xa=this._getNode('numMessages');c('CSS').conditionShow(xa,wa);c('CSS').conditionClass(this._tabElem,'highlightTab',wa);this._renderTypingIndicator();if(wa){c('ChatTabBlinking').blinkTab(this._threadID,this);}else c('ChatTabBlinking').unblinkTab(this._threadID);c('DOM').setContent(xa,va);}},ensureValidCanonicalGroup:function(ua){if(this._messagesView&&this._messagesView.getThreadID()===this._threadID)return;if(ua[this._messagesView.getThreadID()])this._updateChatTabMessagesView(this._threadID);},_initializeSheetController:function(){this._sheetController=new (c('ChatTabSheetController'))(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onTokensChanged(function(ua,va){this._handleSheetControllerTokensChanged(va);}.bind(this));this._nubController=new (c('NubController'))().init(this._tabElem);this._sheetController.onResize(function(){this._nubController.flyoutContentChanged();}.bind(this));},_handleSheetControllerTokensChanged:function(ua){this._updateComposerParticipants(ua.tokens);r.getThreadMeta(this._threadID,function(va){this._updateControls(va,ua.token_count,ua.tokens);}.bind(this));this._updateMessagesViewIfNecessary(ua);},_updateMessagesViewIfNecessary:function(ua){if(!r.isEmptyLocalThread(this._threadID))return;var va=c('MercuryCanonicalGroupThreadManager').get();va.unsubscribe(this._canonicalGroupSearchSubscriptionID);if(ua.token_count===1){var wa=ua.tokens[0].info&&ua.tokens[0].info.uid;this._updateMercuryMessagesViewCanonical(c('MercuryIDs').getThreadIDFromUserID(wa));return;}this._updateMercuryMessagesViewCanonical(this._threadID);if(ua.token_count>1){var xa=ua.tokens.map(function(ya){return ya.info.uid;});this._canonicalGroupSearchSubscriptionID=va.getCanonicalGroupThreadIDForParticipants(Array.from(xa),this._updateMercuryMessagesViewCanonical.bind(this));}},_updateMercuryMessagesViewCanonical:function(ua){if(ua){this._updateChatTabMessagesView(ua);this._messagesView.scrollToBottom();}},_updateComposerParticipants:function(ua){var va=void 0;if(ua&&ua.length===1&&ua[0].info&&ua[0].info.uid)va=[c('MercuryIDs').getParticipantIDFromUserID(ua[0].info.uid)];this._composer&&this._composer.setParticipantIDs(va);},_initializeHeader:function(){this._initializeTitle();this._initializeCloseButton();this._initializeReactMenu();this._initializeAddToThreadButton();this._initializeRTC();this._initializeArchiveWarning();this._setCloseTooltip(false);},_loadReactMenu:function(){var ua=c('MercuryIDs').isGroupChat(this._threadID),va=r.isNewEmptyLocalThread(this._threadID),wa=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(!this._menuPromise)this._initializeReactMenu();c('JSResource')('ChatTabMenu.react').__setRef('ChatTabView').load().done(function(xa){this._reactChatTabMenu=new (c('ReactComponentRenderer'))(xa,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFilesUploader.bind(this),nameConversationFunc:function(){return this.showNameConversation();}.bind(this),isGroupChat:ua,isEmptyChat:va,showAddFriend:wa,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:this._getNode('fileAttachmentShelf'),onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:function(){return na(this);}.bind(this),onSubmit:this._focusInput.bind(this)},function(){this._menuPromiseResolve&&this._menuPromiseResolve(this._reactChatTabMenu);}.bind(this));}.bind(this));return this._menuPromise;},_initializeReactMenu:function(){this._menuPromise=new (c('Promise'))(function(ua){this._menuPromiseResolve=ua;}.bind(this));this._listen('menuButton','click',function(ua){ua.preventDefault();this._loadReactMenu().done(function(va){va.component.open();});}.bind(this));},_initializeArchiveWarning:function(){var ua=this._getNode('archiveContainer');if(!ua)return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ArchiveWarning.react"],function(va){this._archiveWarning=new (c('ReactComponentRenderer'))(va,ua);this._archiveWarning.setProps({isFBAtWork:c('WorkModeConfig').is_work_user,shown:false,useCSS:aa});var wa=r.getThreadMetaNow(this._threadID);if(wa)this._updateArchiveWarning(wa);}.bind(this),'ChatTabView');}.bind(this));},_initializeAddToThreadButton:function(){c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatAddToThreadButton.react"],function(ua){this._addToThreadButton=new (c('ReactComponentRenderer'))(ua,this._getNode('addToThreadContainer'));this._addToThreadButton.setProps({isFBAtWork:c('WorkModeConfig').is_work_user,onClick:this._addFriendLinkClicked.bind(this),shown:false});var va=r.getThreadMetaNow(this._threadID);if(va)this._updateControls(va);}.bind(this),'ChatTabView');}.bind(this));},_initializeRTC:function(){var ua=c('MercuryIDs').isGroupChat(this._threadID);if(ua&&!c('ChatConfig').get('rtc_conferencing_www'))return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatVideoCallButton.react"],function(va){var wa=c('CurrentUser').getID();this._videoCallButton=new (c('ReactComponentRenderer'))(va,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({isAudio:false,isGroupChat:ua,threadID:this._threadID,viewer:wa});this._voiceCallButton=new (c('ReactComponentRenderer'))(va,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({isAudio:true,isGroupChat:ua,threadID:this._threadID,viewer:wa});}.bind(this),'ChatTabView');}.bind(this));},_initializeCloseButton:function(){this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatCloseButton.react"],function(ua){this._closeButton=new (c('ReactComponentRenderer'))(ua,this._getNode('titlebarCloseButtonContainer'));this._closeButton.setProps({active:this.isFocused(),className:"_3olu _3olv",onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}.bind(this),'ChatTabView');}.bind(this));},_initializeTitle:function(){var ua=r.getThreadMetaNow(this._threadID);this._title=new (c('ReactComponentRenderer'))(c('ChatTitleLink.react'),this._getNode('titleContainer'));this._title.setProps({thread:ua,viewer:c('CurrentUser').getID()});},_initializeTitleHREF:function(){var ua=this._getCanonicalUserID();if(ua){c('MercuryParticipants').get(c('MercuryIDs').getParticipantIDFromUserID(ua),function(va){if(va.href){this._setTitleHref(va.href);}else{var wa=c('WebMessengerThreadPermalinks').getThreadURIFromUserID(ua);this._setTitleHref(wa);}}.bind(this));}else c('WebMessengerThreadPermalinks').getThreadURI(this._threadID,function(va){return this._setTitleHref(va);}.bind(this));this._titlebarTooltipAnchor=this._getNode('titlebarText');},_initializeDockUIListeners:function(){this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);},_initializeUIListeners:function(){this._listen('closeButton','click',this._closeClicked);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);if(this._getNode('inputContainer'))this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===c('Keys').TAB){this._focusInput();event.kill();}if(event.keyCode===c('Keys').ESC)this._handleEscape();}.bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFilesUploader:function(ua){this._filesUploader=ua;},_initializeDragDropTarget:function(){if(c('WorkFileUploadsGating').canUploadFiles){var ua=c('DOMQuery').scry(this._tabElem,"._1ia");if(ua&&ua.length>0){this._dropTarget=new (c('DragDropTarget'))(ua[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}}},_initializeP2PChatThreadBannerContainer:function(){var ua=c('DOMQuery').scry(this._tabElem,"._2hc2");if(ua&&ua.length>0){this._p2pChatThreadBannerContainerEl=ua[0];c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["P2PChatThreadBannerContainer.react"],function(va){this._p2pChatThreadBannerContainer=new (c('ReactComponentRenderer'))(va,this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable(),otherUserID:c('MercuryIDs').getUserIDFromThreadID(this._threadID),threadID:this._threadID});}.bind(this),'ChatTabView');}.bind(this));}},setP2PChatThreadBannerContainerVisibility:function(){if(this._p2pChatThreadBannerContainer)this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable()});},isChatViewable:function(){return (this._tabElem&&c('CSS').hasClass(this._tabElem,'opened')&&!c('CSS').hasClass(this._tabElem,'hidden_elem'));},_initializeUnloadListeners:function(){this._checkUnsentMessages=c('createCancelableFunction')(function(){if(this._hasUnfinishedPost())return j._("You haven't sent your message yet. Do you want to leave without sending?");if(m.getNumberLocalMessages(this._threadID))return j._("Your message is still being sent. Are you sure you want to leave?");return null;}.bind(this));c('Run').onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=c('createCancelableFunction')(qa.bind(null,this));c('Run').onUnload(this._logUnsentPhotos);},_handleUploadSubmit:function(ua){oa(this,c('PhotosUploadWaterfall').UPLOAD_START,ua);ja(this,'',[],function(va){if(this._threadID!==va.thread_id){this._newThreadIDFromPhotoUpload=va.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(va.thread_id);}va.content_attachment=null;s.addAttachmentPlaceholder(va,ua.upload_id,ua);}.bind(this));sa('submit',ua);this._focusInput();},_handleFileLastUploadFailed:function(ua){oa(this,c('PhotosUploadWaterfall').CLIENT_ERROR,ua);sa('failed',ua);},_handlePULastUploadFailed:function(ua){oa(this,c('PhotosUploadWaterfall').CLIENT_ERROR,ua);sa('failed',ua);},_handlePULastUploadCanceled:function(ua){oa(this,c('PhotosUploadWaterfall').CANCEL_DURING_UPLOAD,ua);sa('canceled',ua);},_handlePUAllUploadsCompleted:function(ua){oa(this,c('PhotosUploadWaterfall').ALL_UPLOADS_DONE,ua);sa('completed',ua);var va=ua.image_ids.length||ua.attachments.length;ia(this,va);},_stickerSelected:function(ua){ja(this,'',[],function(va){va.has_attachment=true;va.sticker_id=ua;s.send(va);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emojiSelected:function(ua){this._focusInput();this._composer&&this._composer.getInput().insertEmoji(ua);},_customLikeSelected:function(ua,va){ja(this,ua.emoji,[],function(wa){wa.has_attachment=false;s.send(c('EmojiLikeUtils').setEmojiSize(wa,va));this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(ua){var va=c('EmoticonsList').symbols[ua];if(!va)return;this._composer&&this._composer.getInput().insertEmoticon(va);},_p2pTriggered:function(){ja(this,'',[],function(ua){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_setTitleHref:function(ua){this._title&&this._title.setProps({href:ua});},_unblockSend:function(){if(!this._blocked||la(this))return;this._blocked=false;ha(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new (c('AsyncSignal'))('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();},_setCustomColor:function(ua,va){if(!ua)return;if(va){c('Style').apply(ua,{color:va});}else if(ua.style)ua.style.color='';c('CSS').conditionClass(ua,"_1m34",!!va);},_isPageChat:function(){if(this._threadID){var ua=c('MercuryIDs').tokenize(this._threadID);if(ua.type==='user')return !c('FBID').isUser(ua.value);}return false;},_getPageID:function(){if(this._threadID){var ua=c('MercuryIDs').tokenize(this._threadID);if(ua.type==='user'&&!c('FBID').isUser(ua.value))return ua.value;}return null;},getCustomColor:function(){return this._customColor;}});function sa(ua,va){ea.debug('photo_uploader:'+ua,'{}');}function ta(ua,va){if(!va)return ua;var wa=va.getImageFiles();if(wa.length>0){ua.image_ids=wa;ua.has_attachment=true;}var xa=va.getAnimatedImageFiles();if(xa.length>0){ua.gif_ids=xa;ua.has_attachment=true;}var ya=va.getVideoFiles();if(ya.length>0){ua.video_ids=ya;ua.has_attachment=true;}var za=va.getAudioFiles();if(za.length>0){ua.audio_ids=za;ua.has_attachment=true;}var ab=va.getFiles();if(ab.length>0){ua.file_ids=ab;ua.has_attachment=true;}return ua;}f.exports=pa;},null);